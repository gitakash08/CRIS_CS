"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[2422],{550:(P,R,A)=>{function E(){return[1,0,0,0,1,0,0,0,1]}function e(O,b,p,y,g,U,F,M,D){return[O,b,p,y,g,U,F,M,D]}function C(O,b){return new Float64Array(O,b,9)}A.d(R,{a:()=>E,c:()=>C,f:()=>e}),Object.freeze(Object.defineProperty({__proto__:null,clone:function m(O){return[O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7],O[8]]},create:E,createView:C,fromValues:e},Symbol.toStringTag,{value:"Module"}))},78451:(P,R,A)=>{function E(){return[0,0,0,1]}function m(b){return[b[0],b[1],b[2],b[3]]}function C(b,p){return new Float64Array(b,p,4)}A.d(R,{I:()=>h,a:()=>E,b:()=>m,c:()=>C});const h=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:h,clone:m,create:E,createView:C,fromValues:function e(b,p,y,g){return[b,p,y,g]}},Symbol.toStringTag,{value:"Module"}))},14658:(P,R,A)=>{function E(){return new Float32Array(3)}function e(v,S,B){const L=new Float32Array(3);return L[0]=v,L[1]=S,L[2]=B,L}function h(){return E()}function O(){return e(1,1,1)}function b(){return e(1,0,0)}function p(){return e(0,1,0)}function y(){return e(0,0,1)}A.d(R,{c:()=>E,f:()=>e});const g=h(),U=O(),F=b(),M=p(),D=y();Object.freeze(Object.defineProperty({__proto__:null,ONES:U,UNIT_X:F,UNIT_Y:M,UNIT_Z:D,ZEROS:g,clone:function m(v){const S=new Float32Array(3);return S[0]=v[0],S[1]=v[1],S[2]=v[2],S},create:E,createView:function C(v,S){return new Float32Array(v,S,3)},fromValues:e,ones:O,unitX:b,unitY:p,unitZ:y,zeros:h},Symbol.toStringTag,{value:"Module"}))},6810:(P,R,A)=>{A.r(R),A.d(R,{default:()=>X});var E=A(85931),m=A(55713),e=A(48977),C=A(78451),h=A(84161),O=A(14658),b=A(65234),p=A(39774),g=(A(8314),A(53776)),U=A(23899),F=A(98610),M=A(92852),D=A(61566);function S(d,t,a){return d?.attributeInfo.useElevation?t?function B(d,t){const a=new Float64Array(t);for(let n=0;n<t;n++)a[n]=d[3*n+2];return a}(t,a):null:d?.attributeInfo.storageInfo?(0,M.qM)(d.attributeInfo.storageInfo,d.buffer,a):null}function w(d){switch(d){default:case null:case"none":return t=>t;case"low-four-bit":return t=>15&t;case"high-four-bit":return t=>(240&t)>>4;case"absolute-value":return t=>Math.abs(t);case"modulo-ten":return t=>t%10}}function z(d){let t=0;for(const a of d||[])t|=1<<a;return t}class G{transform(t){const a=this._transform(t),n=[a.points.buffer,a.rgb.buffer];null!=a.pointIdFilterMap&&n.push(a.pointIdFilterMap.buffer);for(const f of a.attributes)"buffer"in f.values&&(0,m.eP)(f.values.buffer)&&f.values.buffer!==a.rgb.buffer&&n.push(f.values.buffer);return Promise.resolve({result:a,transferList:n})}_transform(t){const a=function v(d,t){if(null==d.encoding||""===d.encoding){const a=(0,M.W7)(t,d);if(null==a.vertexAttributes.position)return;const n=(0,M.I_)(t,a.vertexAttributes.position),f=a.header.fields,T=[f.offsetX,f.offsetY,f.offsetZ],l=[f.scaleX,f.scaleY,f.scaleZ],u=n.length/3,o=new Float64Array(3*u);for(let s=0;s<u;s++)o[3*s]=n[3*s]*l[0]+T[0],o[3*s+1]=n[3*s+1]*l[1]+T[1],o[3*s+2]=n[3*s+2]*l[2]+T[2];return o}if("lepcc-xyz"===d.encoding)return(0,D.Gi)(t).result}(t.schema,t.geometryBuffer);let n=a.length/3,f=null;const T=new Array,l=S(t.primaryAttributeData,a,n);null!=t.primaryAttributeData&&l&&T.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:l});const u=S(t.modulationAttributeData,a,n);null!=t.modulationAttributeData&&u&&T.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:u});let o=function x(d,t,a,n){const{rendererJSON:f,isRGBRenderer:T}=d;let l=null,u=null;if(t&&T)l=t;else if(t&&"pointCloudUniqueValueRenderer"===f?.type){u=F.Z.fromJSON(f);const o=u.colorUniqueValueInfos;l=new Uint8Array(3*n);const s=w(u.fieldTransformType);for(let r=0;r<n;r++){const c=(s?s(t[r]):t[r])+"";for(let i=0;i<o.length;i++)if(o[i].values.includes(c)){l[3*r]=o[i].color.r,l[3*r+1]=o[i].color.g,l[3*r+2]=o[i].color.b;break}}}else if(t&&"pointCloudStretchRenderer"===f?.type){u=U.Z.fromJSON(f);const o=u.stops;l=new Uint8Array(3*n);const s=w(u.fieldTransformType);for(let r=0;r<n;r++){const c=s?s(t[r]):t[r],i=o.length-1;if(c<o[0].value)l[3*r]=o[0].color.r,l[3*r+1]=o[0].color.g,l[3*r+2]=o[0].color.b;else if(c>=o[i].value)l[3*r]=o[i].color.r,l[3*r+1]=o[i].color.g,l[3*r+2]=o[i].color.b;else for(let I=1;I<o.length;I++)if(c<o[I].value){const N=(c-o[I-1].value)/(o[I].value-o[I-1].value);l[3*r]=o[I].color.r*N+o[I-1].color.r*(1-N),l[3*r+1]=o[I].color.g*N+o[I-1].color.g*(1-N),l[3*r+2]=o[I].color.b*N+o[I-1].color.b*(1-N);break}}}else if(t&&"pointCloudClassBreaksRenderer"===f?.type){u=g.Z.fromJSON(f);const o=u.colorClassBreakInfos;l=new Uint8Array(3*n);const s=w(u.fieldTransformType);for(let r=0;r<n;r++){const c=s?s(t[r]):t[r];for(let i=0;i<o.length;i++)if(c>=o[i].minValue&&c<=o[i].maxValue){l[3*r]=o[i].color.r,l[3*r+1]=o[i].color.g,l[3*r+2]=o[i].color.b;break}}}else l=new Uint8Array(3*n).fill(255);if(a&&u?.colorModulation){const o=u.colorModulation.minValue,s=u.colorModulation.maxValue,r=.3;for(let c=0;c<n;c++){const i=a[c],I=i>=s?1:i<=o?r:r+(1-r)*(i-o)/(s-o);l[3*c]=I*l[3*c],l[3*c+1]=I*l[3*c+1],l[3*c+2]=I*l[3*c+2]}}return l}(t.rendererInfo,l,u,n);if(t.filterInfo&&t.filterInfo.length>0&&null!=t.filterAttributesData){const r=t.filterAttributesData.filter(E.pC).map(c=>{const i=S(c,a,n),I={attributeInfo:c.attributeInfo,values:i};return T.push(I),I});f=new Uint32Array(n),n=function L(d,t,a,n,f){const T=d.length/3;let l=0;for(let u=0;u<T;u++){let o=!0;for(let s=0;s<n.length&&o;s++){const{filterJSON:r}=n[s],c=f[s].values[u];switch(r.type){case"pointCloudValueFilter":{const i="exclude"===r.mode;r.values.includes(c)===i&&(o=!1);break}case"pointCloudBitfieldFilter":{const i=z(r.requiredSetBits),I=z(r.requiredClearBits);(c&i)===i&&!(c&I)||(o=!1);break}case"pointCloudReturnFilter":{const i=15&c,I=c>>>4&15,N=I>1,J=1===i,Z=i===I;let j=!1;for(const V of r.includedReturns)if("last"===V&&Z||"firstOfMany"===V&&J&&N||"lastOfMany"===V&&Z&&N||"single"===V&&!N){j=!0;break}j||(o=!1);break}}}o&&(a[l]=u,d[3*l]=d[3*u],d[3*l+1]=d[3*u+1],d[3*l+2]=d[3*u+2],t[3*l]=t[3*u],t[3*l+1]=t[3*u+1],t[3*l+2]=t[3*u+2],l++)}return l}(a,o,f,t.filterInfo,r)}for(const r of t.userAttributesData){const c=S(r,a,n);T.push({attributeInfo:r.attributeInfo,values:c})}3*n<o.length&&(o=new Uint8Array(o.buffer.slice(0,3*n))),this._applyElevationOffsetInPlace(a,n,t.elevationOffset);const s=this._transformCoordinates(a,n,t.obb,b.Z.fromJSON(t.inSR),b.Z.fromJSON(t.outSR));return{obb:t.obb,points:s,rgb:o,attributes:T,pointIdFilterMap:f}}_transformCoordinates(t,a,n,f,T){if(!(0,p.projectBuffer)(t,f,0,t,T,0,a))throw new Error("Can't reproject");const l=(0,O.f)(n.center[0],n.center[1],n.center[2]),u=(0,O.c)(),o=(0,O.c)();(0,e.a)(k,n.quaternion);const s=new Float32Array(3*a);for(let r=0;r<a;r++)u[0]=t[3*r]-l[0],u[1]=t[3*r+1]-l[1],u[2]=t[3*r+2]-l[2],(0,h.v)(o,u,k),n.halfSize[0]=Math.max(n.halfSize[0],Math.abs(o[0])),n.halfSize[1]=Math.max(n.halfSize[1],Math.abs(o[1])),n.halfSize[2]=Math.max(n.halfSize[2],Math.abs(o[2])),s[3*r]=u[0],s[3*r+1]=u[1],s[3*r+2]=u[2];return s}_applyElevationOffsetInPlace(t,a,n){if(0!==n)for(let f=0;f<a;f++)t[3*f+2]+=n}}const k=(0,C.a)();function X(){return new G}},16396:(P,R,A)=>{var E,e;A.d(R,{T:()=>E}),(e=E||(E={})).POSITION="position",e.NORMAL="normal",e.NORMALCOMPRESSED="normalCompressed",e.UV0="uv0",e.AUXPOS1="auxpos1",e.AUXPOS2="auxpos2",e.COLOR="color",e.SYMBOLCOLOR="symbolColor",e.SIZE="size",e.TANGENT="tangent",e.OFFSET="offset",e.PERSPECTIVEDIVIDE="perspectiveDivide",e.SUBDIVISIONFACTOR="subdivisionFactor",e.COLORFEATUREATTRIBUTE="colorFeatureAttribute",e.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",e.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",e.DISTANCETOSTART="distanceToStart",e.UVMAPSPACE="uvMapSpace",e.BOUNDINGRECT="boundingRect",e.UVREGION="uvRegion",e.PROFILERIGHT="profileRight",e.PROFILEUP="profileUp",e.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",e.FEATUREVALUE="featureValue",e.INSTANCEMODELORIGINHI="instanceModelOriginHi",e.INSTANCEMODELORIGINLO="instanceModelOriginLo",e.INSTANCEMODEL="instanceModel",e.INSTANCEMODELNORMAL="instanceModelNormal",e.INSTANCECOLOR="instanceColor",e.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",e.LOCALTRANSFORM="localTransform",e.GLOBALTRANSFORM="globalTransform",e.BOUNDINGSPHERE="boundingSphere",e.MODELORIGIN="modelOrigin",e.MODELSCALEFACTORS="modelScaleFactors",e.FEATUREATTRIBUTE="featureAttribute",e.STATE="state",e.LODLEVEL="lodLevel",e.POSITION0="position0",e.POSITION1="position1",e.NORMALA="normalA",e.NORMALB="normalB",e.COMPONENTINDEX="componentIndex",e.VARIANTOFFSET="variantOffset",e.VARIANTSTROKE="variantStroke",e.VARIANTEXTENSION="variantExtension",e.SIDENESS="sideness",e.START="start",e.END="end",e.UP="up",e.EXTRUDE="extrude",e.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",e.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"}}]);