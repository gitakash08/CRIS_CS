"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[1599,5994],{36592:(Q,H,E)=>{E.d(H,{Q:()=>Z});var L=E(85931),V=E(77029),G=E(14259);class Z{constructor(t=9,r){this._compareMinX=w,this._compareMinY=A,this._toBBox=o=>o,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this._toBBox=r:this._initFormat(r)),this.clear()}destroy(){this.clear(),P.prune(),C.prune(),j.prune(),v.prune()}all(t){this._all(this._data,t)}search(t,r){let o=this._data;const l=this._toBBox;if(B(t,o))for(P.clear();o;){for(let u=0,c=o.children.length;u<c;u++){const f=o.children[u],M=o.leaf?l(f):f;B(t,M)&&(o.leaf?r(f):g(t,M)?this._all(f,r):P.push(f))}o=P.pop()}}collides(t){let r=this._data;const o=this._toBBox;if(!B(t,r))return!1;for(P.clear();r;){for(let l=0,u=r.children.length;l<u;l++){const c=r.children[l],f=r.leaf?o(c):c;if(B(t,f)){if(r.leaf||g(t,f))return!0;P.push(c)}}r=P.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let o=0,l=t.length;o<l;o++)this.insert(t[o]);return this}let r=this._build(t.slice(0,t.length),0,t.length-1,0);if(this._data.children.length)if(this._data.height===r.height)this._splitRoot(this._data,r);else{if(this._data.height<r.height){const o=this._data;this._data=r,r=o}this._insert(r,this._data.height-r.height-1,!0)}else this._data=r;return this}insert(t){return t&&this._insert(t,this._data.height-1),this}clear(){return this._data=new h([]),this}remove(t){if(!t)return this;let r,o=this._data,l=null,u=0,c=!1;const f=this._toBBox(t);for(j.clear(),v.clear();o||j.length>0;){if(o||(o=j.pop(),l=j.data[j.length-1],u=v.pop()??0,c=!0),o.leaf&&(r=(0,L.cq)(o.children,t,o.children.length,o.indexHint),-1!==r))return o.children.splice(r,1),j.push(o),this._condense(j),this;c||o.leaf||!g(o,f)?l?(u++,o=l.children[u],c=!1):o=null:(j.push(o),v.push(u),u=0,l=o,o=o.children[0])}return this}toJSON(){return this._data}fromJSON(t){return this._data=t,this}_all(t,r){let o=t;for(C.clear();o;){if(!0===o.leaf)for(const l of o.children)r(l);else C.pushArray(o.children);o=C.pop()??null}}_build(t,r,o,l){const u=o-r+1;let c=this._maxEntries;if(u<=c){const T=new h(t.slice(r,o+1));return S(T,this._toBBox),T}l||(l=Math.ceil(Math.log(u)/Math.log(c)),c=Math.ceil(u/c**(l-1)));const f=new a([]);f.height=l;const M=Math.ceil(u/c),F=M*Math.ceil(Math.sqrt(c));Y(t,r,o,F,this._compareMinX);for(let T=r;T<=o;T+=F){const y=Math.min(T+F-1,o);Y(t,T,y,M,this._compareMinY);for(let R=T;R<=y;R+=M){const K=Math.min(R+M-1,y);f.children.push(this._build(t,R,K,l-1))}}return S(f,this._toBBox),f}_chooseSubtree(t,r,o,l){for(;l.push(r),!0!==r.leaf&&l.length-1!==o;){let u,c=1/0,f=1/0;for(let M=0,F=r.children.length;M<F;M++){const T=r.children[M],y=x(T),R=W(t,T)-y;R<f?(f=R,c=y<c?y:c,u=T):R===f&&y<c&&(c=y,u=T)}r=u||r.children[0]}return r}_insert(t,r,o){const u=o?t:(0,this._toBBox)(t);j.clear();const c=this._chooseSubtree(u,this._data,r,j);for(c.children.push(t),U(c,u);r>=0&&j.data[r].children.length>this._maxEntries;)this._split(j,r),r--;this._adjustParentBBoxes(u,j,r)}_split(t,r){const o=t.data[r],l=o.children.length,u=this._minEntries;this._chooseSplitAxis(o,u,l);const c=this._chooseSplitIndex(o,u,l);if(!c)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const f=o.children.splice(c,o.children.length-c),M=o.leaf?new h(f):new a(f);M.height=o.height,S(o,this._toBBox),S(M,this._toBBox),r?t.data[r-1].children.push(M):this._splitRoot(o,M)}_splitRoot(t,r){this._data=new a([t,r]),this._data.height=t.height+1,S(this._data,this._toBBox)}_chooseSplitIndex(t,r,o){let l,u,c;l=u=1/0;for(let f=r;f<=o-r;f++){const M=z(t,0,f,this._toBBox),F=z(t,f,o,this._toBBox),T=p(M,F),y=x(M)+x(F);T<l?(l=T,c=f,u=y<u?y:u):T===l&&y<u&&(u=y,c=f)}return c}_chooseSplitAxis(t,r,o){const l=t.leaf?this._compareMinX:w,u=t.leaf?this._compareMinY:A;this._allDistMargin(t,r,o,l)<this._allDistMargin(t,r,o,u)&&t.children.sort(l)}_allDistMargin(t,r,o,l){t.children.sort(l);const u=this._toBBox,c=z(t,0,r,u),f=z(t,o-r,o,u);let M=N(c)+N(f);for(let F=r;F<o-r;F++){const T=t.children[F];U(c,t.leaf?u(T):T),M+=N(c)}for(let F=o-r-1;F>=r;F--){const T=t.children[F];U(f,t.leaf?u(T):T),M+=N(f)}return M}_adjustParentBBoxes(t,r,o){for(let l=o;l>=0;l--)U(r.data[l],t)}_condense(t){for(let r=t.length-1;r>=0;r--){const o=t.data[r];if(0===o.children.length)if(r>0){const l=t.data[r-1],u=l.children;u.splice((0,L.cq)(u,o,u.length,l.indexHint),1)}else this.clear();else S(o,this._toBBox)}}_initFormat(t){const r=["return a"," - b",";"];this._compareMinX=new Function("a","b",r.join(t[0])),this._compareMinY=new Function("a","b",r.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function S(s,t){z(s,0,s.children.length,t,s)}function z(s,t,r,o,l){l||(l=new h([])),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0;for(let u,c=t;c<r;c++)u=s.children[c],U(l,s.leaf?o(u):u);return l}function U(s,t){s.minX=Math.min(s.minX,t.minX),s.minY=Math.min(s.minY,t.minY),s.maxX=Math.max(s.maxX,t.maxX),s.maxY=Math.max(s.maxY,t.maxY)}function w(s,t){return s.minX-t.minX}function A(s,t){return s.minY-t.minY}function x(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function N(s){return s.maxX-s.minX+(s.maxY-s.minY)}function W(s,t){return(Math.max(t.maxX,s.maxX)-Math.min(t.minX,s.minX))*(Math.max(t.maxY,s.maxY)-Math.min(t.minY,s.minY))}function p(s,t){const r=Math.max(s.minX,t.minX),o=Math.max(s.minY,t.minY),l=Math.min(s.maxX,t.maxX),u=Math.min(s.maxY,t.maxY);return Math.max(0,l-r)*Math.max(0,u-o)}function g(s,t){return s.minX<=t.minX&&s.minY<=t.minY&&t.maxX<=s.maxX&&t.maxY<=s.maxY}function B(s,t){return t.minX<=s.maxX&&t.minY<=s.maxY&&t.maxX>=s.minX&&t.maxY>=s.minY}function Y(s,t,r,o,l){const u=[t,r];for(;u.length;){const c=u.pop(),f=u.pop();if(c-f<=o)continue;const M=f+Math.ceil((c-f)/o/2)*o;(0,G.q)(s,M,f,c,l),u.push(f,M,M,c)}}const P=new V.Z,C=new V.Z,j=new V.Z,v=new V.Z({deallocator:void 0});class _{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class I extends _{constructor(){super(...arguments),this.height=1,this.indexHint=new L.SO}}class h extends I{constructor(t){super(),this.children=t,this.leaf=!0}}class a extends I{constructor(t){super(),this.children=t,this.leaf=!1}}},15994:(Q,H,E)=>{E.d(H,{N:()=>L});const L={convertToGEGeometry:function V(p,g){return null==g?null:p.convertJSONToGeometry(g)},exportPoint:function Z(p,g,B){const Y=new G(p.getPointX(g),p.getPointY(g),B),P=p.hasZ(g),C=p.hasM(g);return P&&(Y.z=p.getPointZ(g)),C&&(Y.m=p.getPointM(g)),Y},exportPolygon:function z(p,g,B){return new S(p.exportPaths(g),B,p.hasZ(g),p.hasM(g))},exportPolyline:function w(p,g,B){return new U(p.exportPaths(g),B,p.hasZ(g),p.hasM(g))},exportMultipoint:function x(p,g,B){return new A(p.exportPoints(g),B,p.hasZ(g),p.hasM(g))},exportExtent:function W(p,g,B){const Y=p.hasZ(g),P=p.hasM(g),C=new N(p.getXMin(g),p.getYMin(g),p.getXMax(g),p.getYMax(g),B);if(Y){const j=p.getZExtent(g);C.zmin=j.vmin,C.zmax=j.vmax}if(P){const j=p.getMExtent(g);C.mmin=j.vmin,C.mmax=j.vmax}return C}};class G{constructor(g,B,Y){this.x=g,this.y=B,this.spatialReference=Y,this.z=void 0,this.m=void 0}}class S{constructor(g,B,Y,P){this.rings=g,this.spatialReference=B,this.hasZ=void 0,this.hasM=void 0,Y&&(this.hasZ=Y),P&&(this.hasM=P)}}class U{constructor(g,B,Y,P){this.paths=g,this.spatialReference=B,this.hasZ=void 0,this.hasM=void 0,Y&&(this.hasZ=Y),P&&(this.hasM=P)}}class A{constructor(g,B,Y,P){this.points=g,this.spatialReference=B,this.hasZ=void 0,this.hasM=void 0,Y&&(this.hasZ=Y),P&&(this.hasM=P)}}class N{constructor(g,B,Y,P,C){this.xmin=g,this.ymin=B,this.xmax=Y,this.ymax=P,this.spatialReference=C,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},7848:(Q,H,E)=>{E.d(H,{G6:()=>K,Ie:()=>R,J9:()=>T,RF:()=>u,U1:()=>y,vY:()=>z,ym:()=>M});var L=E(91179);const G=(n,e,i)=>[e,i],Z=(n,e,i)=>[e,i,n[2]],S=(n,e,i)=>[e,i,n[2],n[3]];function z(n){return n?{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:null!=n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}:null}function w({scale:n,translate:e},i){return Math.round((i-e[0])/n[0])}function A({scale:n,translate:e},i){return Math.round((e[1]-i)/n[1])}function x(n,e,i){const d=[];let m,b,X,O;for(let D=0;D<i.length;D++){const J=i[D];D>0?(X=w(n,J[0]),O=A(n,J[1]),X===m&&O===b||(d.push(e(J,X-m,O-b)),m=X,b=O)):(m=w(n,J[0]),b=A(n,J[1]),d.push(e(J,m,b)))}return d.length>0?d:null}function B({scale:n,translate:e},i){return i*n[0]+e[0]}function Y({scale:n,translate:e},i){return e[1]-i*n[1]}function P(n,e,i){const d=new Array(i.length);if(!i.length)return d;const[m,b]=n.scale;let X=B(n,i[0][0]),O=Y(n,i[0][1]);d[0]=e(i[0],X,O);for(let D=1;D<i.length;D++){const J=i[D];X+=J[0]*m,O-=J[1]*b,d[D]=e(J,X,O)}return d}function C(n,e,i){const d=new Array(i.length);for(let m=0;m<i.length;m++)d[m]=P(n,e,i[m]);return d}function u(n,e,i,d,m){return e.x=w(n,i.x),e.y=A(n,i.y),e!==i&&(d&&(e.z=i.z),m&&(e.m=i.m)),e}function M(n,e){return n&&e?(0,L.wp)(e)?u(n,{},e,!1,!1):(0,L.l9)(e)?function f(n,e,i,d,m){const b=function g(n,e,i,d){const m=[],b=i?d?S:Z:d?Z:G;for(let X=0;X<e.length;X++){const O=x(n,b,e[X]);O&&O.length>=2&&m.push(O)}return m.length?m:null}(n,i.paths,d,m);return b?(e.paths=b,e):null}(n,{},e,!1,!1):(0,L.oU)(e)?function c(n,e,i,d,m){const b=function p(n,e,i,d){const m=[],b=i?d?S:Z:d?Z:G;for(let X=0;X<e.length;X++){const O=x(n,b,e[X]);O&&O.length>=3&&m.push(O)}return m.length?m:null}(n,i.rings,d,m);return b?(e.rings=b,e):null}(n,{},e,!1,!1):(0,L.aW)(e)?function l(n,e,i,d,m){return e.points=function W(n,e,i,d){return x(n,i?d?S:Z:d?Z:G,e)}(n,i.points,d,m)??[],e}(n,{},e,!1,!1):(0,L.YX)(e)?function o(n,e,i,d,m){return e.xmin=w(n,i.xmin),e.ymin=A(n,i.ymin),e.xmax=w(n,i.xmax),e.ymax=A(n,i.ymax),e!==i&&(d&&(e.zmin=i.zmin,e.zmax=i.zmax),m&&(e.mmin=i.mmin,e.mmax=i.mmax)),e}(n,{},e,!1,!1):null:null}function T(n,e,i,d,m){return null!=i&&(e.points=function v(n,e,i,d){return P(n,i?d?S:Z:d?Z:G,e)}(n,i.points,d,m)),e}function y(n,e,i,d,m){return null==i||(e.x=B(n,i.x),e.y=Y(n,i.y),e!==i&&(d&&(e.z=i.z),m&&(e.m=i.m))),e}function R(n,e,i,d,m){return null!=i&&(e.rings=function I(n,e,i,d){return C(n,i?d?S:Z:d?Z:G,e)}(n,i.rings,d,m)),e}function K(n,e,i,d,m){return null!=i&&(e.paths=function _(n,e,i,d){return C(n,i?d?S:Z:d?Z:G,e)}(n,i.paths,d,m)),e}},61256:(Q,H,E)=>{E.d(H,{H:()=>w});var L=E(8314),V=E(36592),G=E(65401);const S={minX:0,minY:0,maxX:0,maxY:0};class w{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new V.Q(9,(0,L.Z)("esri-csp-restrictions")?x=>({minX:x[0],minY:x[1],maxX:x[2],maxY:x[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const x=new Array(this._idByBounds.size);let N=0;this._idByBounds.forEach((W,p)=>{x[N++]=p}),this._indexInvalid=!1,this._index.clear(),this._index.load(x)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(x=>this._idByBounds.has(x))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const x=(0,G.cS)();for(const N of this._boundsById.values())N&&(x[0]=Math.min(N[0],x[0]),x[1]=Math.min(N[1],x[1]),x[2]=Math.max(N[2],x[2]),x[3]=Math.max(N[3],x[3]));return x}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(x){const N=this._boundsById.get(x);this._boundsById.delete(x),N&&(this._idByBounds.delete(N),this._indexInvalid||this._index.remove(N))}forEachInBounds(x,N){this._loadIndex(),function U(A,x,N){(function z(A){S.minX=A[0],S.minY=A[1],S.maxX=A[2],S.maxY=A[3]})(x),A.search(S,N)}(this._index,x,W=>N(this._idByBounds.get(W)))}get(x){return this._boundsById.get(x)}has(x){return this._boundsById.has(x)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(x,N){if(!this._indexInvalid){const W=this._boundsById.get(x);W&&(this._index.remove(W),this._idByBounds.delete(W))}this._boundsById.set(x,N),N&&(this._idByBounds.set(N,x),this._indexInvalid||(this._boundsToLoad.push(N),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},81975:(Q,H,E)=>{E.d(H,{Z:()=>I});var L=E(85931),V=E(26584),G=E(61885),Z=E(63290),S=E(5548),z=E(65401),U=E(82054),w=E(61256),A=E(16983);function x(h,a){return h?a?4:3:a?3:2}function W(h,a,s,t,r,o,l=1){const u=x(r,o);let c=s,f=s+u,M=0,F=0,T=0,y=0,R=0;for(let n=0,e=t-1;n<e;n++,c+=u,f+=u){const i=a[c],d=a[c+1],m=a[c+2],b=a[f],X=a[f+1],O=a[f+2];let D=i*X-b*d;y+=D,M+=(i+b)*D,F+=(d+X)*D,r&&(D=i*O-b*m,T+=(m+O)*D,R+=D),i<h[0]&&(h[0]=i),i>h[1]&&(h[1]=i),d<h[2]&&(h[2]=d),d>h[3]&&(h[3]=d),r&&(m<h[4]&&(h[4]=m),m>h[5]&&(h[5]=m))}if(y*l>0&&(y*=-1),R*l>0&&(R*=-1),!y)return null;const K=[M,F,.5*y];return r&&(K[3]=T,K[4]=.5*R),K}function g(h,a,s,t){const r=s-h,o=t-a;return Math.sqrt(r*r+o*o)}function B(h,a,s,t,r,o){const l=t-h,u=r-a,c=o-s;return Math.sqrt(l*l+u*u+c*c)}function Y(h,a,s,t){return[h+.5*(s-h),a+.5*(t-a)]}function P(h,a,s,t,r,o){return[h+.5*(t-h),a+.5*(r-a),s+.5*(o-s)]}var C=E(66385),j=E(88071);const v={getObjectId:h=>h.objectId,getAttributes:h=>h.attributes,getAttribute:(h,a)=>h.attributes[a],cloneWithGeometry:(h,a)=>new C.u_(a,h.attributes,null,h.objectId),getGeometry:h=>h.geometry,getCentroid:(h,a)=>(null==h.centroid&&(h.centroid=function N(h,a,s,t,r){if(!a?.lengths.length)return null;const o="upperLeft"===r?.originPosition?-1:1;h.lengths.length&&(h.lengths.length=0),h.coords.length&&(h.coords.length=0);const l=h.coords,u=[],c=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:M}=a,F=x(s,t);let T=0;for(const y of f){const R=W(c,M,T,y,s,t,o);R&&u.push(R),T+=y*F}if(u.sort((y,R)=>{let K=o*y[2]-o*R[2];return 0===K&&s&&(K=y[4]-R[4]),K}),u.length){let y=6*u[0][2];l[0]=u[0][0]/y,l[1]=u[0][1]/y,s&&(y=6*u[0][4],l[2]=0!==y?u[0][3]/y:0),(l[0]<c[0]||l[0]>c[1]||l[1]<c[2]||l[1]>c[3]||s&&(l[2]<c[4]||l[2]>c[5]))&&(l.length=0)}if(!l.length){const y=a.lengths[0]?function p(h,a,s,t,r){const o=x(t,r);let l=a,u=a+o,c=0,f=0,M=0,F=0;for(let T=0,y=s-1;T<y;T++,l+=o,u+=o){const R=h[l],K=h[l+1],n=h[l+2],e=h[u],i=h[u+1],d=h[u+2],m=t?B(R,K,n,e,i,d):g(R,K,e,i);if(m)if(c+=m,t){const b=P(R,K,n,e,i,d);f+=m*b[0],M+=m*b[1],F+=m*b[2]}else{const b=Y(R,K,e,i);f+=m*b[0],M+=m*b[1]}}return c>0?t?[f/c,M/c,F/c]:[f/c,M/c]:s>0?t?[h[a],h[a+1],h[a+2]]:[h[a],h[a+1]]:null}(M,0,f[0],s,t):null;if(!y)return null;l[0]=y[0],l[1]=y[1],s&&y.length>2&&(l[2]=y[2])}return h}(new j.Z,h.geometry,a.hasZ,a.hasM)),h.centroid)},_=(0,S.Ue)();class I{constructor(a){this.geometryInfo=a,this._boundsStore=new w.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new G.Z,this.featureAdapter=v}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let a=0;return this._featuresById.forEach(s=>{null!=s.geometry&&s.geometry.coords&&(a+=s.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(a){if(null==this.fullBounds)return null;const[s,t,r,o]=this.fullBounds;return{xmin:s,ymin:t,xmax:r,ymax:o,spatialReference:(0,A.S2)(a)}}add(a){this._add(a),this._emitChanged()}addMany(a){for(const s of a)this._add(s);this._emitChanged()}upsertMany(a){const s=a.map(t=>this._upsert(t));return this._emitChanged(),s.filter(L.pC)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(a){const s=this._featuresById.get(a);return s?(this._remove(s),this._emitChanged(),s):null}removeManyById(a){this._boundsStore.invalidateIndex();for(const s of a){const t=this._featuresById.get(s);t&&this._remove(t)}this._emitChanged()}forEachBounds(a,s){for(const t of a){const r=this._boundsStore.get(t.objectId);r&&s((0,S.JR)(_,r))}}getFeature(a){return this._featuresById.get(a)}has(a){return this._featuresById.has(a)}forEach(a){this._featuresById.forEach(s=>a(s))}forEachInBounds(a,s){this._boundsStore.forEachInBounds(a,t=>{s(this._featuresById.get(t))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let a=!1;this._featuresById.forEach((s,t)=>{this._markedIds.has(t)||(a=!0,this._remove(s))}),this._markedIds.clear(),a&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(a){if(!a)return;const s=a.objectId;if(null==s)return void Z.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new V.Z("featurestore:invalid-feature","feature id is missing",{feature:a}));const t=this._featuresById.get(s);let r;if(this._markedIds.add(s),t?(a.displayId=t.displayId,r=this._boundsStore.get(s),this._boundsStore.delete(s)):null!=this.onFeatureAdd&&this.onFeatureAdd(a),!a.geometry?.coords?.length)return this._boundsStore.set(s,null),void this._featuresById.set(s,a);r=(0,U.$)(r??(0,z.Ue)(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(s,r),this._featuresById.set(s,a)}_upsert(a){const s=a?.objectId;if(null==s)return Z.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new V.Z("featurestore:invalid-feature","feature id is missing",{feature:a})),null;const t=this._featuresById.get(s);if(!t)return this._add(a),a;this._markedIds.add(s);const{geometry:r,attributes:o}=a;for(const l in o)t.attributes[l]=o[l];return r&&(t.geometry=r,this._boundsStore.set(s,(0,U.$)((0,z.Ue)(),r,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),t}_remove(a){null!=this.onFeatureRemove&&this.onFeatureRemove(a);const s=a.objectId;return this._markedIds.delete(s),this._boundsStore.delete(s),this._featuresById.delete(s),a}}},82959:(Q,H,E)=>{E.d(H,{_W:()=>W,iV:()=>Y,oj:()=>j});var L=E(15861),V=E(85931),G=E(10699),Z=E(5464),S=E(15994),z=E(37053),U=E(46367);const w=[0,0];function A(v,_){if(!_)return null;if("x"in _){const I={x:0,y:0};return[I.x,I.y]=v(_.x,_.y,w),null!=_.z&&(I.z=_.z),null!=_.m&&(I.m=_.m),I}if("xmin"in _){const I={xmin:0,ymin:0,xmax:0,ymax:0};return[I.xmin,I.ymin]=v(_.xmin,_.ymin,w),[I.xmax,I.ymax]=v(_.xmax,_.ymax,w),_.hasZ&&(I.zmin=_.zmin,I.zmax=_.zmax,I.hasZ=!0),_.hasM&&(I.mmin=_.mmin,I.mmax=_.mmax,I.hasM=!0),I}return"rings"in _?{rings:x(_.rings,v),hasM:_.hasM,hasZ:_.hasZ}:"paths"in _?{paths:x(_.paths,v),hasM:_.hasM,hasZ:_.hasZ}:"points"in _?{points:N(_.points,v),hasM:_.hasM,hasZ:_.hasZ}:null}function x(v,_){const I=[];for(const h of v)I.push(N(h,_));return I}function N(v,_){const I=[];for(const h of v){const a=_(h[0],h[1],[0,0]);I.push(a),h.length>2&&a.push(h[2]),h.length>3&&a.push(h[3])}return I}function W(v,_){return p.apply(this,arguments)}function p(){return(p=(0,L.Z)(function*(v,_){if(!v||!_)return;const I=Array.isArray(v)?v.map(h=>null!=h.geometry?h.geometry.spatialReference:null).filter(V.pC):[v];yield(0,Z.initializeProjection)(I.map(h=>({source:h,dest:_})))})).apply(this,arguments)}const g=A.bind(null,U.hG),B=A.bind(null,U.R6);function Y(v,_,I,h){if(!v||(I||(I=_,_=v.spatialReference),!(0,z.JY)(_)||!(0,z.JY)(I)||(0,z.fS)(_,I)))return v;if((0,U.Q8)(_,I)){const a=(0,z.sS)(I)?g(v):B(v);return a.spatialReference=I,a}return(0,Z.projectMany)(S.N,[v],_,I,null,h)[0]}const C=new class P{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}push(_,I,h,a){var s=this;return(0,L.Z)(function*(){if(!_?.length||!I||!h||(0,z.fS)(I,h))return _;const t={geometries:_,inSpatialReference:I,outSpatialReference:h,geographicTransformation:a,resolve:(0,G.hh)()};return s._jobs.push(t),s._timer??=setTimeout(s._process,10),t.resolve.promise})()}_process(){this._timer=null;const _=this._jobs.shift();if(!_)return;const{geometries:I,inSpatialReference:h,outSpatialReference:a,resolve:s,geographicTransformation:t}=_;(0,U.Q8)(h,a)?(0,z.sS)(a)?s(I.map(g)):s(I.map(B)):s((0,Z.projectMany)(S.N,I,h,a,t,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function j(v,_,I,h){return C.push(v,_,I,h)}}}]);