"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[1172],{11915:(se,Yt,W)=>{W.d(Yt,{e:()=>xt});var Ut,b,Q=W(1719),w={exports:{}};Ut=w,void 0!==(b=function(){function wt(h,T,d){d=d||2;var R,_,m,O,F,k,at,yt=T&&T.length,gt=yt?T[0]*d:h.length,it=vt(h,0,gt,d,!0),X=[];if(!it||it.next===it.prev)return X;if(yt&&(it=function M(h,T,d,R){var _,m,O,F=[];for(_=0,m=T.length;_<m;_++)(O=vt(h,T[_]*R,_<m-1?T[_+1]*R:h.length,R,!1))===O.next&&(O.steiner=!0),F.push(Lt(O));for(F.sort(j),_=0;_<F.length;_++)d=Tt(d=ct(F[_],d),d.next);return d}(h,T,it,d)),h.length>80*d){R=m=h[0],_=O=h[1];for(var K=d;K<gt;K+=d)(F=h[K])<R&&(R=F),(k=h[K+1])<_&&(_=k),F>m&&(m=F),k>O&&(O=k);at=0!==(at=Math.max(m-R,O-_))?1/at:0}return Ct(it,X,d,R,_,at),X}function vt(h,T,d,R,_){var m,O;if(_===Ht(h,T,d,R)>0)for(m=T;m<d;m+=R)O=q(m,h[m],h[m+1],O);else for(m=d-R;m>=T;m-=R)O=q(m,h[m],h[m+1],O);if(O&&$(O,O.next)){var F=O.next;nt(O),O=F}return O}function Tt(h,T){if(!h)return h;T||(T=h);var d,R=h;do{if(d=!1,R.steiner||!$(R,R.next)&&0!==Z(R.prev,R,R.next))R=R.next;else{var _=R.prev;if(nt(R),(R=T=_)===R.next)break;d=!0}}while(d||R!==T);return T}function Ct(h,T,d,R,_,m,O){if(h){!O&&m&&function Gt(h,T,d,R){var _=h;do{null===_.z&&(_.z=Nt(_.x,_.y,T,d,R)),_.prevZ=_.prev,_.nextZ=_.next,_=_.next}while(_!==h);_.prevZ.nextZ=null,_.prevZ=null,function At(h){var T,d,R,_,m,O,F,k,at=1;do{for(d=h,h=null,m=null,O=0;d;){for(O++,R=d,F=0,T=0;T<at&&(F++,R=R.nextZ);T++);for(k=at;F>0||k>0&&R;)0!==F&&(0===k||!R||d.z<=R.z)?(_=d,d=d.nextZ,F--):(_=R,R=R.nextZ,k--),m?m.nextZ=_:h=_,_.prevZ=m,m=_;d=R}m.nextZ=null,at*=2}while(O>1)}(_)}(h,R,_,m);for(var F,k,at=h;h.prev!==h.next;)if(F=h.prev,k=h.next,m?_t(h,R,_,m):Rt(h))T.push(F.i/d),T.push(h.i/d),T.push(k.i/d),nt(h),h=k.next,at=k.next;else if((h=k)===at){O?1===O?Ct(h=Ot(Tt(h),T,d),T,d,R,_,m,2):2===O&&H(h,T,d,R,_,m):Ct(Tt(h),T,d,R,_,m,1);break}}}function Rt(h){var T=h.prev,d=h,R=h.next;if(Z(T,d,R)>=0)return!1;for(var _=h.next.next;_!==h.prev;){if(mt(T.x,T.y,d.x,d.y,R.x,R.y,_.x,_.y)&&Z(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function _t(h,T,d,R){var _=h.prev,m=h,O=h.next;if(Z(_,m,O)>=0)return!1;for(var at=_.x>m.x?_.x>O.x?_.x:O.x:m.x>O.x?m.x:O.x,yt=_.y>m.y?_.y>O.y?_.y:O.y:m.y>O.y?m.y:O.y,gt=Nt(_.x<m.x?_.x<O.x?_.x:O.x:m.x<O.x?m.x:O.x,_.y<m.y?_.y<O.y?_.y:O.y:m.y<O.y?m.y:O.y,T,d,R),it=Nt(at,yt,T,d,R),X=h.prevZ,K=h.nextZ;X&&X.z>=gt&&K&&K.z<=it;){if(X!==h.prev&&X!==h.next&&mt(_.x,_.y,m.x,m.y,O.x,O.y,X.x,X.y)&&Z(X.prev,X,X.next)>=0||(X=X.prevZ,K!==h.prev&&K!==h.next&&mt(_.x,_.y,m.x,m.y,O.x,O.y,K.x,K.y)&&Z(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;X&&X.z>=gt;){if(X!==h.prev&&X!==h.next&&mt(_.x,_.y,m.x,m.y,O.x,O.y,X.x,X.y)&&Z(X.prev,X,X.next)>=0)return!1;X=X.prevZ}for(;K&&K.z<=it;){if(K!==h.prev&&K!==h.next&&mt(_.x,_.y,m.x,m.y,O.x,O.y,K.x,K.y)&&Z(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function Ot(h,T,d){var R=h;do{var _=R.prev,m=R.next.next;!$(_,m)&&et(_,R,R.next,m)&&t(_,m)&&t(m,_)&&(T.push(_.i/d),T.push(R.i/d),T.push(m.i/d),nt(R),nt(R.next),R=h=m),R=R.next}while(R!==h);return Tt(R)}function H(h,T,d,R,_,m){var O=h;do{for(var F=O.next.next;F!==O.prev;){if(O.i!==F.i&&It(O,F)){var k=bt(O,F);return O=Tt(O,O.next),k=Tt(k,k.next),Ct(O,T,d,R,_,m),void Ct(k,T,d,R,_,m)}F=F.next}O=O.next}while(O!==h)}function j(h,T){return h.x-T.x}function ht(h){if(h.next.prev===h)return h;let T=h;for(;;){const d=T.next;if(d.prev===T||d===T||d===h)break;T=d}return T}function ct(h,T){var d=function dt(h,T){var d,R=T,_=h.x,m=h.y,O=-1/0;do{if(m<=R.y&&m>=R.next.y&&R.next.y!==R.y){var F=R.x+(m-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(F<=_&&F>O){if(O=F,F===_){if(m===R.y)return R;if(m===R.next.y)return R.next}d=R.x<R.next.x?R:R.next}}R=R.next}while(R!==T);if(!d)return null;if(_===O)return d;var k,at=d,yt=d.x,gt=d.y,it=1/0;R=d;do{_>=R.x&&R.x>=yt&&_!==R.x&&mt(m<gt?_:O,m,yt,gt,m<gt?O:_,m,R.x,R.y)&&(k=Math.abs(m-R.y)/(_-R.x),t(R,h)&&(k<it||k===it&&(R.x>d.x||R.x===d.x&&Pt(d,R)))&&(d=R,it=k)),R=R.next}while(R!==at);return d}(h,T);if(!d)return T;var R=bt(d,h),_=Tt(d,d.next);let m=ht(R);return Tt(m,m.next),_=ht(_),ht(T===d?_:T)}function Pt(h,T){return Z(h.prev,h,T.prev)<0&&Z(T.next,h,h.next)<0}function Nt(h,T,d,R,_){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=32767*(h-d)*_)|h<<8))|h<<4))|h<<2))|h<<1))|(T=1431655765&((T=858993459&((T=252645135&((T=16711935&((T=32767*(T-R)*_)|T<<8))|T<<4))|T<<2))|T<<1))<<1}function Lt(h){var T=h,d=h;do{(T.x<d.x||T.x===d.x&&T.y<d.y)&&(d=T),T=T.next}while(T!==h);return d}function mt(h,T,d,R,_,m,O,F){return(_-O)*(T-F)-(h-O)*(m-F)>=0&&(h-O)*(R-F)-(d-O)*(T-F)>=0&&(d-O)*(m-F)-(_-O)*(R-F)>=0}function It(h,T){return h.next.i!==T.i&&h.prev.i!==T.i&&!function L(h,T){var d=h;do{if(d.i!==h.i&&d.next.i!==h.i&&d.i!==T.i&&d.next.i!==T.i&&et(d,d.next,h,T))return!0;d=d.next}while(d!==h);return!1}(h,T)&&(t(h,T)&&t(T,h)&&function Xt(h,T){var d=h,R=!1,_=(h.x+T.x)/2,m=(h.y+T.y)/2;do{d.y>m!=d.next.y>m&&d.next.y!==d.y&&_<(d.next.x-d.x)*(m-d.y)/(d.next.y-d.y)+d.x&&(R=!R),d=d.next}while(d!==h);return R}(h,T)&&(Z(h.prev,h,T.prev)||Z(h,T.prev,T))||$(h,T)&&Z(h.prev,h,h.next)>0&&Z(T.prev,T,T.next)>0)}function Z(h,T,d){return(T.y-h.y)*(d.x-T.x)-(T.x-h.x)*(d.y-T.y)}function $(h,T){return h.x===T.x&&h.y===T.y}function et(h,T,d,R){var _=ft(Z(h,T,d)),m=ft(Z(h,T,R)),O=ft(Z(d,R,h)),F=ft(Z(d,R,T));return _!==m&&O!==F||!(0!==_||!z(h,d,T))||!(0!==m||!z(h,R,T))||!(0!==O||!z(d,h,R))||!(0!==F||!z(d,T,R))}function z(h,T,d){return T.x<=Math.max(h.x,d.x)&&T.x>=Math.min(h.x,d.x)&&T.y<=Math.max(h.y,d.y)&&T.y>=Math.min(h.y,d.y)}function ft(h){return h>0?1:h<0?-1:0}function t(h,T){return Z(h.prev,h,h.next)<0?Z(h,T,h.next)>=0&&Z(h,h.prev,T)>=0:Z(h,T,h.prev)<0||Z(h,h.next,T)<0}function bt(h,T){var d=new ot(h.i,h.x,h.y),R=new ot(T.i,T.x,T.y),_=h.next,m=T.prev;return h.next=T,T.prev=h,d.next=_,_.prev=d,R.next=d,d.prev=R,m.next=R,R.prev=m,R}function q(h,T,d,R){var _=new ot(h,T,d);return R?(_.next=R.next,_.prev=R,R.next.prev=_,R.next=_):(_.prev=_,_.next=_),_}function nt(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function ot(h,T,d){this.i=h,this.x=T,this.y=d,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ht(h,T,d,R){for(var _=0,m=T,O=d-R;m<d;m+=R)_+=(h[O]-h[m])*(h[m+1]+h[O+1]),O=m;return _}return wt.deviation=function(h,T,d,R){var _=T&&T.length,O=Math.abs(Ht(h,0,_?T[0]*d:h.length,d));if(_)for(var F=0,k=T.length;F<k;F++)O-=Math.abs(Ht(h,T[F]*d,F<k-1?T[F+1]*d:h.length,d));var gt=0;for(F=0;F<R.length;F+=3){var it=R[F]*d,X=R[F+1]*d,K=R[F+2]*d;gt+=Math.abs((h[it]-h[K])*(h[X+1]-h[it+1])-(h[it]-h[X])*(h[K+1]-h[it+1]))}return 0===O&&0===gt?0:Math.abs((gt-O)/O)},wt.flatten=function(h){for(var T=h[0][0].length,d={vertices:[],holes:[],dimensions:T},R=0,_=0;_<h.length;_++){for(var m=0;m<h[_].length;m++)for(var O=0;O<T;O++)d.vertices.push(h[_][m][O]);_>0&&d.holes.push(R+=h[_-1].length)}return d},wt}())&&(Ut.exports=b);const xt=(0,Q.g)(w.exports)},58774:(se,Yt,W)=>{W.d(Yt,{b:()=>Rt,j:()=>wt});var Q=W(15861),Ut=W(54346),ut=W(8314);const b=128e3;let w=null,xt=null;function wt(){return vt.apply(this,arguments)}function vt(){return vt=(0,Q.Z)(function*(){return w||(w=function Tt(){return Ct.apply(this,arguments)}()),w}),vt.apply(this,arguments)}function Ct(){return(Ct=(0,Q.Z)(function*(){xt=yield((0,ut.Z)("esri-csp-restrictions")?yield W.e(71).then(W.bind(W,10071)).then(Ot=>Ot.l):yield W.e(9507).then(W.bind(W,99507)).then(Ot=>Ot.l)).load({locateFile:Ot=>(0,Ut.V)(`esri/core/libs/libtess/${Ot}`)})})).apply(this,arguments)}function Rt(_t,Ot){const H=Math.max(_t.length,b);return xt.triangulate(_t,Ot,H)}},90195:(se,Yt,W)=>{W.r(Yt),W.d(Yt,{default:()=>ie});var Q=W(15861),Ut=W(10699),ut=W(919),b=W(13160),w=W(86575);function wt(u){return!(u<11904)&&(u>=12704&&u<=12735||u>=12544&&u<=12591||u>=65072&&u<=65103||u>=63744&&u<=64255||u>=13056&&u<=13311||u>=11904&&u<=12031||u>=12736&&u<=12783||u>=12288&&u<=12351||u>=13312&&u<=19903||u>=19968&&u<=40959||u>=12800&&u<=13055||u>=65280&&u<=65519||u>=12352&&u<=12447||u>=12272&&u<=12287||u>=12032&&u<=12255||u>=12784&&u<=12799||u>=12448&&u<=12543||u>=65040&&u<=65055||u>=42128&&u<=42191||u>=40960&&u<=42127)}function vt(u){switch(u){case 10:case 32:case 38:case 40:case 41:case 43:case 45:case 47:case 173:case 183:case 8203:case 8208:case 8211:case 8231:return!0}return!1}function Tt(u){switch(u){case 9:case 10:case 11:case 12:case 13:case 32:return!0}return!1}var Ct=W(84439);class Ot{constructor(e,n,r,i,o,a,l){this._glyphItems=e,this._maxWidth=n,this._lineHeight=r,this._letterSpacing=i,this._hAnchor=o,this._vAnchor=a,this._justify=l}getShaping(e,n,r){const i=this._letterSpacing,o=this._lineHeight,a=this._justify,l=this._maxWidth,c=[];let f=0,y=0;for(const N of e){const P=N.codePointAt(0);if(null==P)continue;const U=r&&(746===(u=P)||747===u||!(u<4352)&&(u>=12704&&u<=12735||u>=12544&&u<=12591||u>=65072&&u<=65103&&!(u>=65097&&u<=65103)||u>=63744&&u<=64255||u>=13056&&u<=13311||u>=11904&&u<=12031||u>=12736&&u<=12783||u>=12288&&u<=12351&&!(u>=12296&&u<=12305||u>=12308&&u<=12319||12336===u)||u>=13312&&u<=19903||u>=19968&&u<=40959||u>=12800&&u<=13055||u>=12592&&u<=12687||u>=43360&&u<=43391||u>=55216&&u<=55295||u>=4352&&u<=4607||u>=44032&&u<=55215||u>=12352&&u<=12447||u>=12272&&u<=12287||u>=12688&&u<=12703||u>=12032&&u<=12255||u>=12784&&u<=12799||u>=12448&&u<=12543&&12540!==u||u>=65280&&u<=65519&&!(65288===u||65289===u||65293===u||u>=65306&&u<=65310||65339===u||65341===u||65343===u||u>=65371&&u<=65503||65507===u||u>=65512&&u<=65519)||u>=65104&&u<=65135&&!(u>=65112&&u<=65118||u>=65123&&u<=65126)||u>=5120&&u<=5759||u>=6320&&u<=6399||u>=65040&&u<=65055||u>=19904&&u<=19967||u>=40960&&u<=42127||u>=42128&&u<=42191));let C;for(const B of this._glyphItems)if(C=B[P],C)break;c.push({codePoint:P,x:f,y,vertical:U,glyphMosaicItem:C}),C&&(f+=C.metrics.advance+i)}var u;let E=f;l>0&&(E=f/Math.max(1,Math.ceil(f/l)));const x=e.includes("\u200b"),A=[],I=c.length;for(let N=0;N<I-1;N++){const P=c[N].codePoint,U=wt(P);if(vt(P)||U){let C=0;if(10===P)C-=1e4;else if(U&&x)C+=150;else{40!==P&&65288!==P||(C+=50);const B=c[N+1].codePoint;41!==B&&65289!==B||(C+=50)}A.push(this._buildBreak(N+1,c[N].x,E,A,C,!1))}}const p=this._optimalBreaks(this._buildBreak(I,f,E,A,0,!0));let D=0;const g=n?-o:o;let S=0;for(let N=0;N<p.length;N++){const P=p[N];let U=S;for(;U<P&&Tt(c[U].codePoint);)c[U].glyphMosaicItem=null,++U;let C=P-1;for(;C>U&&Tt(c[C].codePoint);)c[C].glyphMosaicItem=null,--C;if(U<=C){const B=c[U].x;for(let v=U;v<=C;v++)c[v].x-=B,c[v].y=y;let V=c[C].x;c[C].glyphMosaicItem&&(V+=c[C].glyphMosaicItem.metrics.advance),D=Math.max(V,D),a&&this._applyJustification(c,U,C)}S=P,y+=g}if(c.length>0){const N=p.length-1,P=(a-this._hAnchor)*D;let U=(-this._vAnchor*(N+1)+.5)*o;n&&N&&(U+=N*o);for(const C of c)C.x+=P,C.y+=U}return c.filter(N=>N.glyphMosaicItem)}static getTextBox(e,n){if(!e.length)return null;let r=1/0,i=1/0,o=0,a=0;for(const l of e){const f=l.x,y=l.y-17,E=f+l.glyphMosaicItem.metrics.advance,x=y+n;r=Math.min(r,f),o=Math.max(o,E),i=Math.min(i,y),a=Math.max(a,x)}return{x:r,y:i,width:o-r,height:a-i}}static getBox(e){if(!e.length)return null;let n=1/0,r=1/0,i=0,o=0;for(const a of e){const{height:l,left:c,top:f,width:y}=a.glyphMosaicItem.metrics,E=a.x,x=a.y-(l-Math.abs(f)),A=E+y+c,I=x+l;n=Math.min(n,E),i=Math.max(i,A),r=Math.min(r,x),o=Math.max(o,I)}return{x:n,y:r,width:i-n,height:o-r}}static addDecoration(e,n){const r=e.length;if(0===r)return;let o=e[0].x+e[0].glyphMosaicItem.metrics.left,a=e[0].y;for(let c=1;c<r;c++){const f=e[c];if(f.y!==a){const y=e[c-1].x+e[c-1].glyphMosaicItem.metrics.left+e[c-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:o,y:a+n-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new Ct.Z(4,0,4,8),metrics:{width:y-o,height:8,left:0,top:0,advance:0},page:0,code:0}}),a=f.y,o=f.x+f.glyphMosaicItem.metrics.left}}const l=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:o,y:a+n-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new Ct.Z(4,0,4,8),metrics:{width:l-o,height:8,left:0,top:0,advance:0},page:0,code:0}})}_breakScore(e,n,r,i){const o=(e-n)*(e-n);return i?e<n?o/2:2*o:o+Math.abs(r)*r}_buildBreak(e,n,r,i,o,a){let l=null,c=this._breakScore(n,r,o,a);for(const f of i){const E=this._breakScore(n-f.x,r,o,a)+f.score;E<=c&&(l=f,c=E)}return{index:e,x:n,score:c,previousBreak:l}}_optimalBreaks(e){return e?this._optimalBreaks(e.previousBreak).concat(e.index):[]}_applyJustification(e,n,r){const i=e[r],a=(i.x+(i.vertical?24:i.glyphMosaicItem?i.glyphMosaicItem.metrics.advance:0))*this._justify;for(let l=n;l<=r;l++)e[l].x-=a}}var H=W(47132),M=W(1268);class Gt{constructor(e,n,r=0,i=-1,o=.5){this.x=e,this.y=n,this.angle=r,this.segment=i,this.minzoom=o}}class At{constructor(e,n,r,i,o,a=.5,l=w.FM){this.anchor=e,this.labelAngle=n,this.glyphAngle=r,this.page=i,this.alternateVerticalGlyph=o,this.minzoom=a,this.maxzoom=l}}class Nt{constructor(e,n,r,i,o,a,l,c,f,y,E,x){this.tl=e,this.tr=n,this.bl=r,this.br=i,this.mosaicRect=o,this.labelAngle=a,this.minAngle=l,this.maxAngle=c,this.anchor=f,this.minzoom=y,this.maxzoom=E,this.page=x}}class Lt{constructor(e){this.shapes=e}}class mt{getIconPlacement(e,n,r){const i=new b.E9(e.x,e.y),o=r.rotationAlignment===M.aF.MAP,a=r.keepUpright;let l=r.rotate*w.nF;o&&(l+=e.angle);const c=new Lt([]);return r.allowOverlap&&r.ignorePlacement||!H.R8||(c.iconColliders=[]),this._addIconPlacement(c,i,n,r,l),o&&a&&this._addIconPlacement(c,i,n,r,l+w.RD),c}_addIconPlacement(e,n,r,i,o){const a=r.pixelRatio,l=r.width/a,c=r.height/a,f=i.offset;let y=f[0],E=f[1];switch(i.anchor){case M.nR.CENTER:y-=l/2,E-=c/2;break;case M.nR.LEFT:E-=c/2;break;case M.nR.RIGHT:y-=l,E-=c/2;break;case M.nR.TOP:y-=l/2;break;case M.nR.BOTTOM:y-=l/2,E-=c;break;case M.nR.TOP_LEFT:break;case M.nR.BOTTOM_LEFT:E-=c;break;case M.nR.TOP_RIGHT:y-=l;break;case M.nR.BOTTOM_RIGHT:y-=l,E-=c}const x=r.rect,A=2/a,I=y-A,p=E-A,D=I+x.width/a,g=p+x.height/a,S=new b.E9(I,p),N=new b.E9(D,g),P=new b.E9(I,g),U=new b.E9(D,p);if(0!==o){const B=Math.cos(o),V=Math.sin(o);S.rotate(B,V),N.rotate(B,V),P.rotate(B,V),U.rotate(B,V)}const C=new Nt(S,U,P,N,x,o,0,256,n,.5,w.FM,0);if(e.shapes.push(C),(!i.allowOverlap||!i.ignorePlacement)&&H.R8){const B=i.size,V=i.padding;e.iconColliders.push({xTile:n.x,yTile:n.y,dxPixels:y*B-V,dyPixels:E*B-V,hard:!i.optional,partIndex:0,width:l*B+2*V,height:c*B+2*V,angle:o,minLod:.5,maxLod:w.FM})}}getTextPlacement(e,n,r,i){const o=new b.E9(e.x,e.y),a=i.rotate*w.nF,l=i.rotationAlignment===M.aF.MAP,c=i.keepUpright,f=i.padding;let y=.5;const E=l?e.angle:0,x=e.segment>=0&&l,A=i.allowOverlap&&i.ignorePlacement?null:[],I=[],D=!x;let g=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,N=g,P=S;const U=(x||l)&&c,C=i.size/24;let B=!1;for(const G of n)if(G.vertical){B=!0;break}let V,v=0,Y=0;if(!x&&B){const G=Ot.getTextBox(n,24*i.lineHeight);switch(i.anchor){case M.nR.LEFT:v=G.height/2,Y=-G.width/2;break;case M.nR.RIGHT:v=-G.height/2,Y=G.width/2;break;case M.nR.TOP:v=G.height/2,Y=G.width/2;break;case M.nR.BOTTOM:v=-G.height/2,Y=-G.width/2;break;case M.nR.TOP_LEFT:v=G.height;break;case M.nR.BOTTOM_LEFT:Y=-G.width;break;case M.nR.TOP_RIGHT:Y=G.width;break;case M.nR.BOTTOM_RIGHT:v=-G.height}}v+=24*i.offset[0],Y+=24*i.offset[1];for(const G of n){const lt=G.glyphMosaicItem;if(!lt||lt.rect.isEmpty)continue;const st=lt.rect,rt=lt.metrics,Bt=lt.page;if(A&&D){if(void 0!==V&&V!==G.y){let pt,Vt,jt,Qt;B?(pt=-P+v,Vt=g+Y,jt=P-N,Qt=S-g):(pt=g+v,Vt=N+Y,jt=S-g,Qt=P-N),A.push({xTile:e.x,yTile:e.y,dxPixels:pt*C-f,dyPixels:Vt*C-f,hard:!i.optional,partIndex:1,width:jt*C+2*f,height:Qt*C+2*f,angle:a,minLod:.5,maxLod:w.FM}),g=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,N=g,P=S}V=G.y}const te=[];if(x){const Vt=(G.x+rt.left-4+.5*lt.metrics.width)*C*8;if(y=this._placeGlyph(e,y,Vt,r,e.segment,1,G.vertical,Bt,te),c&&(y=this._placeGlyph(e,y,Vt,r,e.segment,-1,G.vertical,Bt,te)),y>=2)break}else te.push(new At(o,E,E,Bt,!1)),l&&c&&te.push(new At(o,E+w.RD,E+w.RD,Bt,!1));const Zt=G.x+rt.left,Jt=G.y-17-rt.top,ee=Zt+rt.width,fe=Jt+rt.height;let Ft,Kt,ae,le,ne,he,Ee,de;!x&&B?G.vertical?(Ft=new b.E9(-((Jt+fe)/2+rt.width/2)-4+v,(Zt+ee)/2-rt.height/2-4+Y),Kt=new b.E9(Ft.x+st.width,Ft.y+st.height),ae=new b.E9(Ft.x,Kt.y),le=new b.E9(Kt.x,Ft.y)):(Ft=new b.E9(4-Jt+v,Zt-4+Y),Kt=new b.E9(Ft.x-st.height,Ft.y+st.width),ae=new b.E9(Kt.x,Ft.y),le=new b.E9(Ft.x,Kt.y)):(Ft=new b.E9(Zt-4+v,Jt-4+Y),Kt=new b.E9(Ft.x+st.width,Ft.y+st.height),ae=new b.E9(Ft.x,Kt.y),le=new b.E9(Kt.x,Ft.y));for(const pt of te){let Vt,jt,Qt,$t;pt.alternateVerticalGlyph?(ne||(ne=new b.E9((Zt+ee)/2+v-rt.height/2-4,(Jt+fe)/2+Y+rt.width/2+4),he=new b.E9(ne.x+st.height,ne.y-st.width),Ee=new b.E9(he.x,ne.y),de=new b.E9(ne.x,he.y)),Vt=ne,jt=Ee,Qt=de,$t=he):(Vt=Ft,jt=ae,Qt=le,$t=Kt);const ce=Jt,ye=fe,ue=pt.glyphAngle+a;if(0!==ue){const qt=Math.cos(ue),xe=Math.sin(ue);Vt=Vt.clone(),jt=jt?.clone(),Qt=Qt?.clone(),$t=$t?.clone(),Vt.rotate(qt,xe),$t?.rotate(qt,xe),jt?.rotate(qt,xe),Qt?.rotate(qt,xe)}let re=0,oe=256;x&&B?G.vertical?pt.alternateVerticalGlyph?(re=32,oe=96):(re=224,oe=32):(re=224,oe=96):(re=192,oe=64),I.push(new Nt(Vt,Qt,jt,$t,st,pt.labelAngle,re,oe,pt.anchor,pt.minzoom,pt.maxzoom,pt.page)),!A||U&&!this._legible(pt.labelAngle)||(D?(Zt<g&&(g=Zt),ce<N&&(N=ce),ee>S&&(S=ee),ye>P&&(P=ye)):pt.minzoom<2&&A.push({xTile:e.x,yTile:e.y,dxPixels:(Zt+v)*C-f,dyPixels:(ce+v)*C-f,hard:!i.optional,partIndex:1,width:(ee-Zt)*C+2*f,height:(ye-ce)*C+2*f,angle:ue,minLod:pt.minzoom,maxLod:pt.maxzoom}))}}if(y>=2)return null;if(A&&D){let G,lt,st,rt;B?(G=-P+v,lt=g+Y,st=P-N,rt=S-g):(G=g+v,lt=N+Y,st=S-g,rt=P-N),A.push({xTile:e.x,yTile:e.y,dxPixels:G*C-f,dyPixels:lt*C-f,hard:!i.optional,partIndex:1,width:st*C+2*f,height:rt*C+2*f,angle:a,minLod:.5,maxLod:w.FM})}const J=new Lt(I);return A&&A.length>0&&(J.textColliders=A),J}_legible(e){const n=(0,w.Or)(e);return n<65||n>=193}_placeGlyph(e,n,r,i,o,a,l,c,f){let y=a;const E=y<0?(0,w.DQ)(e.angle+w.RD,w.yF):e.angle;let x=0;r<0&&(y*=-1,r*=-1,x=w.RD),y>0&&++o;let A=new b.E9(e.x,e.y),I=i[o],p=w.FM;if(i.length<=o)return p;for(;;){const D=I.x-A.x,g=I.y-A.y,S=Math.sqrt(D*D+g*g),N=Math.max(r/S,n),C=(0,w.DQ)(Math.atan2(g/S,D/S)+x,w.yF);if(f.push(new At(A,E,C,c,!1,N,p)),l&&f.push(new At(A,E,C,c,!0,N,p)),N<=n)return N;A=I.clone();do{if(i.length<=(o+=y)||o<0)return N;I=i[o]}while(A.isEqual(I));let B=I.x-A.x,V=I.y-A.y;const v=Math.sqrt(B*B+V*V);B*=S/v,V*=S/v,A.x-=B,A.y-=V,p=N}}}var $,u,It=W(24192),Z=W(58774);(u=$||($={}))[u.moveTo=1]="moveTo",u[u.lineTo=2]="lineTo",u[u.close=7]="close";class et{constructor(e,n){this.values={},this._geometry=void 0,this._pbfGeometry=null;const r=n.keys,i=n.values,o=e.asUnsafe();for(;o.next();)switch(o.tag()){case 1:this.id=o.getUInt64();break;case 2:{const a=o.getMessage().asUnsafe(),l=this.values;for(;!a.empty();){const c=a.getUInt32(),f=a.getUInt32();l[r[c]]=i[f]}a.release();break}case 3:this.type=o.getUInt32();break;case 4:this._pbfGeometry=o.getMessage();break;default:o.skip()}}getGeometry(e){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;const n=this._pbfGeometry.asUnsafe();let r,i;this._pbfGeometry=null,e?e.reset(this.type):r=[];let o,a=$.moveTo,l=0,c=0,f=0;for(;!n.empty();){if(0===l){const y=n.getUInt32();a=7&y,l=y>>3}switch(l--,a){case $.moveTo:c+=n.getSInt32(),f+=n.getSInt32(),e?e.moveTo(c,f):r&&(i&&r.push(i),i=[],i.push(new b.E9(c,f)));break;case $.lineTo:c+=n.getSInt32(),f+=n.getSInt32(),e?e.lineTo(c,f):i&&i.push(new b.E9(c,f));break;case $.close:e?e.close():i&&!i[0].equals(c,f)&&i.push(i[0].clone());break;default:throw n.release(),new Error("Invalid path operation")}}return e?o=e.result():r&&(i&&r.push(i),o=r),n.release(),this._geometry=o,o}}var z=W(36243);class ft extends z.Z{constructor(){super(12)}add(e,n,r){const i=this.array;i.push(e),i.push(n),i.push(r)}}class t{constructor(e){this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=e.clone();const n=e.asUnsafe();for(;n.next();)switch(n.tag()){case 1:this.name=n.getString();break;case 3:this.keys.push(n.getString());break;case 4:this.values.push(n.processMessage(t._parseValue));break;case 5:this.extent=n.getUInt32();break;default:n.skip()}}getData(){return this._pbfLayer}static _parseValue(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null}}class Xt extends z.Z{constructor(e){super(e)}add(e,n,r,i,o,a,l,c,f,y,E,x){const A=this.array;let I=z.Z.i1616to32(e,n);A.push(I);const p=31;I=z.Z.i8888to32(Math.round(p*r),Math.round(p*i),Math.round(p*o),Math.round(p*a)),A.push(I),I=z.Z.i8888to32(Math.round(p*l),Math.round(p*c),Math.round(p*f),Math.round(p*y)),A.push(I),I=z.Z.i1616to32(E,0),A.push(I),x&&A.push(...x)}}class bt extends z.Z{constructor(e){super(e)}add(e,n,r){const i=this.array;i.push(z.Z.i1616to32(e,n)),r&&i.push(...r)}}class q extends z.Z{constructor(e){super(e)}add(e,n,r,i,o,a,l){const c=this.array,f=this.index;let y=z.Z.i1616to32(e,n);return c.push(y),y=z.Z.i8888to32(Math.round(15*r),Math.round(15*i),o,a),c.push(y),l&&c.push(...l),f}}class nt extends z.Z{constructor(e){super(e)}add(e,n,r,i,o,a,l,c,f,y,E,x){const A=this.array;let I=z.Z.i1616to32(e,n);A.push(I),I=z.Z.i1616to32(Math.round(8*r),Math.round(8*i)),A.push(I),I=z.Z.i8888to32(o/4,a/4,c,f),A.push(I),I=z.Z.i8888to32(0,(0,w.Or)(l),10*y,Math.min(10*E,255)),A.push(I),x&&A.push(...x)}}class ot extends z.Z{constructor(e){super(e)}add(e,n,r,i,o){const a=this.array,l=z.Z.i1616to32(2*e+r,2*n+i);a.push(l),o&&a.push(...o)}}class Ht{constructor(e,n,r){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=n,this._spriteInfo=r,this._filter=e.getFeatureFilter()}pushFeature(e){this._filter&&!this._filter.filter(e,this.zoom)||this._features.push(e)}hasFeatures(){return this._features.length>0}getResources(e,n,r){}}class h extends Ht{constructor(e,n,r,i,o){super(e,n,r),this.type=ut.al.CIRCLE,this._circleVertexBuffer=i,this._circleIndexBuffer=o}get circleIndexStart(){return this._circleIndexStart}get circleIndexCount(){return this._circleIndexCount}processFeatures(e){const n=this._circleVertexBuffer,r=this._circleIndexBuffer;this._circleIndexStart=3*r.index,this._circleIndexCount=0;const i=this.layer,o=this.zoom;e&&e.setExtent(this.layerExtent);for(const a of this._features){const l=a.getGeometry(e);if(!l)continue;const c=i.circleMaterial.encodeAttributes(a,o,i);for(const f of l)if(f)for(const y of f){const E=n.index;n.add(y.x,y.y,0,0,c),n.add(y.x,y.y,0,1,c),n.add(y.x,y.y,1,0,c),n.add(y.x,y.y,1,1,c),r.add(E,E+1,E+2),r.add(E+1,E+2,E+3),this._circleIndexCount+=6}}}serialize(){let e=6;e+=this.layerUIDs.length,e+=this._circleVertexBuffer.array.length,e+=this._circleIndexBuffer.array.length;const n=new Uint32Array(e),r=new Int32Array(n.buffer);let i=0;n[i++]=this.type,n[i++]=this.layerUIDs.length;for(let o=0;o<this.layerUIDs.length;o++)n[i++]=this.layerUIDs[o];n[i++]=this._circleIndexStart,n[i++]=this._circleIndexCount,n[i++]=this._circleVertexBuffer.array.length;for(let o=0;o<this._circleVertexBuffer.array.length;o++)r[i++]=this._circleVertexBuffer.array[o];n[i++]=this._circleIndexBuffer.array.length;for(let o=0;o<this._circleIndexBuffer.array.length;o++)n[i++]=this._circleIndexBuffer.array[o];return n.buffer}}var T=W(35575),d=W(11915);class R extends Ht{constructor(e,n,r,i,o,a,l){super(e,n,r),this.type=ut.al.FILL,this._patternMap=new Map,this._fillVertexBuffer=i,this._fillIndexBuffer=o,this._outlineVertexBuffer=a,this._outlineIndexBuffer=l}get fillIndexStart(){return this._fillIndexStart}get fillIndexCount(){return this._fillIndexCount}get outlineIndexStart(){return this._outlineIndexStart}get outlineIndexCount(){return this._outlineIndexCount}getResources(e,n,r){const o=this.zoom,a=this.layer.getPaintProperty("fill-pattern");if(a)if(a.isDataDriven)for(const l of this._features)n(a.getValue(o,l),!0);else n(a.getValue(o),!0)}processFeatures(e){this._fillIndexStart=3*this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=3*this._outlineIndexBuffer.index,this._outlineIndexCount=0;const n=this.layer,r=this.zoom,{fillMaterial:i,outlineMaterial:o,hasDataDrivenFill:a,hasDataDrivenOutline:l}=n;e&&e.setExtent(this.layerExtent);const c=n.getPaintProperty("fill-pattern"),f=c?.isDataDriven;let y=!c&&n.getPaintValue("fill-antialias",r);if(n.outlineUsesFillColor){if(y&&!n.hasDataDrivenOpacity){const A=n.getPaintValue("fill-opacity",r),I=n.getPaintValue("fill-opacity",r+1);A<1&&I<1&&(y=!1)}if(y&&!n.hasDataDrivenColor){const A=n.getPaintValue("fill-color",r),I=n.getPaintValue("fill-color",r+1);A[3]<1&&I[3]<1&&(y=!1)}}const E=this._features,x=e?.validateTessellation;if(f){const A=[];for(const I of E){const p=c.getValue(r,I),D=this._spriteInfo[p];if(!D?.rect)continue;const g=i.encodeAttributes(I,r,n,D),S=y&&l?o.encodeAttributes(I,r,n):[],N=I.getGeometry(e);A.push({ddFillAttributes:g,ddOutlineAttributes:S,page:D.page,geometry:N}),A.sort((P,U)=>P.page-U.page);for(const{ddFillAttributes:P,ddOutlineAttributes:U,page:C,geometry:B}of A)this._processFeature(B,y,n.outlineUsesFillColor,P,U,x,C)}}else for(const A of E){const I=a?i.encodeAttributes(A,r,n):null,p=y&&l?o.encodeAttributes(A,r,n):null,D=A.getGeometry(e);this._processFeature(D,y,n.outlineUsesFillColor,I,p,x)}}serialize(){let e=10;e+=this.layerUIDs.length,e+=this._fillVertexBuffer.array.length,e+=this._fillIndexBuffer.array.length,e+=this._outlineVertexBuffer.array.length,e+=this._outlineIndexBuffer.array.length,e+=3*this._patternMap.size+1;const n=new Uint32Array(e),r=new Int32Array(n.buffer);let i=0;n[i++]=this.type,n[i++]=this.layerUIDs.length;for(let l=0;l<this.layerUIDs.length;l++)n[i++]=this.layerUIDs[l];n[i++]=this._fillIndexStart,n[i++]=this._fillIndexCount,n[i++]=this._outlineIndexStart,n[i++]=this._outlineIndexCount;const o=this._patternMap,a=o.size;if(n[i++]=a,a>0)for(const[l,[c,f]]of o)n[i++]=l,n[i++]=c,n[i++]=f;n[i++]=this._fillVertexBuffer.array.length;for(let l=0;l<this._fillVertexBuffer.array.length;l++)r[i++]=this._fillVertexBuffer.array[l];n[i++]=this._fillIndexBuffer.array.length;for(let l=0;l<this._fillIndexBuffer.array.length;l++)n[i++]=this._fillIndexBuffer.array[l];n[i++]=this._outlineVertexBuffer.array.length;for(let l=0;l<this._outlineVertexBuffer.array.length;l++)r[i++]=this._outlineVertexBuffer.array[l];n[i++]=this._outlineIndexBuffer.array.length;for(let l=0;l<this._outlineIndexBuffer.array.length;l++)n[i++]=this._outlineIndexBuffer.array[l];return n.buffer}_processFeature(e,n,r,i,o,a,l){if(!e)return;const c=e.length;if(n&&(!r||!o||0===o.length))for(let x=0;x<c;x++)this._processOutline(e[x],o);let E;for(let x=0;x<c;x++){const A=R._area(e[x]);A>32?(void 0!==E&&this._processFill(e,E,i,a,l),E=[x]):A<-32&&void 0!==E&&E.push(x)}void 0!==E&&this._processFill(e,E,i,a,l)}_processOutline(e,n){const r=this._outlineVertexBuffer,i=this._outlineIndexBuffer,o=i.index;let a,l,c;const f=new b.E9(0,0),y=new b.E9(0,0),E=new b.E9(0,0);let x=-1,A=-1,I=-1,p=-1,D=-1,g=!1,N=e.length;if(N<2)return;const P=e[0];let U=e[N-1];for(;N&&U.isEqual(P);)--N,U=e[N-1];if(!(N-0<2)){for(let C=0;C<N;++C){0===C?(a=e[N-1],l=e[0],c=e[1],f.assignSub(l,a),f.normalize(),f.rightPerpendicular()):(a=l,l=c,c=C!==N-1?e[C+1]:e[0],f.assign(y));const B=this._isClipEdge(a,l);-1===p&&(g=B),y.assignSub(c,l),y.normalize(),y.rightPerpendicular();const V=f.x*y.y-f.y*y.x;E.assignAdd(f,y),E.normalize();const v=-E.x*-f.x+-E.y*-f.y;let Y=Math.abs(0!==v?1/v:1);Y>8&&(Y=8),V>=0?(I=r.add(l.x,l.y,f.x,f.y,0,1,n),-1===p&&(p=I),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I),A=r.add(l.x,l.y,Y*-E.x,Y*-E.y,0,-1,n),-1===D&&(D=A),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I),x=A,A=I,I=r.add(l.x,l.y,E.x,E.y,0,1,n),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I),A=r.add(l.x,l.y,y.x,y.y,0,1,n),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I)):(I=r.add(l.x,l.y,Y*E.x,Y*E.y,0,1,n),-1===p&&(p=I),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I),A=r.add(l.x,l.y,-f.x,-f.y,0,-1,n),-1===D&&(D=A),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I),x=A,A=I,I=r.add(l.x,l.y,-E.x,-E.y,0,-1,n),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I),x=r.add(l.x,l.y,-y.x,-y.y,0,-1,n),x>=0&&A>=0&&I>=0&&!B&&i.add(x,A,I))}x>=0&&A>=0&&p>=0&&!g&&i.add(x,A,p),x>=0&&p>=0&&D>=0&&!g&&i.add(x,D,p),this._outlineIndexCount+=3*(i.index-o)}}_processFill(e,n,r,i,o){let a;n.length>1&&(a=[]);let l=0;for(const E of n)0!==l&&a.push(l),l+=e[E].length;const c=2*l,f=T.Z.acquire();for(const E of n){const x=e[E],A=x.length;for(let I=0;I<A;++I)f.push(x[I].x,x[I].y)}const y=(0,d.e)(f,a,2);if(d.e.deviation(f,a,2,y)>0){const E=n.map(I=>e[I].length),{buffer:x,vertexCount:A}=(0,Z.b)(f,E);if(A>0){const I=this._fillVertexBuffer.index;for(let p=0;p<A;p++)this._fillVertexBuffer.add(x[2*p],x[2*p+1],r);for(let p=0;p<A;p+=3){const D=I+p;this._fillIndexBuffer.add(D,D+1,D+2)}if(void 0!==o){const p=this._patternMap,D=p.get(o);D?D[1]+=A:p.set(o,[this._fillIndexStart+this._fillIndexCount,A])}this._fillIndexCount+=A}}else{const E=y.length;if(E>0){const x=this._fillVertexBuffer.index;let A=0;for(;A<c;)this._fillVertexBuffer.add(f[A++],f[A++],r);let I=0;for(;I<E;)this._fillIndexBuffer.add(x+y[I++],x+y[I++],x+y[I++]);if(void 0!==o){const p=this._patternMap,D=p.get(o);D?D[1]+=E:p.set(o,[this._fillIndexStart+this._fillIndexCount,E])}this._fillIndexCount+=E}}T.Z.release(f)}_isClipEdge(e,n){return e.x===n.x?e.x<=-64||e.x>=4160:e.y===n.y&&(e.y<=-64||e.y>=4160)}static _area(e){let n=0;const r=e.length-1;for(let i=0;i<r;i++)n+=(e[i].x-e[i+1].x)*(e[i].y+e[i+1].y);return n+=(e[r].x-e[0].x)*(e[r].y+e[0].y),.5*n}}var _=W(46519);class O extends Ht{constructor(e,n,r,i,o){super(e,n,r),this.type=ut.al.LINE,this._tessellationOptions={pixelCoordRatio:8,halfWidth:0,offset:0},this._patternMap=new Map,this.tessellationProperties={_lineVertexBuffer:null,_lineIndexBuffer:null,_ddValues:null},this.tessellationProperties._lineVertexBuffer=i,this.tessellationProperties._lineIndexBuffer=o,this._lineTessellator=new _.z(F(this.tessellationProperties),k(this.tessellationProperties),e.canUseThinTessellation)}get lineIndexStart(){return this._lineIndexStart}get lineIndexCount(){return this._lineIndexCount}getResources(e,n,r){const i=this.layer,o=this.zoom,a=i.getPaintProperty("line-pattern"),l=i.getPaintProperty("line-dasharray"),c=i.getLayoutProperty("line-cap");if(!a&&!l)return;const f=c?.getValue(o)||0,y=c?.isDataDriven,E=a?.isDataDriven,x=l?.isDataDriven;if(E||x)for(const A of this._features)n(E?a.getValue(o,A):this._getDashArrayKey(A,o,i,l,y,c,f));else if(a)n(a.getValue(o));else if(l){const A=l.getValue(o);n(i.getDashKey(A,f))}}processFeatures(e){this._lineIndexStart=3*this.tessellationProperties._lineIndexBuffer.index,this._lineIndexCount=0;const n=this.layer,r=this.zoom,i=this._features,o=this._tessellationOptions,{hasDataDrivenLine:a,lineMaterial:l}=n;e&&e.setExtent(this.layerExtent);const c=n.getPaintProperty("line-pattern"),f=n.getPaintProperty("line-dasharray"),y=c?.isDataDriven,E=f?.isDataDriven;let x;x=n.getLayoutProperty("line-cap");const A=x?.isDataDriven?x:null,I=A?null:n.getLayoutValue("line-cap",r),p=I||0,D=!!A;x=n.getLayoutProperty("line-join");const g=x?.isDataDriven?x:null,S=g?null:n.getLayoutValue("line-join",r);x=n.getLayoutProperty("line-miter-limit");const N=x?.isDataDriven?x:null,P=N?null:n.getLayoutValue("line-miter-limit",r);x=n.getLayoutProperty("line-round-limit");const U=x?.isDataDriven?x:null,C=U?null:n.getLayoutValue("line-round-limit",r);x=n.getPaintProperty("line-width");const B=x?.isDataDriven?x:null,V=B?null:n.getPaintValue("line-width",r);x=n.getPaintProperty("line-offset");const v=x?.isDataDriven?x:null,Y=v?null:n.getPaintValue("line-offset",r);if(y||E){const J=[];for(const G of i){const lt=y?c.getValue(r,G):this._getDashArrayKey(G,r,n,f,D,A,p),st=this._spriteInfo[lt];if(!st?.rect)continue;const rt=l.encodeAttributes(G,r,n,st),Bt=G.getGeometry(e);J.push({ddAttributes:rt,page:st.page,cap:A?A.getValue(r,G):I,join:g?g.getValue(r,G):S,miterLimit:N?N.getValue(r,G):P,roundLimit:U?U.getValue(r,G):C,halfWidth:.5*(B?B.getValue(r,G):V),offset:v?v.getValue(r,G):Y,geometry:Bt})}J.sort((G,lt)=>G.page-lt.page),o.textured=!0;for(const{ddAttributes:G,page:lt,cap:st,join:rt,miterLimit:Bt,roundLimit:te,halfWidth:Zt,offset:Jt,geometry:ee}of J)o.capType=st,o.joinType=rt,o.miterLimit=Bt,o.roundLimit=te,o.halfWidth=Zt,o.offset=Jt,this._processFeature(ee,G,lt)}else{if(c){const J=c.getValue(r);if(!this._spriteInfo[J]?.rect)return}o.textured=!(!c&&!f),o.capType=I,o.joinType=S,o.miterLimit=P,o.roundLimit=C,o.halfWidth=.5*V,o.offset=Y;for(const J of i){const G=a?l.encodeAttributes(J,r,n):null;A&&(o.capType=A.getValue(r,J)),g&&(o.joinType=g.getValue(r,J)),N&&(o.miterLimit=N.getValue(r,J)),U&&(o.roundLimit=U.getValue(r,J)),B&&(o.halfWidth=.5*B.getValue(r,J)),v&&(o.offset=v.getValue(r,J));const lt=J.getGeometry(e);this._processFeature(lt,G)}}}serialize(){let e=6;e+=this.layerUIDs.length,e+=this.tessellationProperties._lineVertexBuffer.array.length,e+=this.tessellationProperties._lineIndexBuffer.array.length,e+=3*this._patternMap.size+1;const n=new Uint32Array(e),r=new Int32Array(n.buffer);let i=0;n[i++]=this.type,n[i++]=this.layerUIDs.length;for(let l=0;l<this.layerUIDs.length;l++)n[i++]=this.layerUIDs[l];n[i++]=this._lineIndexStart,n[i++]=this._lineIndexCount;const o=this._patternMap,a=o.size;if(n[i++]=a,a>0)for(const[l,[c,f]]of o)n[i++]=l,n[i++]=c,n[i++]=f;n[i++]=this.tessellationProperties._lineVertexBuffer.array.length;for(let l=0;l<this.tessellationProperties._lineVertexBuffer.array.length;l++)r[i++]=this.tessellationProperties._lineVertexBuffer.array[l];n[i++]=this.tessellationProperties._lineIndexBuffer.array.length;for(let l=0;l<this.tessellationProperties._lineIndexBuffer.array.length;l++)n[i++]=this.tessellationProperties._lineIndexBuffer.array[l];return n.buffer}_processFeature(e,n,r){if(!e)return;const i=e.length;for(let o=0;o<i;o++)this._processGeometry(e[o],n,r)}_processGeometry(e,n,r){if(e.length<2)return;let o,a,l=e[0],c=1;for(;c<e.length;)o=e[c].x-l.x,a=e[c].y-l.y,o*o+a*a<1e-6?e.splice(c,1):(l=e[c],++c);if(e.length<2)return;const f=this.tessellationProperties._lineIndexBuffer,y=3*f.index;this._tessellationOptions.initialDistance=0,this._tessellationOptions.wrapDistance=65535,this.tessellationProperties._ddValues=n,this._lineTessellator.tessellate(e,this._tessellationOptions);const E=3*f.index-y;if(void 0!==r){const x=this._patternMap,A=x.get(r);A?A[1]+=E:x.set(r,[y+this._lineIndexCount,E])}this._lineIndexCount+=E}_getDashArrayKey(e,n,r,i,o,a,l){const c=o?a.getValue(n,e):l,f=i.getValue(n,e);return r.getDashKey(f,c)}}const F=u=>(e,n,r,i,o,a,l,c,f,y,E)=>(u._lineVertexBuffer.add(e,n,l,c,r,i,o,a,f,y,E,u._ddValues),u._lineVertexBuffer.index-1),k=u=>(e,n,r)=>{u._lineIndexBuffer.add(e,n,r)};var Mt,at=W(6879),yt=W(62208),gt=W(77275),it=W(77928);function K(u,e){return u.iconMosaicItem&&e.iconMosaicItem?u.iconMosaicItem.page===e.iconMosaicItem.page?0:u.iconMosaicItem.page-e.iconMosaicItem.page:u.iconMosaicItem&&!e.iconMosaicItem?1:!u.iconMosaicItem&&e.iconMosaicItem?-1:0}class Et extends Ht{constructor(e,n,r,i,o,a,l,c){super(e,n,c.getSpriteItems()),this.type=ut.al.SYMBOL,this._markerMap=new Map,this._glyphMap=new Map,this._glyphBufferDataStorage=new Map,this._isIconSDF=!1,this._iconVertexBuffer=r,this._iconIndexBuffer=i,this._textVertexBuffer=o,this._textIndexBuffer=a,this._placementEngine=l,this._workerTileHandler=c}get markerPageMap(){return this._markerMap}get glyphsPageMap(){return this._glyphMap}get symbolInstances(){return this._symbolInstances}getResources(e,n,r){const i=this.layer,o=this.zoom;e&&e.setExtent(this.layerExtent);const a=i.getLayoutProperty("icon-image"),l=i.getLayoutProperty("text-field");let c=i.getLayoutProperty("text-transform"),f=i.getLayoutProperty("text-font");const y=[];let E,x,A,I;a&&!a.isDataDriven&&(E=a.getValue(o)),l&&!l.isDataDriven&&(x=l.getValue(o)),c&&c.isDataDriven||(A=i.getLayoutValue("text-transform",o),c=null),f&&f.isDataDriven||(I=i.getLayoutValue("text-font",o),f=null);for(const p of this._features){const D=p.getGeometry(e);if(!D||0===D.length)continue;let g,S;a&&(g=a.isDataDriven?a.getValue(o,p):this._replaceKeys(E,p.values),g&&n(g));let N=!1;if(l&&(S=l.isDataDriven?l.getValue(o,p):this._replaceKeys(x,p.values),S)){switch(S=S.replaceAll("\\n","\n"),c&&(A=c.getValue(o,p)),A){case M._5.LOWERCASE:S=S.toLowerCase();break;case M._5.UPPERCASE:S=S.toUpperCase()}if(Et._bidiEngine.hasBidiChar(S)){let C;C="rtl"===Et._bidiEngine.checkContextual(S)?"IDNNN":"ICNNN",S=Et._bidiEngine.bidiTransform(S,C,"VLYSN"),N=!0}if(S.length>0){f&&(I=f.getValue(o,p));for(const C of I){let B=r[C];B||(B=r[C]=new Set);for(const V of S){const v=V.codePointAt(0);null!=v&&B.add(v)}}}}if(!g&&!S)continue;const P=i.getLayoutValue("symbol-sort-key",o,p),U={feature:p,sprite:g,label:S,rtl:N,geometry:D,hash:(S?(0,gt.hP)(S):0)^(g?(0,gt.hP)(g):0),priority:P,textFont:I};y.push(U)}this._symbolFeatures=y}processFeatures(e){e&&e.setExtent(this.layerExtent);const n=this.layer,r=this.zoom,i=n.getLayoutValue("symbol-placement",r),o=i!==M.R.POINT,a=8*n.getLayoutValue("symbol-spacing",r),l=n.getLayoutProperty("icon-image"),c=n.getLayoutProperty("text-field"),f=l?new it._L(n,r,o):null,y=c?new it.nj(n,r,o):null,E=this._workerTileHandler;let x;l&&(x=E.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();const A=[];let I=1;y&&y.size&&(I=y.size/24);const p=y?y.maxAngle*w.nF:0,D=y?8*y.size:0;for(const g of this._symbolFeatures){let S,N;f&&x&&g.sprite&&(S=x[g.sprite],S&&S.sdf&&(this._isIconSDF=!0)),S&&f.update(r,g.feature);let P=0;const U=g.label;if(U){(0,yt.O3)(y),y.update(r,g.feature);const C=o&&y.rotationAlignment===M.aF.MAP?y.keepUpright:y.writingMode&&y.writingMode.includes(M.r1.VERTICAL);let B=.5;switch(y.anchor){case M.nR.TOP_LEFT:case M.nR.LEFT:case M.nR.BOTTOM_LEFT:B=0;break;case M.nR.TOP_RIGHT:case M.nR.RIGHT:case M.nR.BOTTOM_RIGHT:B=1}let V=.5;switch(y.anchor){case M.nR.TOP_LEFT:case M.nR.TOP:case M.nR.TOP_RIGHT:V=0;break;case M.nR.BOTTOM_LEFT:case M.nR.BOTTOM:case M.nR.BOTTOM_RIGHT:V=1}let v=.5;switch(y.justify){case M.vL.AUTO:v=B;break;case M.vL.LEFT:v=0;break;case M.vL.RIGHT:v=1}const Y=24*y.letterSpacing,J=o?0:24*y.maxWidth,G=24*y.lineHeight,lt=g.textFont.map(st=>E.getGlyphItems(st));if(N=new Ot(lt,J,G,Y,B,V,v).getShaping(U,g.rtl,C),N&&N.length>0){let st=1e30,rt=-1e30;for(const Bt of N)st=Math.min(st,Bt.x),rt=Math.max(rt,Bt.x);P=(rt-st+48)*I*8}}for(let C of g.geometry){const B=[];if(i===M.R.LINE){if(N?.length&&y?.size){const V=8*y.size*(2+Math.min(2,4*Math.abs(y.offset[1])));C=Et._smoothVertices(C,V)}Et._pushAnchors(B,C,a,P)}else i===M.R.LINE_CENTER?Et._pushCenterAnchor(B,C):g.feature.type===b.Vl.Polygon?Et._pushCentroid(B,C):B.push(new Gt(C[0].x,C[0].y));for(const V of B){if(V.x<0||V.x>4096||V.y<0||V.y>4096||o&&P>0&&y?.rotationAlignment===M.aF.MAP&&!Et._honorsTextMaxAngle(C,V,P,p,D))continue;const v={shaping:N,line:C,iconMosaicItem:S,anchor:V,symbolFeature:g,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};A.push(v),this._processFeature(v,f,y)}}}A.sort(K),this._addPlacedGlyphs(),this._symbolInstances=A}serialize(){let e=11;e+=this.layerUIDs.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=Et._symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;const n=new Uint32Array(e),r=new Int32Array(n.buffer),i=new Float32Array(n.buffer);let o=0;n[o++]=this.type,n[o++]=this.layerUIDs.length;for(let a=0;a<this.layerUIDs.length;a++)n[o++]=this.layerUIDs[a];n[o++]=this._isIconSDF?1:0,n[o++]=this.markerPageMap.size;for(const[a,[l,c]]of this.markerPageMap)n[o++]=a,n[o++]=l,n[o++]=c;n[o++]=this.glyphsPageMap.size;for(const[a,[l,c]]of this.glyphsPageMap)n[o++]=a,n[o++]=l,n[o++]=c;n[o++]=this._iconVertexBuffer.index/4,n[o++]=this._textVertexBuffer.index/4,o=Et.serializeSymbols(n,r,i,o,this._symbolInstances),n[o++]=this._iconVertexBuffer.array.length;for(let a=0;a<this._iconVertexBuffer.array.length;a++)r[o++]=this._iconVertexBuffer.array[a];n[o++]=this._iconIndexBuffer.array.length;for(let a=0;a<this._iconIndexBuffer.array.length;a++)n[o++]=this._iconIndexBuffer.array[a];n[o++]=this._textVertexBuffer.array.length;for(let a=0;a<this._textVertexBuffer.array.length;a++)r[o++]=this._textVertexBuffer.array[a];n[o++]=this._textIndexBuffer.array.length;for(let a=0;a<this._textIndexBuffer.array.length;a++)n[o++]=this._textIndexBuffer.array[a];return n.buffer}static _symbolsSerializationLength(e){let n=0;n+=1;for(const r of e||[]){n+=4,n+=1;for(const i of r.textColliders)n+=10;for(const i of r.iconColliders)n+=10;n+=1,n+=2*r.textVertexRanges.length,n+=1,n+=2*r.iconVertexRanges.length}return n}static serializeSymbols(e,n,r,i,o){n[i++]=(o=o||[]).length;for(const a of o){n[i++]=a.anchor.x,n[i++]=a.anchor.y,n[i++]=a.symbolFeature.hash,n[i++]=a.symbolFeature.priority,n[i++]=a.textColliders.length+a.iconColliders.length;for(const l of a.textColliders)n[i++]=l.xTile,n[i++]=l.yTile,n[i++]=l.dxPixels,n[i++]=l.dyPixels,n[i++]=l.hard?1:0,n[i++]=l.partIndex,r[i++]=l.minLod,r[i++]=l.maxLod,n[i++]=l.width,n[i++]=l.height;for(const l of a.iconColliders)n[i++]=l.xTile,n[i++]=l.yTile,n[i++]=l.dxPixels,n[i++]=l.dyPixels,n[i++]=l.hard?1:0,n[i++]=l.partIndex,r[i++]=l.minLod,r[i++]=l.maxLod,n[i++]=l.width,n[i++]=l.height;n[i++]=a.textVertexRanges.length;for(const[l,c]of a.textVertexRanges)n[i++]=l,n[i++]=c;n[i++]=a.iconVertexRanges.length;for(const[l,c]of a.iconVertexRanges)n[i++]=l,n[i++]=c}return i}_replaceKeys(e,n){return e.replaceAll(/{([^{}]+)}/g,(r,i)=>i in n?n[i]:"")}_processFeature(e,n,r){const{line:i,iconMosaicItem:o,shaping:a,anchor:l}=e,c=this.zoom,f=this.layer,y=!!o;let E=!0;y&&(E=n?.optional||!o);const x=a&&a.length>0,A=!x||r?.optional;let I,p;if(y&&(I=this._placementEngine.getIconPlacement(l,o,n)),(I||E)&&(x&&(p=this._placementEngine.getTextPlacement(l,a,i,r)),p||A)){if(I&&p||(A||E?A||p?E||I||(p=null):I=null:(I=null,p=null)),p){const D=f.hasDataDrivenText?f.textMaterial.encodeAttributes(e.symbolFeature.feature,c,f):null;if(this._storePlacedGlyphs(e,p.shapes,c,r.rotationAlignment,D),p.textColliders){e.textColliders=p.textColliders;for(const g of p.textColliders){g.minLod=Math.max(c+(0,w.k3)(g.minLod),0),g.maxLod=Math.min(c+(0,w.k3)(g.maxLod),25);const S=g.angle;if(S){const N=Math.cos(S),P=Math.sin(S),U=g.dxPixels*N-g.dyPixels*P,C=g.dxPixels*P+g.dyPixels*N,B=(g.dxPixels+g.width)*N-g.dyPixels*P,V=(g.dxPixels+g.width)*P+g.dyPixels*N,v=g.dxPixels*N-(g.dyPixels+g.height)*P,Y=g.dxPixels*P+(g.dyPixels+g.height)*N,J=(g.dxPixels+g.width)*N-(g.dyPixels+g.height)*P,G=(g.dxPixels+g.width)*P+(g.dyPixels+g.height)*N,lt=Math.min(U,B,v,J),st=Math.max(U,B,v,J),rt=Math.min(C,V,Y,G),Bt=Math.max(C,V,Y,G);g.dxPixels=lt,g.dyPixels=rt,g.width=st-lt,g.height=Bt-rt}}}}if(I){const D=f.hasDataDrivenIcon?f.iconMaterial.encodeAttributes(e.symbolFeature.feature,c,f):null;if(this._addPlacedIcons(e,I.shapes,c,o.page,n.rotationAlignment===M.aF.VIEWPORT,D),I.iconColliders){e.iconColliders=I.iconColliders;for(const g of I.iconColliders){g.minLod=Math.max(c+(0,w.k3)(g.minLod),0),g.maxLod=Math.min(c+(0,w.k3)(g.maxLod),25);const S=g.angle;if(S){const N=Math.cos(S),P=Math.sin(S),U=g.dxPixels*N-g.dyPixels*P,C=g.dxPixels*P+g.dyPixels*N,B=(g.dxPixels+g.width)*N-g.dyPixels*P,V=(g.dxPixels+g.width)*P+g.dyPixels*N,v=g.dxPixels*N-(g.dyPixels+g.height)*P,Y=g.dxPixels*P+(g.dyPixels+g.height)*N,J=(g.dxPixels+g.width)*N-(g.dyPixels+g.height)*P,G=(g.dxPixels+g.width)*P+(g.dyPixels+g.height)*N,lt=Math.min(U,B,v,J),st=Math.max(U,B,v,J),rt=Math.min(C,V,Y,G),Bt=Math.max(C,V,Y,G);g.dxPixels=lt,g.dyPixels=rt,g.width=st-lt,g.height=Bt-rt}}}}}}_addPlacedIcons(e,n,r,i,o,a){const l=Math.max(r-1,0),c=this._iconVertexBuffer,f=this._iconIndexBuffer,y=this._markerMap;for(const E of n){const x=o?0:Math.max(r+(0,w.k3)(E.minzoom),l),A=o?25:Math.min(r+(0,w.k3)(E.maxzoom),25);if(A<=x)continue;const I=E.tl,p=E.tr,D=E.bl,g=E.br,S=E.mosaicRect,N=E.labelAngle,P=E.minAngle,U=E.maxAngle,C=E.anchor,B=c.index,V=S.x,v=S.y,Y=V+S.width,J=v+S.height,G=c.index;c.add(C.x,C.y,I.x,I.y,V,v,N,P,U,x,A,a),c.add(C.x,C.y,p.x,p.y,Y,v,N,P,U,x,A,a),c.add(C.x,C.y,D.x,D.y,V,J,N,P,U,x,A,a),c.add(C.x,C.y,g.x,g.y,Y,J,N,P,U,x,A,a),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===G?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([G,4]),f.add(B,B+1,B+2),f.add(B+1,B+2,B+3),y.has(i)?y.get(i)[1]+=6:y.set(i,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}_addPlacedGlyphs(){const e=this._textVertexBuffer,n=this._textIndexBuffer,r=this._glyphMap;for(const[i,o]of this._glyphBufferDataStorage)for(const a of o){const l=e.index,c=a.symbolInstance,f=a.ddAttributes,y=e.index;e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tl[0],a.tl[1],a.xmin,a.ymin,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,f),e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tr[0],a.tr[1],a.xmax,a.ymin,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,f),e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.bl[0],a.bl[1],a.xmin,a.ymax,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,f),e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.br[0],a.br[1],a.xmax,a.ymax,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,f),c.textVertexRanges.length>0&&c.textVertexRanges[0][0]+c.textVertexRanges[0][1]===y?c.textVertexRanges[0][1]+=4:c.textVertexRanges.push([y,4]),n.add(l,l+1,l+2),n.add(l+1,l+2,l+3),r.has(i)?r.get(i)[1]+=6:r.set(i,[this._textIndexStart+this._textIndexCount,6]),this._textIndexCount+=6}this._glyphBufferDataStorage.clear()}_storePlacedGlyphs(e,n,r,i,o){const a=Math.max(r-1,0),l=i===M.aF.VIEWPORT;let c,f,y,E,x,A,I,p,D,g,S;for(const N of n)c=l?0:Math.max(r+(0,w.k3)(N.minzoom),a),f=l?25:Math.min(r+(0,w.k3)(N.maxzoom),25),!(f<=c)&&(y=N.tl,E=N.tr,x=N.bl,A=N.br,I=N.labelAngle,p=N.minAngle,D=N.maxAngle,g=N.anchor,S=N.mosaicRect,this._glyphBufferDataStorage.has(N.page)||this._glyphBufferDataStorage.set(N.page,[]),this._glyphBufferDataStorage.get(N.page).push({glyphAnchor:[g.x,g.y],tl:[y.x,y.y],tr:[E.x,E.y],bl:[x.x,x.y],br:[A.x,A.y],xmin:S.x,ymin:S.y,xmax:S.x+S.width,ymax:S.y+S.height,labelAngle:I,minAngle:p,maxAngle:D,minLod:c,maxLod:f,placementLod:a,symbolInstance:e,ddAttributes:o}))}static _pushAnchors(e,n,r,i){r+=i;let o=0;const a=n.length-1;for(let x=0;x<a;x++)o+=b.E9.distance(n[x],n[x+1]);let l=i||r;if(l*=.5,o<=l)return;const c=l/o;let f=0,y=-(r=o/Math.max(Math.round(o/r),1))/2;const E=n.length-1;for(let x=0;x<E;x++){const A=n[x],I=n[x+1],p=I.x-A.x,D=I.y-A.y,g=Math.sqrt(p*p+D*D);let S;for(;y+r<f+g;){y+=r;const N=(y-f)/g,P=(0,w.sX)(A.x,I.x,N),U=(0,w.sX)(A.y,I.y,N);void 0===S&&(S=Math.atan2(D,p)),e.push(new Gt(P,U,S,x,c))}f+=g}}static _pushCenterAnchor(e,n){let r=0;const i=n.length-1;for(let c=0;c<i;c++)r+=b.E9.distance(n[c],n[c+1]);const o=r/2;let a=0;const l=n.length-1;for(let c=0;c<l;c++){const f=n[c],y=n[c+1],E=y.x-f.x,x=y.y-f.y,A=Math.sqrt(E*E+x*x);if(o<a+A){const I=(o-a)/A,p=(0,w.sX)(f.x,y.x,I),D=(0,w.sX)(f.y,y.y,I),g=Math.atan2(x,E);return void e.push(new Gt(p,D,g,c,0))}a+=A}}static _deviation(e,n,r){return Math.atan2((n.x-e.x)*(r.y-n.y)-(n.y-e.y)*(r.x-n.x),(n.x-e.x)*(r.x-n.x)+(n.y-e.y)*(r.y-n.y))}static _honorsTextMaxAngle(e,n,r,i,o){let a=0;const l=r/2;let c=new b.E9(n.x,n.y),f=n.segment+1;for(;a>-l;){if(--f,f<0)return!1;a-=b.E9.distance(e[f],c),c=e[f]}a+=b.E9.distance(e[f],e[f+1]);const y=[];let E=0;const x=e.length;for(;a<l;){const A=e[f];let I,p=f;do{if(++p,p===x)return!1;I=e[p]}while(I.isEqual(A));let D,g=p;do{if(++g,g===x)return!1;D=e[g]}while(D.isEqual(I));const S=this._deviation(A,I,D);for(y.push({deviation:S,distToAnchor:a}),E+=S;a-y[0].distToAnchor>o;)E-=y.shift().deviation;if(Math.abs(E)>i)return!1;a+=b.E9.distance(I,D),f=p}return!0}static _smoothVertices(e,n){if(n<=0)return e;let r=e.length;if(r<3)return e;const i=[];let o=0,a=0;i.push(0);for(let p=1;p<r;p++){const D=b.E9.distance(e[p],e[p-1]);D>0&&(o+=D,i.push(o),a++,a!==p&&(e[a]=e[p]))}if(r=a+1,r<3)return e;n=Math.min(n,.2*o);const l=e[0].x,c=e[0].y,f=e[r-1].x,y=e[r-1].y,E=b.E9.sub(e[0],e[1]);E.normalize(),e[0].x+=n*E.x,e[0].y+=n*E.y,E.assignSub(e[r-1],e[r-2]),E.normalize(),e[r-1].x+=n*E.x,e[r-1].y+=n*E.y,i[0]-=n,i[r-1]+=n;const x=[];x.push(new b.E9(l,c));const A=1e-6,I=.5*n;for(let p=1;p<r-1;p++){let D=0,g=0,S=0;for(let N=p-1;N>=0;N--){const P=I+i[N+1]-i[p];if(P<0)break;const U=i[N+1]-i[N],C=i[p]-i[N]<I?1:P/U;if(C<A)break;const B=C*C,V=C*P-.5*B*U,v=C*U/n,Y=e[N+1],J=e[N].x-Y.x,G=e[N].y-Y.y;D+=v/V*(Y.x*C*P+.5*B*(P*J-U*Y.x)-B*C*U*J/3),g+=v/V*(Y.y*C*P+.5*B*(P*G-U*Y.y)-B*C*U*G/3),S+=v}for(let N=p+1;N<r;N++){const P=I-i[N-1]+i[p];if(P<0)break;const U=i[N]-i[N-1],C=i[N]-i[p]<I?1:P/U;if(C<A)break;const B=C*C,V=C*P-.5*B*U,v=C*U/n,Y=e[N-1],J=e[N].x-Y.x,G=e[N].y-Y.y;D+=v/V*(Y.x*C*P+.5*B*(P*J-U*Y.x)-B*C*U*J/3),g+=v/V*(Y.y*C*P+.5*B*(P*G-U*Y.y)-B*C*U*G/3),S+=v}x.push(new b.E9(D/S,g/S))}return x.push(new b.E9(f,y)),e[0].x=l,e[0].y=c,e[r-1].x=f,e[r-1].y=y,x}static _pushCentroid(e,n){const l=n.length-1;let c=0,f=0,y=0,E=n[0].x,x=n[0].y;E>4096&&(E=4096),E<0&&(E=0),x>4096&&(x=4096),x<0&&(x=0);for(let A=1;A<l;A++){let I=n[A].x,p=n[A].y,D=n[A+1].x,g=n[A+1].y;I>4096&&(I=4096),I<0&&(I=0),p>4096&&(p=4096),p<0&&(p=0),D>4096&&(D=4096),D<0&&(D=0),g>4096&&(g=4096),g<0&&(g=0);const S=(I-E)*(g-x)-(D-E)*(p-x);c+=S*(E+I+D),f+=S*(x+p+g),y+=S}c/=3*y,f/=3*y,isNaN(c)||isNaN(f)||e.push(new Gt(c,f))}}Et._bidiEngine=new at.Z,function(u){u[u.INITIALIZED=0]="INITIALIZED",u[u.NO_DATA=1]="NO_DATA",u[u.READY=2]="READY",u[u.MODIFIED=3]="MODIFIED",u[u.INVALID=4]="INVALID"}(Mt||(Mt={}));class Wt{constructor(e,n,r,i,o){if(this._pbfTiles={},this._tileClippers={},this._client=r,this._tile=n,o){this._styleLayerUIDs=new Set;for(const y of o)this._styleLayerUIDs.add(y)}this._styleRepository=i,this._layers=this._styleRepository?.layers??[];const[a,l,c]=n.tileKey.split("/").map(parseFloat);this._level=a;const f=8+Math.max(16*(this._level-14),0);for(const y of Object.keys(e)){const E=e[y];if(this._pbfTiles[y]=new It.Z(new Uint8Array(E.protobuff),new DataView(E.protobuff)),E.refKey){const[x]=E.refKey.split("/").map(parseFloat),A=a-x;if(A>0){const I=(1<<A)-1;this._tileClippers[y]=new b.bN(A,l&I,c&I,8,f)}}this._tileClippers[y]||(this._tileClippers[y]=new b.I6)}}_canParseStyleLayer(e){return!this._styleLayerUIDs||this._styleLayerUIDs.has(e)}parse(e){var n=this;return(0,Q.Z)(function*(){const r=(0,Z.j)(),i=n._initialize(e),{returnedBuckets:o}=i;n._processLayers(i),n._linkReferences(i),n._filterFeatures(i);const a=[],l=new Set,c=(E,x)=>{l.has(E)||(a.push({name:E,repeat:x}),l.add(E))},f={};for(const E of o)E.getResources(E.tileClipper,c,f);if(n._tile.status===Mt.INVALID)return[];const y=n._fetchResources(a,f,e);return Promise.all([...y,r]).then(()=>n._processFeatures(i.returnedBuckets))})()}_initialize(e){return{signal:e?.signal,sourceNameToTileData:this._parseTileData(this._pbfTiles),layers:this._layers,zoom:this._level,sourceNameToTileClipper:this._tileClippers,sourceNameToUniqueSourceLayerBuckets:{},sourceNameToUniqueSourceLayers:{},returnedBuckets:[],layerIdToBucket:{},referencerUIDToReferencedId:new Map}}_processLayers(e){const{sourceNameToTileData:n,layers:r,zoom:i,sourceNameToTileClipper:o,sourceNameToUniqueSourceLayerBuckets:a,sourceNameToUniqueSourceLayers:l,returnedBuckets:c,layerIdToBucket:f,referencerUIDToReferencedId:y}=e;for(let E=r.length-1;E>=0;E--){const x=r[E];if(!this._canParseStyleLayer(x.uid)||x.minzoom&&i<Math.floor(x.minzoom)||x.maxzoom&&i>=x.maxzoom||x.type===M.fR.BACKGROUND||!n[x.source]||!o[x.source])continue;const I=o[x.source],p=x.sourceLayer,D=n[x.source][p];if(D){let g=l[x.source];if(g||(g=l[x.source]=new Set),g.add(x.sourceLayer),x.refLayerId)y.set(x.uid,x.refLayerId);else{const S=this._createBucket(x);if(S){S.layerUIDs=[x.uid],S.layerExtent=D.extent,S.tileClipper=I;let N=a[x.source];N||(N=a[x.source]={});let P=N[p];P||(P=N[p]=[]),P.push(S),c.push(S),f[x.id]=S}}}}}_linkReferences(e){const{layerIdToBucket:n,referencerUIDToReferencedId:r}=e;r.forEach((i,o)=>{n[i]&&n[i].layerUIDs.push(o)})}_filterFeatures(e){const{signal:n,sourceNameToTileData:r,sourceNameToUniqueSourceLayerBuckets:i,sourceNameToUniqueSourceLayers:o}=e,a=10*this._level,l=10*(this._level+1),c=[],f=[];for(const y of Object.keys(o))o[y].forEach(E=>{c.push(E),f.push(y)});for(let y=0;y<c.length;y++){const E=f[y],x=c[y];if(!r[E]||!i[E])continue;const A=r[E][x],I=i[E][x];if(!I||0===I.length)continue;if((0,Ut.Hc)(n))return;const p=A.getData();for(;p.nextTag(2);){const D=p.getMessage(),g=new et(D,A);D.release();const S=g.values;if(S){const N=S._minzoom;if(N&&N>=l)continue;const P=S._maxzoom;if(P&&P<=a)continue}for(const N of I)N.pushFeature(g)}}}_fetchResources(e,n,r){const i=[],o=this._tile.getWorkerTileHandler();let a,l;e.length>0&&(a=o.fetchSprites(e,this._client,r),i.push(a));for(const c in n){const f=n[c];f.size>0&&(l=o.fetchGlyphs(this._tile.tileKey,c,f,this._client,r),i.push(l))}return i}_processFeatures(e){const n=e.filter(r=>r.hasFeatures()||this._canParseStyleLayer(r.layer.uid));for(const r of n)r.processFeatures(r.tileClipper);return n}_parseTileData(e){const n={};for(const r of Object.keys(e)){const i=e[r],o={};for(;i.next();)switch(i.tag()){case 3:{const a=i.getMessage(),l=new t(a);a.release(),o[l.name]=l;break}default:i.skip()}n[r]=o}return n}_createBucket(e){switch(e.type){case M.fR.BACKGROUND:return null;case M.fR.FILL:return this._createFillBucket(e);case M.fR.LINE:return this._createLineBucket(e);case M.fR.CIRCLE:return this._createCircleBucket(e);case M.fR.SYMBOL:return this._createSymbolBucket(e)}}_createFillBucket(e){return new R(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new bt(e.fillMaterial.getStride()),new ft,new q(e.outlineMaterial.getStride()),new ft)}_createLineBucket(e){return new O(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new Xt(e.lineMaterial.getStride()),new ft)}_createCircleBucket(e){return new h(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new ot(e.circleMaterial.getStride()),new ft)}_createSymbolBucket(e){const n=this._tile;return new Et(e,this._level,new nt(e.iconMaterial.getStride()),new ft,new nt(e.textMaterial.getStride()),new ft,n.placementEngine,n.getWorkerTileHandler())}}class kt{constructor(e,n,r,i){this.status=Mt.INITIALIZED,this.placementEngine=new mt,this.tileKey=e,this.refKeys=n,this._workerTileHandler=r,this._styleRepository=i}release(){this.tileKey="",this.refKeys=null,this.status=Mt.INITIALIZED,this._workerTileHandler=null}parse(e,n){var r=this;return(0,Q.Z)(function*(){const i=n?.signal;if(null!=i){const E=()=>{i.removeEventListener("abort",E),r.status=Mt.INVALID};i.addEventListener("abort",E)}let o;const a={bucketsWithData:[],emptyBuckets:null};try{o=yield r._parse(e,n)}catch(E){if((0,Ut.D_)(E))throw E;return{result:a,transferList:[]}}r.status=Mt.READY;const l=a.bucketsWithData,c=[];for(const E of o)if(E.hasFeatures()){const x=E.serialize();l.push(x)}else c.push(E.layer.uid);const f=[...l];let y=null;return c.length>0&&(y=Uint32Array.from(c),f.push(y.buffer)),a.emptyBuckets=y,{result:a,transferList:f}})()}setObsolete(){this.status=Mt.INVALID}getLayers(){return this._workerTileHandler.getLayers()}getWorkerTileHandler(){return this._workerTileHandler}_parse(e,n){var r=this;return(0,Q.Z)(function*(){const i=e.sourceName2DataAndRefKey;return 0===Object.keys(i).length?[]:(r.status=Mt.MODIFIED,new Wt(i,r,n.client,r._styleRepository,e.styleLayerUIDs).parse(n))})()}}var zt=W(78364);class ie{constructor(){this._spriteInfo={},this._glyphInfo={}}reset(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}getLayers(){return this._styleRepository?.layers??[]}createTileAndParse(e,n){var r=this;return(0,Q.Z)(function*(){const{key:i}=e,o={};for(const l of Object.keys(e.sourceName2DataAndRefKey))o[l]=e.sourceName2DataAndRefKey[l].refKey;const a=new kt(i,o,r,r._styleRepository);try{return yield a.parse(e,n)}catch(l){if(a.setObsolete(),a.release(),!(0,Ut.D_)(l))throw l;return null}})()}updateStyle(e){if(!e||0===e.length||!this._styleRepository)return;const n=this._styleRepository;for(const r of e){const o=r.data;switch(r.type){case ut.Fr.PAINTER_CHANGED:n.setPaintProperties(o.layer,o.paint);break;case ut.Fr.LAYOUT_CHANGED:n.setLayoutProperties(o.layer,o.layout);break;case ut.Fr.LAYER_REMOVED:n.deleteStyleLayer(o.layer);break;case ut.Fr.LAYER_CHANGED:n.setStyleLayer(o.layer,o.index);break;case ut.Fr.SPRITES_CHANGED:this._spriteInfo={}}}}setStyle(e){this._styleRepository=new zt.Z(e),this._spriteInfo={},this._glyphInfo={}}fetchSprites(e,n,r){const i=[],o=this._spriteInfo;for(const a of e)void 0===o[a.name]&&i.push(a);return 0===i.length?Promise.resolve():n.invoke("getSprites",i,{signal:r?.signal}).then(a=>{for(const l in a)o[l]=a[l]})}getSpriteItems(){return this._spriteInfo}fetchGlyphs(e,n,r,i,o){const a=[];let l=this._glyphInfo[n];return l?r.forEach(c=>{l[c]||a.push(c)}):(l=this._glyphInfo[n]=[],r.forEach(c=>a.push(c))),0===a.length?Promise.resolve():i.invoke("getGlyphs",{tileID:e,font:n,codePoints:a},o).then(c=>{for(let f=0;f<c.length;f++)c[f]&&(l[f]=c[f])})}getGlyphItems(e){return this._glyphInfo[e]}}},47132:(se,Yt,W)=>{W.d(Yt,{JM:()=>ut,R8:()=>Q,cn:()=>Ut,v7:()=>b});const Q=!0,Ut=32,ut=1.5,b=200},46519:(se,Yt,W)=>{W.d(Yt,{z:()=>Ot});var Q=W(7547),Ut=W(39351);function ut(H,M){return H.x===M.x&&H.y===M.y}function w(H,M){return H.x=M.y,H.y=-M.x,H}function xt(H,M){return H.x=-M.y,H.y=M.x,H}function wt(H,M){return H.x=M.x,H.y=M.y,H}function vt(H,M){return H.x=-M.x,H.y=-M.y,H}function Tt(H){return Math.sqrt(H.x*H.x+H.y*H.y)}function Ct(H,M){return H.x*M.y-H.y*M.x}function Rt(H,M){return H.x*M.x+H.y*M.y}function _t(H,M,j,ht){return H.x=M.x*j+M.y*ht,H.y=M.x*ht-M.y*j,H}class Ot{constructor(M,j,ht){this._writeVertex=M,this._writeTriangle=j,this._canUseThinTessellation=ht,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(M,j){(function b(H){if(!H)return;const M=H.length;if(M<=1)return;let j=0;for(let ht=1;ht<M;ht++)ut(H[ht],H[j])||++j===ht||(H[j]=H[ht]);H.length=j+1})(M),this._canUseThinTessellation&&j.halfWidth<Ut.do&&!j.offset?this._tessellateThin(M,j):this._tessellate(M,j)}_tessellateThin(M,j){if(M.length<2)return;const ht=j.wrapDistance||65535;let ct=j.initialDistance||0,dt=!1,Pt=M[0].x,Gt=M[0].y;const At=M.length;for(let Nt=1;Nt<At;++Nt){dt&&(dt=!1,ct=0);let Lt=M[Nt].x,mt=M[Nt].y,It=Lt-Pt,Z=mt-Gt,$=Math.sqrt(It*It+Z*Z);if(It/=$,Z/=$,ct+$>ht){dt=!0;const t=(ht-ct)/$;$=ht-ct,Lt=(1-t)*Pt+t*Lt,mt=(1-t)*Gt+t*mt,--Nt}const et=this._writeVertex(Pt,Gt,0,0,It,Z,Z,-It,0,-1,ct),z=this._writeVertex(Pt,Gt,0,0,It,Z,-Z,It,0,1,ct);ct+=$;const ft=this._writeVertex(Lt,mt,0,0,It,Z,Z,-It,0,-1,ct),L=this._writeVertex(Lt,mt,0,0,It,Z,-Z,It,0,1,ct);this._writeTriangle(et,z,ft),this._writeTriangle(z,ft,L),Pt=Lt,Gt=mt}}_tessellate(M,j){const ct=M[M.length-1],dt=ut(M[0],ct);if(M.length<(dt?3:2))return;const Gt=j.pixelCoordRatio,At=null!=j.capType?j.capType:Q.RL.BUTT,Nt=null!=j.joinType?j.joinType:Q.AH.MITER,Lt=null!=j.miterLimit?Math.min(j.miterLimit,4):2,mt=null!=j.roundLimit?Math.min(j.roundLimit,1.05):1.05,It=null!=j.halfWidth?j.halfWidth:2,Z=!!j.textured;let $,et,z,ft=null;const L=this._prevNormal,t=this._nextNormal;let Xt=-1,bt=-1;const q=this._joinNormal;let nt,ot;const Ht=this._textureNormalLeft,h=this._textureNormalRight,T=this._textureNormal;let d=-1,R=-1;const _=j.wrapDistance||65535;let m=j.initialDistance||0;const O=this._writeVertex,F=this._writeTriangle,k=(yt,gt,it,X,K,Et)=>{const Mt=O(et,z,nt,ot,it,X,yt,gt,K,Et,m);return d>=0&&R>=0&&Mt>=0&&F(d,R,Mt),d=R,R=Mt,Mt};dt&&($=M[M.length-2],t.x=ct.x-$.x,t.y=ct.y-$.y,bt=Tt(t),t.x/=bt,t.y/=bt);let at=!1;for(let yt=0;yt<M.length;++yt){if(at&&(at=!1,m=0),$&&(L.x=-t.x,L.y=-t.y,Xt=bt,m+Xt>_&&(at=!0)),at){const tt=(_-m)/Xt;Xt=_-m,$={x:(1-tt)*$.x+tt*M[yt].x,y:(1-tt)*$.y+tt*M[yt].y},--yt}else $=M[yt];et=$.x,z=$.y;const gt=yt<=0&&!at,it=yt===M.length-1;if(gt||(m+=Xt),ft=it?dt?M[1]:null:M[yt+1],ft?(t.x=ft.x-et,t.y=ft.y-z,bt=Tt(t),t.x/=bt,t.y/=bt):(t.x=void 0,t.y=void 0),!dt){if(gt){xt(q,t),nt=q.x,ot=q.y,At===Q.RL.SQUARE&&(k(-t.y-t.x,t.x-t.y,t.x,t.y,0,-1),k(t.y-t.x,-t.x-t.y,t.x,t.y,0,1)),At===Q.RL.ROUND&&(k(-t.y-t.x,t.x-t.y,t.x,t.y,-1,-1),k(t.y-t.x,-t.x-t.y,t.x,t.y,-1,1)),At!==Q.RL.ROUND&&At!==Q.RL.BUTT||(k(-t.y,t.x,t.x,t.y,0,-1),k(t.y,-t.x,t.x,t.y,0,1));continue}if(it){w(q,L),nt=q.x,ot=q.y,At!==Q.RL.ROUND&&At!==Q.RL.BUTT||(k(L.y,-L.x,-L.x,-L.y,0,-1),k(-L.y,L.x,-L.x,-L.y,0,1)),At===Q.RL.SQUARE&&(k(L.y-L.x,-L.x-L.y,-L.x,-L.y,0,-1),k(-L.y-L.x,L.x-L.y,-L.x,-L.y,0,1)),At===Q.RL.ROUND&&(k(L.y-L.x,-L.x-L.y,-L.x,-L.y,1,-1),k(-L.y-L.x,L.x-L.y,-L.x,-L.y,1,1));continue}}let X,K,Et=-Ct(L,t);if(Math.abs(Et)<.01)Rt(L,t)>0?(q.x=L.x,q.y=L.y,Et=1,X=Number.MAX_VALUE,K=!0):(xt(q,t),Et=1,X=1,K=!1);else{q.x=(L.x+t.x)/Et,q.y=(L.y+t.y)/Et,X=Tt(q);const tt=(X-1)*It*Gt;K=X>4||tt>Xt&&tt>bt}nt=q.x,ot=q.y;let Mt=Nt;switch(Nt){case Q.AH.BEVEL:X<1.05&&(Mt=Q.AH.MITER);break;case Q.AH.ROUND:X<mt&&(Mt=Q.AH.MITER);break;case Q.AH.MITER:X>Lt&&(Mt=Q.AH.BEVEL)}switch(Mt){case Q.AH.MITER:if(k(q.x,q.y,-L.x,-L.y,0,-1),k(-q.x,-q.y,-L.x,-L.y,0,1),it)break;if(Z){const tt=at?0:m;d=this._writeVertex(et,z,nt,ot,t.x,t.y,q.x,q.y,0,-1,tt),R=this._writeVertex(et,z,nt,ot,t.x,t.y,-q.x,-q.y,0,1,tt)}break;case Q.AH.BEVEL:{const tt=Et<0;let St,Dt,Wt,kt;if(tt){const e=d;d=R,R=e,St=Ht,Dt=h}else St=h,Dt=Ht;if(K)Wt=tt?xt(this._innerPrev,L):w(this._innerPrev,L),kt=tt?w(this._innerNext,t):xt(this._innerNext,t);else{const e=tt?vt(this._inner,q):wt(this._inner,q);Wt=e,kt=e}const zt=tt?w(this._bevelStart,L):xt(this._bevelStart,L);k(Wt.x,Wt.y,-L.x,-L.y,St.x,St.y);const ie=k(zt.x,zt.y,-L.x,-L.y,Dt.x,Dt.y);if(it)break;const u=tt?xt(this._bevelEnd,t):w(this._bevelEnd,t);if(K){const e=this._writeVertex(et,z,nt,ot,-L.x,-L.y,0,0,0,0,m);d=this._writeVertex(et,z,nt,ot,t.x,t.y,kt.x,kt.y,St.x,St.y,m),R=this._writeVertex(et,z,nt,ot,t.x,t.y,u.x,u.y,Dt.x,Dt.y,m),this._writeTriangle(ie,e,R)}else{if(Z){const e=this._bevelMiddle;e.x=(zt.x+u.x)/2,e.y=(zt.y+u.y)/2,_t(T,e,-L.x,-L.y),k(e.x,e.y,-L.x,-L.y,T.x,T.y),_t(T,e,t.x,t.y),d=this._writeVertex(et,z,nt,ot,t.x,t.y,e.x,e.y,T.x,T.y,m),R=this._writeVertex(et,z,nt,ot,t.x,t.y,kt.x,kt.y,St.x,St.y,m)}else{const e=d;d=R,R=e}k(u.x,u.y,t.x,t.y,Dt.x,Dt.y)}if(tt){const e=d;d=R,R=e}break}case Q.AH.ROUND:{const tt=Et<0;let St,Dt;if(tt){const p=d;d=R,R=p,St=Ht,Dt=h}else St=h,Dt=Ht;const Wt=tt?vt(this._inner,q):wt(this._inner,q);let kt,zt;K?(kt=tt?xt(this._innerPrev,L):w(this._innerPrev,L),zt=tt?w(this._innerNext,t):xt(this._innerNext,t)):(kt=Wt,zt=Wt);const ie=tt?w(this._roundStart,L):xt(this._roundStart,L),u=tt?xt(this._roundEnd,t):w(this._roundEnd,t),e=k(kt.x,kt.y,-L.x,-L.y,St.x,St.y),n=k(ie.x,ie.y,-L.x,-L.y,Dt.x,Dt.y);if(it)break;const r=this._writeVertex(et,z,nt,ot,-L.x,-L.y,0,0,0,0,m);K||this._writeTriangle(d,R,r);const i=vt(this._outer,Wt),o=this._writeVertex(et,z,nt,ot,t.x,t.y,u.x,u.y,Dt.x,Dt.y,m);let a,l;const c=X>2;if(c){let p;X!==Number.MAX_VALUE?(i.x/=X,i.y/=X,p=Rt(L,i),p=(X*(p*p-1)+1)/p):p=-1,a=tt?w(this._startBreak,L):xt(this._startBreak,L),a.x+=L.x*p,a.y+=L.y*p,l=tt?xt(this._endBreak,t):w(this._endBreak,t),l.x+=t.x*p,l.y+=t.y*p}_t(T,i,-L.x,-L.y);const f=this._writeVertex(et,z,nt,ot,-L.x,-L.y,i.x,i.y,T.x,T.y,m);_t(T,i,t.x,t.y);const y=Z?this._writeVertex(et,z,nt,ot,t.x,t.y,i.x,i.y,T.x,T.y,m):f,E=r,x=Z?this._writeVertex(et,z,nt,ot,t.x,t.y,0,0,0,0,m):r;let A=-1,I=-1;if(c&&(_t(T,a,-L.x,-L.y),A=this._writeVertex(et,z,nt,ot,-L.x,-L.y,a.x,a.y,T.x,T.y,m),_t(T,l,t.x,t.y),I=this._writeVertex(et,z,nt,ot,t.x,t.y,l.x,l.y,T.x,T.y,m)),Z?c?(this._writeTriangle(E,n,A),this._writeTriangle(E,A,f),this._writeTriangle(x,y,I),this._writeTriangle(x,I,o)):(this._writeTriangle(E,n,f),this._writeTriangle(x,y,o)):c?(this._writeTriangle(r,n,A),this._writeTriangle(r,A,I),this._writeTriangle(r,I,o)):(this._writeTriangle(r,n,f),this._writeTriangle(r,y,o)),K?(d=this._writeVertex(et,z,nt,ot,t.x,t.y,zt.x,zt.y,St.x,St.y,m),R=o):(d=Z?this._writeVertex(et,z,nt,ot,t.x,t.y,zt.x,zt.y,St.x,St.y,m):e,this._writeTriangle(d,x,o),R=o),tt){const p=d;d=R,R=p}break}}}}}},67969:(se,Yt,W)=>{var Q,Ut,ut,b,w,xt,wt,vt,Tt,Ct,Rt,_t,Ot,H,M,j,ht,ct,dt,Pt,t;W.d(Yt,{Br:()=>j,Ho:()=>dt,LR:()=>xt,Lu:()=>mt,MX:()=>Ut,No:()=>Ot,Se:()=>Z,Tg:()=>ht,V1:()=>Gt,V7:()=>ft,VI:()=>H,VY:()=>Nt,Wf:()=>wt,Xg:()=>Lt,Y5:()=>z,_g:()=>At,cw:()=>Rt,db:()=>b,e8:()=>_t,g:()=>vt,l1:()=>ct,lP:()=>M,lk:()=>Q,q_:()=>It,qi:()=>Pt,w0:()=>w,wb:()=>Tt,xS:()=>Ct,zi:()=>ut}),(t=Q||(Q={}))[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Ut||(Ut={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(ut||(ut={})),function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(b||(b={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER"}(w||(w={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(xt||(xt={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(wt||(wt={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT"}(vt||(vt={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(Tt||(Tt={})),function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(Ct||(Ct={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(Rt||(Rt={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(_t||(_t={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(Ot||(Ot={})),function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(H||(H={})),function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"}(M||(M={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(j||(j={})),function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(ht||(ht={})),function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(ct||(ct={})),function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(dt||(dt={})),function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(Pt||(Pt={}));const Gt=33984;var At,Nt,Lt;(function(t){t[t.Texture=0]="Texture",t[t.BufferObject=1]="BufferObject",t[t.VertexArrayObject=2]="VertexArrayObject",t[t.Shader=3]="Shader",t[t.Program=4]="Program",t[t.FramebufferObject=5]="FramebufferObject",t[t.Renderbuffer=6]="Renderbuffer",t[t.Sync=7]="Sync",t[t.UNCOUNTED=8]="UNCOUNTED",t[t.LinesOfCode=8]="LinesOfCode",t[t.Uniform=9]="Uniform",t[t.COUNT=10]="COUNT"})(At||(At={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(Nt||(Nt={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"}(Lt||(Lt={}));const mt=33306;var It,Z,$,et,z,ft,L;(function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(It||(It={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(Z||(Z={})),function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"}($||($={})),function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"}(et||(et={})),function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"}(z||(z={})),function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(ft||(ft={})),function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(L||(L={}))}}]);