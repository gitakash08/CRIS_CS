"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[4578],{24578:(z,I,n)=>{n.r(I),n.d(I,{fromUrl:()=>$});var r=n(15861),Z=n(26584),t=n(21726),s=n(38305),E=n(39593),O=n(17196),C=n(72469),G=n(30164),S=n(45205);const x={FeatureLayer:!0,SceneLayer:!0};function $(l){return U.apply(this,arguments)}function U(){return U=(0,r.Z)(function*(l){const o=l.properties?.customParameters,e=yield function F(l,o){return D.apply(this,arguments)}(l.url,o),u={...l.properties,url:l.url};if(e.layers.length+e.tables.length===0)return null!=e.layerId&&(u.layerId=e.layerId),null!=e.sourceJSON&&(u.sourceJSON=e.sourceJSON),new e.Constructor(u);const f=new((yield n.e(5700).then(n.bind(n,55700))).default)({title:e.parsedUrl.title});return yield function B(l,o,e){return W.apply(this,arguments)}(f,e,u),f}),U.apply(this,arguments)}function j(l,o){return l?l.find(e=>e.id===o):null}function W(){return(W=(0,r.Z)(function*(l,o,e){function u(a,c,P,v){const g={...e,layerId:c,sublayerTitleMode:"service-name"};return null!=a&&(g.url=a),null!=P&&(g.sourceJSON=P),v(g)}const f=o.sublayerConstructorProvider;for(const{id:a,serverUrl:c}of o.layers){const P=j(o.sublayerInfos,a),v=(P&&f?.(P))??o.Constructor,g=u(c,a,P,d=>new v(d));l.add(g)}if(o.tables.length){const a=yield L("FeatureLayer");o.tables.forEach(({id:c,serverUrl:P})=>{const v=u(P,c,j(o.tableInfos,c),g=>new a(g));l.tables.add(v)})}})).apply(this,arguments)}function D(){return D=(0,r.Z)(function*(l,o){let e=(0,s.Qc)(l);if(null==e&&(e=yield function K(l,o){return A.apply(this,arguments)}(l,o)),null==e)throw new Z.Z("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:l});const{serverType:u,sublayer:f}=e;let a;const c={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},P="FeatureServer"===u,v="SceneServer"===u,g={parsedUrl:e,Constructor:null,layerId:P||v?f??void 0:void 0,layers:[],tables:[]};switch(u){case"MapServer":a=null!=f?"FeatureLayer":(yield function J(l,o){return N.apply(this,arguments)}(l,o))?"TileLayer":"MapImageLayer";break;case"ImageServer":{const d=yield(0,S.T)(l,{customParameters:o}),{tileInfo:T,cacheType:R}=d;a=T?"LERC"!==T?.format?.toUpperCase()||R&&"elevation"!==R.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const d=yield(0,S.T)(e.url.path,{customParameters:o});if(a="SceneLayer",d){const T=d?.layers;if("Voxel"===d?.layerType)a="VoxelLayer";else if(T?.length){const R=T[0]?.layerType;null!=R&&null!=C.fb[R]&&(a=C.fb[R])}}break}case"FeatureServer":if(a="FeatureLayer",null!=f){const d=yield(0,S.T)(l,{customParameters:o});g.sourceJSON=d,"Oriented Imagery Layer"===d.type&&(a="OrientedImageryLayer")}break;default:a=c[u]}if(x[a]&&null==f){const d=yield function y(l,o,e){return m.apply(this,arguments)}(l,u,o);if(P&&(g.sublayerInfos=d.layerInfos,g.tableInfos=d.tableInfos),d.layers.length+d.tables.length!==1)g.layers=d.layers,g.tables=d.tables,P&&d.layerInfos?.length&&(g.sublayerConstructorProvider=yield function Q(l){return V.apply(this,arguments)}(d.layerInfos));else if(P||v){const T=d.layerInfos?.[0]??d.tableInfos?.[0];g.layerId=d.layers[0]?.id??d.tables[0]?.id,g.sourceJSON=T,P&&"Oriented Imagery Layer"===T?.type&&(a="OrientedImageryLayer")}}return g.Constructor=yield L(a),g}),D.apply(this,arguments)}function A(){return(A=(0,r.Z)(function*(l,o){const e=yield(0,S.T)(l,{customParameters:o});let u=null,f=null;const a=e.type;if("Feature Layer"===a||"Table"===a?(u="FeatureServer",f=e.id??null):"indexedVector"===a?u="VectorTileServer":e.hasOwnProperty("mapName")?u="MapServer":e.hasOwnProperty("bandCount")&&e.hasOwnProperty("pixelSizeX")?u="ImageServer":e.hasOwnProperty("maxRecordCount")&&e.hasOwnProperty("allowGeometryUpdates")?u="FeatureServer":e.hasOwnProperty("streamUrls")?u="StreamServer":p(e)?(u="SceneServer",f=e.id):e.hasOwnProperty("layers")&&p(e.layers?.[0])&&(u="SceneServer"),!u)return null;const c=null!=f?(0,s.DR)(l):null;return{title:null!=c&&e.name||(0,t.vt)(l),serverType:u,sublayer:f,url:{path:null!=c?c.serviceUrl:(0,t.mN)(l).path}}})).apply(this,arguments)}function p(l){return null!=l&&l.hasOwnProperty("store")&&l.hasOwnProperty("id")&&"number"==typeof l.id}function m(){return m=(0,r.Z)(function*(l,o,e){let u,f,a=!1;switch(o){case"FeatureServer":{const v=yield(0,O.V)(l,{customParameters:e});a=!!v.layersJSON,u=v.layersJSON||v.serviceJSON;break}case"SceneServer":{const v=yield function h(l,o){return i.apply(this,arguments)}(l,e);u=v.serviceInfo,f=v.tableServerUrl;break}default:u=yield(0,S.T)(l,{customParameters:e})}const c=u?.layers,P=u?.tables;return{layers:c?.map(v=>({id:v.id})).reverse()||[],tables:P?.map(v=>({serverUrl:f,id:v.id})).reverse()||[],layerInfos:a?c:[],tableInfos:a?P:[]}}),m.apply(this,arguments)}function i(){return(i=(0,r.Z)(function*(l,o){const e=yield(0,S.T)(l,{customParameters:o});if(!e.layers?.[0])return{serviceInfo:e};try{const{serverUrl:f}=yield(0,E.w)(l),a=yield(0,S.T)(f,{customParameters:o}).catch(()=>null);return a&&(e.tables=a.tables),{serviceInfo:e,tableServerUrl:f}}catch{return{serviceInfo:e}}})).apply(this,arguments)}function L(l){return M.apply(this,arguments)}function M(){return(M=(0,r.Z)(function*(l){return(0,G.T[l])()})).apply(this,arguments)}function N(){return(N=(0,r.Z)(function*(l,o){return(yield(0,S.T)(l,{customParameters:o})).tileInfo})).apply(this,arguments)}function V(){return(V=(0,r.Z)(function*(l){const o=[],e=[];if(l.forEach(a=>{const{type:c}=a;"Oriented Imagery Layer"===c?(o.push(c),e.push(L("OrientedImageryLayer"))):(o.push(c),e.push(L("FeatureLayer")))}),!e.length)return;const u=yield Promise.all(e),f=new Map;return o.forEach((a,c)=>{f.set(a,u[c])}),a=>f.get(a.type)})).apply(this,arguments)}},39593:(z,I,n)=>{n.d(I,{w:()=>S});var r=n(15861),Z=n(24263),t=n(84792),s=n(26584),E=n(10699),O=n(38305),C=n(31099),G=n(55463);function S(y,m){return x.apply(this,arguments)}function x(){return x=(0,r.Z)(function*(y,m){const h=(0,O.Qc)(y);if(!h)throw new s.Z("invalid-url","Invalid scene service url");const i={...m,sceneServerUrl:h.url.path,layerId:h.sublayer??void 0};if(i.sceneLayerItem??=(yield function $(y){return U.apply(this,arguments)}(i)),null==i.sceneLayerItem)return D(i.sceneServerUrl.replace("/SceneServer","/FeatureServer"),i);const L=yield function A(y){return p.apply(this,arguments)}(i);if(!L?.url)throw new s.Z("related-service-not-found","Could not find feature service through portal item relationship");const M=yield D(L.url,i);return M.portalItem=L,M}),x.apply(this,arguments)}function U(){return U=(0,r.Z)(function*(y){const m=(yield j(y)).serviceItemId;if(!m)return null;const h=new G.default({id:m,apiKey:y.apiKey}),i=yield function W(y){return F.apply(this,arguments)}(y);null!=i&&(h.portal=new C.Z({url:i}));try{return h.load({signal:y.signal})}catch(L){return(0,E.r9)(L),null}}),U.apply(this,arguments)}function j(y){return B.apply(this,arguments)}function B(){return(B=(0,r.Z)(function*(y){if(y.rootDocument)return y.rootDocument;const m={query:{f:"json",token:y.apiKey},responseType:"json",signal:y.signal};try{const h=yield(0,t.Z)(y.sceneServerUrl,m);y.rootDocument=h.data}catch{y.rootDocument={}}return y.rootDocument})).apply(this,arguments)}function F(){return(F=(0,r.Z)(function*(y){const m=Z.id?.findServerInfo(y.sceneServerUrl);if(m?.owningSystemUrl)return m.owningSystemUrl;const h=y.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const i=(yield(0,t.Z)(h,{query:{f:"json"},responseType:"json",signal:y.signal})).data.owningSystemUrl;if(i)return i}catch(i){(0,E.r9)(i)}return null})).apply(this,arguments)}function D(y,m){return K.apply(this,arguments)}function K(){return(K=(0,r.Z)(function*(y,m){const h=(0,O.Qc)(y);if(!h)throw new s.Z("invalid-feature-service-url","Invalid feature service url");const i=h.url.path,L=m.layerId;if(null==L)return{serverUrl:i};const M=j(m),J=e=>(0,t.Z)(i,{query:{f:"json"},responseType:"json",authMode:e,signal:m.signal}),N=J("anonymous").catch(()=>J("no-prompt")),[Q,V]=yield Promise.all([N,M]),l=V?.layers,o=Q.data&&Q.data.layers;if(!Array.isArray(o))throw new Error("expected layers array");if(Array.isArray(l)){for(let e=0;e<Math.min(l.length,o.length);e++)if(l[e].id===L)return{serverUrl:i,layerId:o[e].id}}else if(null!=L&&L<o.length)return{serverUrl:i,layerId:o[L].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function p(){return(p=(0,r.Z)(function*({sceneLayerItem:y,signal:m}){if(!y)return null;try{const h=(yield y.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:m})).find(L=>"Feature Service"===L.type)||null;if(!h)return null;const i=new G.default({portal:h.portal,id:h.id});return yield i.load(),i}catch(h){return(0,E.r9)(h),null}})).apply(this,arguments)}},30164:(z,I,n)=>{n.d(I,{T:()=>Z});var r=n(15861);const Z={BingMapsLayer:(t=(0,r.Z)(function*(){return(yield n.e(2248).then(n.bind(n,72248))).default}),function(){return t.apply(this,arguments)}),BuildingSceneLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(4430),n.e(415),n.e(2432),n.e(9709),n.e(4629),n.e(3784),n.e(9319)]).then(n.bind(n,19319))).default});return function(){return t.apply(this,arguments)}}(),CSVLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(4430),n.e(415),n.e(5625)]).then(n.bind(n,85625))).default});return function(){return t.apply(this,arguments)}}(),DimensionLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(326)]).then(n.bind(n,90326))).default});return function(){return t.apply(this,arguments)}}(),ElevationLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(3327).then(n.bind(n,3327))).default});return function(){return t.apply(this,arguments)}}(),FeatureLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(4430),n.e(415)]).then(n.bind(n,80415))).default});return function(){return t.apply(this,arguments)}}(),GeoJSONLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(2903)]).then(n.bind(n,72903))).default});return function(){return t.apply(this,arguments)}}(),GeoRSSLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(6306).then(n.bind(n,96306))).default});return function(){return t.apply(this,arguments)}}(),GroupLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(5700).then(n.bind(n,55700))).default});return function(){return t.apply(this,arguments)}}(),ImageryLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(6926),n.e(2863),n.e(6606),n.e(3216),n.e(2328)]).then(n.bind(n,62328))).default});return function(){return t.apply(this,arguments)}}(),ImageryTileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(6926),n.e(8594),n.e(2863),n.e(6606),n.e(6241),n.e(3216),n.e(8592),n.e(4316)]).then(n.bind(n,4316))).default});return function(){return t.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(2432),n.e(8592),n.e(362)]).then(n.bind(n,31370))).default});return function(){return t.apply(this,arguments)}}(),KMLLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(8411)]).then(n.bind(n,38411))).default});return function(){return t.apply(this,arguments)}}(),LineOfSightLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(468)]).then(n.bind(n,83602))).default});return function(){return t.apply(this,arguments)}}(),LinkChartLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(337),n.e(5366),n.e(774),n.e(9466),n.e(331),n.e(1599),n.e(8592),n.e(8005)]).then(n.bind(n,28005))).default});return function(){return t.apply(this,arguments)}}(),MapImageLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.resolve().then(n.bind(n,48887))).default});return function(){return t.apply(this,arguments)}}(),MapNotesLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(4430),n.e(415),n.e(8592),n.e(9859)]).then(n.bind(n,19859))).default});return function(){return t.apply(this,arguments)}}(),MediaLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(9347)]).then(n.bind(n,24762))).default});return function(){return t.apply(this,arguments)}}(),OGCFeatureLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(9628),n.e(2955)]).then(n.bind(n,36554))).default});return function(){return t.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(1591)]).then(n.bind(n,71591))).default});return function(){return t.apply(this,arguments)}}(),OrientedImageryLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(4430),n.e(415),n.e(6150)]).then(n.bind(n,66150))).default});return function(){return t.apply(this,arguments)}}(),PointCloudLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(2432),n.e(8592),n.e(7155)]).then(n.bind(n,7155))).default});return function(){return t.apply(this,arguments)}}(),RouteLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(403),n.e(4940)]).then(n.bind(n,84940))).default});return function(){return t.apply(this,arguments)}}(),SceneLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(5366),n.e(2432),n.e(9709),n.e(4629),n.e(3784),n.e(8592),n.e(6933)]).then(n.bind(n,27559))).default});return function(){return t.apply(this,arguments)}}(),StreamLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(289)]).then(n.bind(n,70289))).default});return function(){return t.apply(this,arguments)}}(),SubtypeGroupLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(5366),n.e(4430),n.e(1976)]).then(n.bind(n,81976))).default});return function(){return t.apply(this,arguments)}}(),TileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.resolve().then(n.bind(n,59735))).default});return function(){return t.apply(this,arguments)}}(),UnknownLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(6339).then(n.bind(n,56339))).default});return function(){return t.apply(this,arguments)}}(),UnsupportedLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(6240).then(n.bind(n,16240))).default});return function(){return t.apply(this,arguments)}}(),VectorTileLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4336),n.e(8364),n.e(8592),n.e(2826)]).then(n.bind(n,10193))).default});return function(){return t.apply(this,arguments)}}(),VoxelLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(2432),n.e(8592),n.e(3521)]).then(n.bind(n,26007))).default});return function(){return t.apply(this,arguments)}}(),WFSLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(4199),n.e(5366),n.e(9636),n.e(8762)]).then(n.bind(n,98762))).default});return function(){return t.apply(this,arguments)}}(),WMSLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(6894)]).then(n.bind(n,46894))).default});return function(){return t.apply(this,arguments)}}(),WMTSLayer:function(){var t=(0,r.Z)(function*(){return(yield Promise.all([n.e(8592),n.e(9526)]).then(n.bind(n,69526))).default});return function(){return t.apply(this,arguments)}}(),WebTileLayer:function(){var t=(0,r.Z)(function*(){return(yield n.e(8592).then(n.bind(n,28678))).default});return function(){return t.apply(this,arguments)}}()};var t},45205:(z,I,n)=>{n.d(I,{T:()=>t});var r=n(15861),Z=n(84792);function t(E,O){return s.apply(this,arguments)}function s(){return(s=(0,r.Z)(function*(E,O){const{data:C}=yield(0,Z.Z)(E,{responseType:"json",query:{f:"json",...O?.customParameters,token:O?.apiKey}});return C})).apply(this,arguments)}}}]);