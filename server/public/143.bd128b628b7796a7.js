"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[143],{32837:(me,te,S)=>{S.d(te,{Z:()=>Q});var g=S(21286),u=S(35909),B=S(26996),ne=S(31375),q=S(47139),b=S(80991);class Q{constructor(t){this._resourceManager=t,this._lazyRasterizationCanvas=null}dispose(){this._lazyRasterizationCanvas=null}get _rasterizationCanvas(){return null==this._lazyRasterizationCanvas&&(this._lazyRasterizationCanvas=document.createElement("canvas"),this._lazyRasterizationCanvas.getContext("2d",{willReadFrequently:!0})),this._lazyRasterizationCanvas}rasterizeJSONResource(t,c,l){if("simple-fill"===t.type||"esriSFS"===t.type){const[p,x,k]=(0,B.Y)(this._rasterizationCanvas,t.style,c);return{size:[x,k],image:new Uint32Array(p.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:(0,g.fp)(Math.ceil(c))}}if("simple-line"===t.type||"esriSLS"===t.type||"line"===t.type&&t.dashTemplate){let p,x;if("simple-line"===t.type||"esriSLS"===t.type)switch(p=(0,u.U1)(t.style,t.cap),t.cap){case"butt":x="Butt";break;case"square":x="Square";break;default:x="Round"}else p=t.dashTemplate,x=t.cim.capStyle;const[k,ee,X]=(0,B.m)(p,x);return{size:[ee,X],image:new Uint32Array(k.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let w,A=null,E=null,d=1;if("simple-marker"===t.type||"esriSMS"===t.type||"line-marker"===t.type?(w=u.B$.fromSimpleMarker(t),E=(0,q.Fp)(w)):t.cim&&"CIMHatchFill"===t.cim.type?(w=u.B$.fromCIMHatchFill(t.cim,c),A=new ne.Z(w.frame.xmin,-w.frame.ymax,w.frame.xmax-w.frame.xmin,w.frame.ymax-w.frame.ymin),d=c):t.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===t.cim.markerPlacement.type?(w=u.B$.fromCIMInsidePolygon(t.cim),A=new ne.Z(w.frame.xmin,-w.frame.ymax,w.frame.xmax-w.frame.xmin,w.frame.ymax-w.frame.ymin)):(w=t.cim,t.avoidSDFRasterization||(E=(0,q.Fp)(w))),E&&!l){const[p,x,k]=(0,q.RL)(E);return p?{size:[x,k],image:new Uint32Array(p.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:d}:null}const[H,h,v,_,G]=u.B$.rasterize(this._rasterizationCanvas,w,A,this._resourceManager,!l);return H?{size:[h,v],image:new Uint32Array(H.buffer),sdf:!1,simplePattern:!1,anchorX:_,anchorY:G}:null}rasterizeImageResource(t,c,l,w){this._rasterizationCanvas.width=t,this._rasterizationCanvas.height=c;const A=this._rasterizationCanvas.getContext("2d");l instanceof ImageData?A.putImageData(l,0,0):(l.setAttribute("width",`${t}px`),l.setAttribute("height",`${c}px`),A.drawImage(l,0,0,t,c));const E=A.getImageData(0,0,t,c),d=new Uint8Array(E.data);if(w)for(const p of w)if(p&&p.oldColor&&4===p.oldColor.length&&p.newColor&&4===p.newColor.length){const[x,k,ee,X]=p.oldColor,[ue,oe,ce,le]=p.newColor;if(x===ue&&k===oe&&ee===ce&&X===le)continue;for(let K=0;K<d.length;K+=4)x===d[K]&&k===d[K+1]&&ee===d[K+2]&&X===d[K+3]&&(d[K]=ue,d[K+1]=oe,d[K+2]=ce,d[K+3]=le)}let H;for(let p=0;p<d.length;p+=4)H=d[p+3]/255,d[p]=d[p]*H,d[p+1]=d[p+1]*H,d[p+2]=d[p+2]*H;let h=d,v=t,_=c;const G=512;if(v>=G||_>=G){const p=v/_;p>1?(v=G,_=Math.round(G/p)):(_=G,v=Math.round(G*p)),h=new Uint8Array(4*v*_);const x=new Uint8ClampedArray(h.buffer);(0,b.TT)(d,t,c,x,v,_,!1)}return{size:[v,_],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}},7547:(me,te,S)=>{var g,u,B,ne,q,b,R,Q,$,t,c,l,w,A,E,d,H,h,v,_,G,p,x,k,ee,X,ue,oe,ce,le,K,he,F,n,r,s,a,i,o,f,m,L,U,I,y,M,D,z,N,T,P,Y,C,Z,O,j,J,V,se,ae,W,e;S.d(te,{$y:()=>p,AH:()=>u,CS:()=>D,DD:()=>Q,Dd:()=>ce,Em:()=>G,JS:()=>y,Ky:()=>$,Lh:()=>z,Qb:()=>J,RL:()=>g,RS:()=>se,TF:()=>_,Tx:()=>q,UR:()=>H,UX:()=>j,bj:()=>M,eZ:()=>R,id:()=>ee,kP:()=>s,of:()=>c,r4:()=>f,sj:()=>a,v2:()=>B,zQ:()=>oe,zV:()=>d}),(e=g||(g={}))[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN",function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(u||(u={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(B||(B={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(ne||(ne={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(q||(q={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(b||(b={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(R||(R={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(Q||(Q={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}($||($={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(t||(t={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(c||(c={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(l||(l={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(w||(w={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(A||(A={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(E||(E={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(d||(d={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(H||(H={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(h||(h={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(v||(v={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(_||(_={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(G||(G={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(p||(p={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(x||(x={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(k||(k={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(ee||(ee={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(X||(X={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(ue||(ue={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(oe||(oe={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(ce||(ce={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(le||(le={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(K||(K={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(he||(he={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(F||(F={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(n||(n={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(r||(r={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(s||(s={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(a||(a={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(i||(i={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(o||(o={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(f||(f={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(m||(m={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(L||(L={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(U||(U={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(I||(I={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(y||(y={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(M||(M={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(D||(D={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(z||(z={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(N||(N={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(T||(T={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(P||(P={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(Y||(Y={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(C||(C={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(Z||(Z={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(O||(O={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(j||(j={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(J||(J={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(V||(V={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(se||(se={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(ae||(ae={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(W||(W={}))},26996:(me,te,S)=>{S.d(te,{Y:()=>ne,m:()=>q});var g=S(36161),u=S(21286);const B=b=>"vertical"===b||"horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSVertical"===b||"esriSFSHorizontal"===b;function ne(b,R,Q){const $=(0,u.fp)(Math.ceil(Q)),t=B(R)?8*$:16*$,c=2*$;b.width=t,b.height=t;const l=b.getContext("2d");l.strokeStyle="#FFFFFF",l.lineWidth=$,l.beginPath(),"vertical"!==R&&"cross"!==R&&"esriSFSCross"!==R&&"esriSFSVertical"!==R||(l.moveTo(t/2,-c),l.lineTo(t/2,t+c)),"horizontal"!==R&&"cross"!==R&&"esriSFSCross"!==R&&"esriSFSHorizontal"!==R||(l.moveTo(-c,t/2),l.lineTo(t+c,t/2)),"forward-diagonal"!==R&&"diagonal-cross"!==R&&"esriSFSDiagonalCross"!==R&&"esriSFSForwardDiagonal"!==R||(l.moveTo(-c,-c),l.lineTo(t+c,t+c),l.moveTo(t-c,-c),l.lineTo(t+c,c),l.moveTo(-c,t-c),l.lineTo(c,t+c)),"backward-diagonal"!==R&&"diagonal-cross"!==R&&"esriSFSBackwardDiagonal"!==R&&"esriSFSDiagonalCross"!==R||(l.moveTo(t+c,-c),l.lineTo(-c,t+c),l.moveTo(c,-c),l.lineTo(-c,c),l.moveTo(t+c,t-c),l.lineTo(t-c,t+c)),l.stroke();const w=l.getImageData(0,0,b.width,b.height),A=new Uint8Array(w.data);let E;for(let d=0;d<A.length;d+=4)E=A[d+3]/255,A[d]=A[d]*E,A[d+1]=A[d+1]*E,A[d+2]=A[d+2]*E;return[A,b.width,b.height]}function q(b,R){const Q="Butt"===R,$="Square"===R,t=!Q&&!$;b.length%2==1&&(b=[...b,...b]);const c=15.5;let w=0;for(const x of b)w+=x;const A=Math.round(w*c),E=new Float32Array(31*A),d=7.75;let H=0,h=0,v=.5,_=!0;for(const x of b){for(H=h,h+=x*c;v<=h;){let k=.5;for(;k<31;){const ee=(k-.5)*A+v-.5,X=t?(k-c)*(k-c):Math.abs(k-c);E[ee]=_?Q?Math.max(Math.max(H+d-v,X),Math.max(v-h+d,X)):X:t?Math.min((v-H)*(v-H)+X,(v-h)*(v-h)+X):$?Math.min(Math.max(v-H,X),Math.max(h-v,X)):Math.min(Math.max(v-H+d,X),Math.max(h+d-v,X)),k++}v++}_=!_}const G=E.length,p=new Uint8Array(4*G);for(let x=0;x<G;++x){const k=(t?Math.sqrt(E[x]):E[x])/c;(0,g.I)(k,p,4*x)}return[p,A,31]}},2466:(me,te,S)=>{S.r(te),S.d(te,{previewCIMSymbol:()=>K});var g=S(15861),u=S(23841),B=S(35909),ne=S(91558),q=S(84792),b=S(10699),R=S(13871),Q=S(57052),$=S(26933),t=S(32837),c=S(68937),l=S(80991),w=S(56445),A=S(37519);const E=F=>F?.scaleFactor?F.scaleFactor:1;var _=S(71131),G=S(34057);const p=new class H{constructor(n,r){this._spatialReference=n,this._avoidSDF=r,this._resourceCache=new Map,this._lazyImageDataCanvas=null,this._pictureMarkerCache=new Map,this._textRasterizer=new c.Z,this._cimResourceManager=new Q.Z,this._rasterizer=new t.Z(this._cimResourceManager)}get _imageDataCanvas(){return this._lazyImageDataCanvas??=document.createElement("canvas"),this._lazyImageDataCanvas}get _imageDataContext(){return this._imageDataCanvas.getContext("2d",{willReadFrequently:!0})}get resourceManager(){return this._cimResourceManager}rasterizeCIMSymbolAsync(n,r,s,a,i,o,f,m,L){var U=this;return(0,g.Z)(function*(){if(!n)return null;const{data:I}=n;if(!I||"CIMSymbolReference"!==I.type||!I.symbol)return null;const{symbol:y}=I;o||(o=(0,l.JW)(y));const M=yield B.E0.resolveSymbolOverrides(I,r,U._spatialReference,i,o,f,m),D=U._imageDataCanvas,z=U._cimResourceManager,N=[];B.B$.fetchResources(M,z,N),B.B$.fetchFonts(M,z,N),N.length>0&&(yield Promise.all(N));const{width:T,height:P}=s,Y=function h(F,n,r,s){const i=-n/2+1,o=n/2-1,f=r/2-1,m=-r/2+1;switch(F){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[i,0],[0,0],[o,0]]]};default:return"legend"===s?{rings:[[[i,f],[o,0],[o,m],[i,m],[i,f]]]}:{rings:[[[i,f],[o,f],[o,m],[i,m],[i,f]]]}}}(o,T,P,a),C=B.B$.getEnvelope(M,Y,z);if(!C)return null;const Z=1.3333333333333333*(window.devicePixelRatio||1);let O=1,j=0,J=0;switch(y.type){case"CIMPointSymbol":case"CIMTextSymbol":{let W=1;C.width>T&&(W=T/C.width);let e=1;C.height>P&&(e=P/C.height),"preview"===a&&(C.width<T&&(W=T/C.width),C.height<P&&(e=P/C.height)),O=Math.min(W,e),j=C.x+C.width/2,J=C.y+C.height/2}break;case"CIMLineSymbol":{(L||C.height>P)&&(O=P/C.height),J=C.y+C.height/2;const W=C.x*O+T/2,e=(C.x+C.width)*O+T/2,{paths:ie}=Y;ie[0][0][0]-=W/O,ie[0][2][0]-=(e-T)/O}break;case"CIMPolygonSymbol":{j=C.x+C.width/2,J=C.y+C.height/2;const W=C.x*O+T/2,e=(C.x+C.width)*O+T/2,ie=C.y*O+P/2,fe=(C.y+C.height)*O+P/2,{rings:re}=Y;W<0&&(re[0][0][0]-=W,re[0][3][0]-=W,re[0][4][0]-=W),ie<0&&(re[0][0][1]+=ie,re[0][1][1]+=ie,re[0][4][1]+=ie),e>T&&(re[0][1][0]-=e-T,re[0][2][0]-=e-T),fe>P&&(re[0][2][1]+=fe-P,re[0][3][1]+=fe-P)}}D.width=T*Z,D.height=P*Z,D.width+=2,D.height+=2;const se=U._imageDataContext,ae=$.zA.createIdentity();return ae.translate(-j,-J),ae.scale(O*Z,-O*Z),ae.translate(T*Z/2+1,P*Z/2+1),se.clearRect(0,0,D.width,D.height),new $.cD(se,z,ae,!0).drawSymbol(M,Y),se.getImageData(0,0,D.width,D.height)})()}analyzeCIMSymbol3D(n,r,s,a,i){var o=this;return(0,g.Z)(function*(){const f=[],m=r?{geometryType:a,spatialReference:o._spatialReference,fields:r}:null,L=[];B.B$.fetchFonts(n.data.symbol,o._cimResourceManager,L),yield Promise.all(L);const U=new R._(o._cimResourceManager,m);let I;yield U.analyzeSymbolReference(n.data,o._avoidSDF,f),(0,b.k_)(i);for(const y of f)"CIMPictureMarker"!==y.cim.type&&"CIMPictureFill"!==y.cim.type&&"CIMPictureStroke"!==y.cim.type||(I||(I=[]),I.push(o._fetchPictureMarkerResource(y,i))),s&&"text"===y.type&&"string"==typeof y.text&&y.text.includes("[")&&(y.text=(0,l.Qs)(s,y.text,y.cim.textCase));return I&&(yield Promise.all(I)),f})()}rasterizeCIMSymbol3D(n,r,s,a,i,o){const f=[];for(const m of n){a&&"function"==typeof a.scaleFactor&&(a.scaleFactor=a.scaleFactor(r,i,o));const L=this._getRasterizedResource(m,r,s,a,i,o);if(!L)continue;let U=0,I=L.anchorX||0,y=L.anchorY||0,M=!1,D=0,z=0;if("esriGeometryPoint"===s){const N=E(a);if(D=(0,l.hf)(m.offsetX,r,i,o)*N||0,z=(0,l.hf)(m.offsetY,r,i,o)*N||0,"marker"===m.type)U=(0,l.hf)(m.rotation,r,i,o)||0,M=m.rotateClockwise??!1;else if("text"===m.type){if(U=(0,l.hf)(m.angle,r,i,o)||0,void 0!==m.horizontalAlignment)switch(m.horizontalAlignment){case"left":I=-.5;break;case"right":I=.5;break;default:I=0}if(void 0!==m.verticalAlignment)switch(m.verticalAlignment){case"top":y=.5;break;case"bottom":y=-.5;break;case"baseline":y=-.25;break;default:y=0}}}null!=L&&f.push({angle:U,rotateClockWise:M,anchorX:I,anchorY:y,offsetX:D,offsetY:z,rasterizedResource:L})}return this.getSymbolImage(f)}getSymbolImage(n){const r=document.createElement("canvas"),s=r.getContext("2d");let a=0,i=0,o=0,f=0;const m=[];for(let y=0;y<n.length;y++){const M=n[y],D=M.rasterizedResource;if(!D)continue;const z=D.size,N=M.offsetX,T=M.offsetY,P=M.anchorX,Y=M.anchorY,C=M.rotateClockWise||!1;let Z=M.angle,O=(0,u.F2)(N)-z[0]*(.5+P),j=(0,u.F2)(T)-z[1]*(.5+Y),J=O+z[0],V=j+z[1];if(Z){C&&(Z=-Z);const W=Math.sin(Z*Math.PI/180),e=Math.cos(Z*Math.PI/180),ie=O*e-j*W,fe=O*W+j*e,re=O*e-V*W,de=O*W+V*e,ge=J*e-V*W,pe=J*W+V*e,ye=J*e-j*W,Ce=J*W+j*e;O=Math.min(ie,re,ge,ye),j=Math.min(fe,de,pe,Ce),J=Math.max(ie,re,ge,ye),V=Math.max(fe,de,pe,Ce)}a=O<a?O:a,i=j<i?j:i,o=J>o?J:o,f=V>f?V:f;const se=s.createImageData(D.size[0],D.size[1]);se.data.set(new Uint8ClampedArray(D.image.buffer)),m.push({offsetX:N,offsetY:T,rotateClockwise:C,angle:Z,rasterizedImage:se,anchorX:P,anchorY:Y})}r.width=o-a,r.height=f-i;const L=-a,U=f;for(let y=0;y<m.length;y++){const M=m[y],D=this._imageDataToCanvas(M.rasterizedImage),T=L-M.rasterizedImage.width*(.5+M.anchorX),P=U-M.rasterizedImage.height*(.5-M.anchorY);if(M.angle){const Y=(360-M.angle)*Math.PI/180;s.save(),s.translate((0,u.F2)(M.offsetX),-(0,u.F2)(M.offsetY)),s.translate(L,U),s.rotate(Y),s.translate(-L,-U),s.drawImage(D,T,P),s.restore()}else s.drawImage(D,T+(0,u.F2)(M.offsetX),P-(0,u.F2)(M.offsetY))}const I=new A.e({x:L/r.width-.5,y:U/r.height-.5});return{imageData:0!==r.width&&0!==r.height?s.getImageData(0,0,r.width,r.height):s.createImageData(1,1),anchorPosition:I}}_fetchPictureMarkerResource(n,r){var s=this;return(0,g.Z)(function*(){const a=n.materialHash;if(!s._pictureMarkerCache.get(a)){const i=(yield(0,q.Z)(n.cim.url,{responseType:"image",signal:r?.signal})).data;s._pictureMarkerCache.set(a,i)}})()}_imageDataToCanvas(n){const r=this._imageDataCanvas,s=this._imageDataContext;return r.width=n.width,r.height=n.height,s.putImageData(n,0,0),r}_imageTo32Array(n,r,s,a){const i=this._imageDataCanvas,o=this._imageDataContext;if(i.width=r,i.height=s,o.drawImage(n,0,0,r,s),a){o.save();const f=new ne.Z(a);o.fillStyle=f.toHex(),o.globalCompositeOperation="multiply",o.fillRect(0,0,r,s),o.globalCompositeOperation="destination-atop",o.drawImage(n,0,0,r,s),o.restore()}return new Uint32Array(o.getImageData(0,0,r,s).data.buffer)}_getRasterizedResource(n,r,s,a,i,o){let f,m,L;if("text"===n.type)return this._rasterizeTextResource(n,r,a,i,o);({analyzedCIM:f,hash:m}=function v(F,n,r,s){let a,i;return"function"==typeof F.materialHash?(a=(0,F.materialHash)(n,r,s),i=(0,R.S)(F.cim,F.materialOverrides)):(a=F.materialHash,i=F.cim),{analyzedCIM:i,hash:a}}(n,r,i,o));const y=E(a);if("CIMPictureMarker"===n.cim.type){const z=(0,l.hf)(n.size,r,i,o)*y,{image:N,width:T,height:P}=this._getPictureResource(n,z,(0,l.hf)(n.color,r,i,o));return L={image:N,size:[T,P],sdf:!1,simplePattern:!1,anchorX:n.anchorPoint?n.anchorPoint.x:0,anchorY:n.anchorPoint?n.anchorPoint.y:0},L}(0,w.FW)(f,y,{preserveOutlineWidth:!1});const M=f;m+=s,a&&(m+=JSON.stringify(a));const D=this._resourceCache;return D.has(m)?D.get(m):(L=this._rasterizer.rasterizeJSONResource({cim:M,type:n.type,url:n.url,mosaicHash:m,size:null,path:null},window.devicePixelRatio||1,this._avoidSDF),D.set(m,L),L)}_rasterizeTextResource(n,r,s,a,i){const o=E(s),f=(0,l.hf)(n.text,r,a,i);if(!f||0===f.length)return null;const m=n.cim,L=(0,l.hf)(m?.fontFamilyName||n.fontName,r,a,i),U=(0,l.hf)(m?.font?.style||n.style,r,a,i),I=(0,l.hf)(m?.font?.weight||n.weight,r,a,i),y=(0,l.hf)(m?.font?.decoration||n.decoration,r,a,i),M=(0,l.hf)(n.size,r,a,i)*o,D=(0,l.hf)(n.horizontalAlignment,r,a,i),z=(0,l.hf)(n.verticalAlignment,r,a,i),N=(0,l.nn)((0,l.hf)(n.color,r,a,i)),T=(0,l.nn)((0,l.hf)(n.outlineColor,r,a,i)),P=(0,l.hf)(n.outlineSize,r,a,i),Y=null!=n.backgroundColor?(0,l.nn)(n.backgroundColor):null,C=null!=n.borderLineColor?(0,l.nn)(n.borderLineColor):null,Z=null!=n.borderLineWidth?n.borderLineWidth:null;return this._textRasterizer.rasterizeText(f,{color:N,size:M,horizontalAlignment:D,verticalAlignment:z,font:{family:L,style:U,weight:I,decoration:y},halo:{size:P||0,color:T,style:U},backgroundColor:Y,borderLine:null!=C&&null!=Z?{color:C,size:Z}:null,pixelRatio:1,premultiplyColors:!this._avoidSDF})}_getPictureResource(n,r,s){const a=this._pictureMarkerCache.get(n.materialHash);if(!a)return null;const i=a.height/a.width,o=r?i>1?(0,u.F2)(r):(0,u.F2)(r)/i:a.width,f=r?i>1?(0,u.F2)(r)*i:(0,u.F2)(r):a.height;return{image:this._imageTo32Array(a,o,f,s),width:o,height:f}}}(null,!0),x=(0,u.Wz)(_.b_.size),k=(0,u.Wz)(_.b_.maxSize),ee=(0,u.Wz)(_.b_.lineWidth),X=1;function oe(){return oe=(0,g.Z)(function*(F,n,r){const s=n?.size;let a=null!=s&&"object"==typeof s&&"width"in s?s.width:s,i=null!=s&&"object"==typeof s&&"height"in s?s.height:s;if(null==a||null==i)if("esriGeometryPolygon"===r)a=x,i=x;else{const o=yield function ce(F,n,r){return le.apply(this,arguments)}(F,n,r);o&&(a=o.width,i=o.height),"esriGeometryPolyline"===r&&(a=ee),a=null!=a&&isFinite(a)?Math.min(a,k):x,i=null!=i&&isFinite(i)?Math.max(Math.min(i,k),X):x}return"legend"===n.style&&"esriGeometryPolyline"===r&&(a=ee),{width:a,height:i}}),oe.apply(this,arguments)}function le(){return(le=(0,g.Z)(function*(F,n,r){const{feature:s,fieldMap:a,viewParams:i}=n.cimOptions||n,o=yield B.E0.resolveSymbolOverrides(F.data,s,null,a,r,null,i);if(!o)return null;(F=F.clone()).data={type:"CIMSymbolReference",symbol:o},F.data.primitiveOverrides=void 0;const f=[];return B.B$.fetchResources(o,p.resourceManager,f),B.B$.fetchFonts(o,p.resourceManager,f),f.length>0&&(yield Promise.all(f)),B.B$.getEnvelope(o,null,p.resourceManager)})).apply(this,arguments)}function K(F){return he.apply(this,arguments)}function he(){return he=(0,g.Z)(function*(F,n={}){const{node:r,opacity:s,symbolConfig:a}=n,i=null!=a&&"object"==typeof a&&"isSquareFill"in a&&a.isSquareFill,o=n.cimOptions||n,f=o.geometryType||(0,l.JW)(F?.data?.symbol),m=yield function ue(F,n,r){return oe.apply(this,arguments)}(F,n,f),{feature:L,fieldMap:U}=o,I=i||"esriGeometryPolygon"!==f?"preview":"legend",y=yield p.rasterizeCIMSymbolAsync(F,L,m,I,U,f,null,o.viewParams,o.allowScalingUp);if(!y)return null;const{width:M,height:D}=y,z=document.createElement("canvas");z.width=M,z.height=D,z.getContext("2d").putImageData(y,0,0);const N=(0,u.F2)(m.width),T=(0,u.F2)(m.height),P=new Image(N,T);P.src=z.toDataURL(),P.ariaLabel=n.ariaLabel??null,P.alt=n.ariaLabel??"",null!=s&&(P.style.opacity=`${s}`);let Y=P;return null!=n.effectView&&(Y=(0,G.wh)([[{shape:{type:"image",x:0,y:0,width:N,height:T,src:P.src},fill:null,stroke:null,offset:[0,0]}]],[N,T],{effectView:n.effectView,ariaLabel:n.ariaLabel})),r&&Y&&r.appendChild(Y),Y}),he.apply(this,arguments)}},61261:(me,te,S)=>{var g,u,t;function B(t){switch(t){case"left":return g.Left;case"right":return g.Right;case"center":return g.Center}}function ne(t){switch(t){case"top":return u.Top;case"middle":return u.Center;case"baseline":return u.Baseline;case"bottom":return u.Bottom}}function q(t){switch(t){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[g.Right,u.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[g.Center,u.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[g.Left,u.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[g.Right,u.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[g.Center,u.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[g.Left,u.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[g.Right,u.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[g.Center,u.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[g.Left,u.Top];default:return console.debug(`Found invalid placement type ${t}`),[g.Center,u.Center]}}function b(t){switch(t){case g.Right:return-1;case g.Center:return 0;case g.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}}function R(t){switch(t){case u.Top:return 1;case u.Center:return 0;case u.Bottom:case u.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}}function Q(t){switch(t){case"left":return g.Left;case"right":return g.Right;case"center":return g.Center}}function $(t){switch(t){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}S.d(te,{Hd:()=>Q,M7:()=>g,NS:()=>$,TR:()=>u,b7:()=>ne,g:()=>b,kH:()=>B,qv:()=>q,tf:()=>R}),(t=g||(g={}))[t.Left=-1]="Left",t[t.Center=0]="Center",t[t.Right=1]="Right",function(t){t[t.Top=1]="Top",t[t.Center=0]="Center",t[t.Bottom=-1]="Bottom",t[t.Baseline=2]="Baseline"}(u||(u={}))},39351:(me,te,S)=>{S.d(te,{$6:()=>Ce,$y:()=>r,BB:()=>T,Cj:()=>ie,FM:()=>Ae,Fn:()=>z,GS:()=>Me,Ib:()=>K,Im:()=>s,JS:()=>de,KA:()=>ge,Kg:()=>t,Kt:()=>ce,NG:()=>Fe,NS:()=>N,Of:()=>m,Pp:()=>E,S:()=>I,SQ:()=>pe,Sf:()=>f,T3:()=>e,U8:()=>y,Ux:()=>we,Uz:()=>De,Vo:()=>V,WD:()=>Re,Wq:()=>Pe,XO:()=>he,XT:()=>X,Zt:()=>o,_E:()=>J,ad:()=>l,av:()=>Te,b7:()=>ue,dD:()=>j,do:()=>Z,g3:()=>P,gV:()=>be,gr:()=>b,i9:()=>R,iD:()=>ee,j9:()=>U,jS:()=>F,k9:()=>ne,kU:()=>Y,mb:()=>M,nY:()=>O,o2:()=>a,oh:()=>c,pZ:()=>Se,pb:()=>i,qu:()=>W,rL:()=>ve,s4:()=>ae,tg:()=>n,uk:()=>H,vk:()=>L,wJ:()=>le,x_:()=>d,yc:()=>ye,zE:()=>xe});var g=S(8314);const ne=1e-30,b=4294967295,R=512,t=128,c=511,l=16777216,E=8,d=10,H=29,ee=24,X=8,ue={metrics:{width:15,height:17,left:0,top:-7,advance:14}},ce=0,le=0,K=0,he=1,F=2,n=3,r=4,s=5,a=6,i=12,o=5,f=6,m=5,L=6,U=0,I=1,y=2,M=3,z=4,N=2,T=1,P=2,Y=4,Z=1.05,O=(0,g.Z)("featurelayer-force-marker-text-draw-order")?.5:3,j=5,J=6,V=1.15,ae=2,W=128-2*ae,e=8,ie=500,de=10,ge=1024,pe=2,ye=0,Ce=1,Se=4,ve=8,Me=16,Pe=4,Re=1,we=4,Te=8,be=32,xe=64,De=128,Fe=4,Ae=2},5254:(me,te,S)=>{S.d(te,{Au:()=>l,Jz:()=>E,UJ:()=>A});const g=new Float32Array(1);function l(h){return[255&h,(65280&h)>>>8,(16711680&h)>>>16,(4278190080&h)>>>24]}function A(h,v){return 65535&h|v<<16}function E(h,v,_,G){return 255&h|(255&v)<<8|(255&_)<<16|G<<24}new Uint32Array(g.buffer)}}]);