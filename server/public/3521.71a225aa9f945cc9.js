"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[3521],{550:(Ne,re,v)=>{function t(){return[1,0,0,0,1,0,0,0,1]}function C(M,O,o,T,$,L,_,V,z){return[M,O,o,T,$,L,_,V,z]}function D(M,O){return new Float64Array(M,O,9)}v.d(re,{a:()=>t,c:()=>D,f:()=>C}),Object.freeze(Object.defineProperty({__proto__:null,clone:function J(M){return[M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],M[8]]},create:t,createView:D,fromValues:C},Symbol.toStringTag,{value:"Module"}))},48977:(Ne,re,v)=>{v.d(re,{a:()=>x,c:()=>p,g:()=>T,j:()=>B,k:()=>n,m:()=>$,s:()=>o});var t=v(550),J=v(78451),C=v(28093),D=v(39863),W=v(84161),M=v(993);function o(s,u,b){b*=.5;const d=Math.sin(b);return s[0]=d*u[0],s[1]=d*u[1],s[2]=d*u[2],s[3]=Math.cos(b),s}function T(s,u){const b=2*Math.acos(u[3]),d=Math.sin(b/2);return d>(0,D.g)()?(s[0]=u[0]/d,s[1]=u[1]/d,s[2]=u[2]/d):(s[0]=1,s[1]=0,s[2]=0),b}function $(s,u,b){const d=u[0],m=u[1],f=u[2],j=u[3],S=b[0],I=b[1],P=b[2],F=b[3];return s[0]=d*F+j*S+m*P-f*I,s[1]=m*F+j*I+f*S-d*P,s[2]=f*F+j*P+d*I-m*S,s[3]=j*F-d*S-m*I-f*P,s}function Y(s,u,b,d){const m=u[0],f=u[1],j=u[2],S=u[3];let I,P,F,K,ue,pe=b[0],Q=b[1],le=b[2],me=b[3];return P=m*pe+f*Q+j*le+S*me,P<0&&(P=-P,pe=-pe,Q=-Q,le=-le,me=-me),1-P>(0,D.g)()?(I=Math.acos(P),F=Math.sin(I),K=Math.sin((1-d)*I)/F,ue=Math.sin(d*I)/F):(K=1-d,ue=d),s[0]=K*m+ue*pe,s[1]=K*f+ue*Q,s[2]=K*j+ue*le,s[3]=K*S+ue*me,s}function x(s,u){return s[0]=-u[0],s[1]=-u[1],s[2]=-u[2],s[3]=u[3],s}function r(s,u){const b=u[0]+u[4]+u[8];let d;if(b>0)d=Math.sqrt(b+1),s[3]=.5*d,d=.5/d,s[0]=(u[5]-u[7])*d,s[1]=(u[6]-u[2])*d,s[2]=(u[1]-u[3])*d;else{let m=0;u[4]>u[0]&&(m=1),u[8]>u[3*m+m]&&(m=2);const f=(m+1)%3,j=(m+2)%3;d=Math.sqrt(u[3*m+m]-u[3*f+f]-u[3*j+j]+1),s[m]=.5*d,d=.5/d,s[3]=(u[3*f+j]-u[3*j+f])*d,s[f]=(u[3*f+m]+u[3*m+f])*d,s[j]=(u[3*j+m]+u[3*m+j])*d}return s}function n(s,u,b,d){const m=.5*Math.PI/180;u*=m,b*=m,d*=m;const f=Math.sin(u),j=Math.cos(u),S=Math.sin(b),I=Math.cos(b),P=Math.sin(d),F=Math.cos(d);return s[0]=f*I*F-j*S*P,s[1]=j*S*F+f*I*P,s[2]=j*I*P-f*S*F,s[3]=j*I*F+f*S*P,s}const p=M.c,y=M.s,ne=M.a,Ce=$,se=M.b,G=M.d,ee=M.l,Z=M.f,Le=Z,be=M.g,je=be,he=M.n,B=M.h,Ae=M.e,X=(0,C.c)(),De=(0,C.f)(1,0,0),Fe=(0,C.f)(0,1,0),ae=(0,J.a)(),ge=(0,J.a)(),ie=(0,t.a)();Object.freeze(Object.defineProperty({__proto__:null,add:ne,calculateW:function z(s,u){const b=u[0],d=u[1],m=u[2];return s[0]=b,s[1]=d,s[2]=m,s[3]=Math.sqrt(Math.abs(1-b*b-d*d-m*m)),s},conjugate:x,copy:p,dot:G,equals:Ae,exactEquals:B,fromEuler:n,fromMat3:r,getAxisAngle:T,identity:function O(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s},invert:function a(s,u){const b=u[0],d=u[1],m=u[2],f=u[3],j=b*b+d*d+m*m+f*f,S=j?1/j:0;return s[0]=-b*S,s[1]=-d*S,s[2]=-m*S,s[3]=f*S,s},len:Le,length:Z,lerp:ee,mul:Ce,multiply:$,normalize:he,random:function Ve(s){const u=D.R,b=u(),d=u(),m=u(),f=Math.sqrt(1-b),j=Math.sqrt(b);return s[0]=f*Math.sin(2*Math.PI*d),s[1]=f*Math.cos(2*Math.PI*d),s[2]=j*Math.sin(2*Math.PI*m),s[3]=j*Math.cos(2*Math.PI*m),s},rotateX:function L(s,u,b){b*=.5;const d=u[0],m=u[1],f=u[2],j=u[3],S=Math.sin(b),I=Math.cos(b);return s[0]=d*I+j*S,s[1]=m*I+f*S,s[2]=f*I-m*S,s[3]=j*I-d*S,s},rotateY:function _(s,u,b){b*=.5;const d=u[0],m=u[1],f=u[2],j=u[3],S=Math.sin(b),I=Math.cos(b);return s[0]=d*I-f*S,s[1]=m*I+j*S,s[2]=f*I+d*S,s[3]=j*I-m*S,s},rotateZ:function V(s,u,b){b*=.5;const d=u[0],m=u[1],f=u[2],j=u[3],S=Math.sin(b),I=Math.cos(b);return s[0]=d*I+m*S,s[1]=m*I-d*S,s[2]=f*I+j*S,s[3]=j*I-f*S,s},rotationTo:function _e(s,u,b){const d=(0,W.j)(u,b);return d<-.999999?((0,W.b)(X,De,u),(0,W.k)(X)<1e-6&&(0,W.b)(X,Fe,u),(0,W.n)(X,X),o(s,X,Math.PI),s):d>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):((0,W.b)(X,u,b),s[0]=X[0],s[1]=X[1],s[2]=X[2],s[3]=1+d,he(s,s))},scale:se,set:y,setAxes:function we(s,u,b,d){const m=ie;return m[0]=b[0],m[3]=b[1],m[6]=b[2],m[1]=d[0],m[4]=d[1],m[7]=d[2],m[2]=-u[0],m[5]=-u[1],m[8]=-u[2],he(s,r(s,m))},setAxisAngle:o,slerp:Y,sqlerp:function qe(s,u,b,d,m,f){return Y(ae,u,m,f),Y(ge,b,d,f),Y(s,ae,ge,2*f*(1-f)),s},sqrLen:je,squaredLength:be,str:function l(s){return"quat("+s[0]+", "+s[1]+", "+s[2]+", "+s[3]+")"}},Symbol.toStringTag,{value:"Module"}))},78451:(Ne,re,v)=>{function t(){return[0,0,0,1]}function J(O){return[O[0],O[1],O[2],O[3]]}function D(O,o){return new Float64Array(O,o,4)}v.d(re,{I:()=>W,a:()=>t,b:()=>J,c:()=>D});const W=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:W,clone:J,create:t,createView:D,fromValues:function C(O,o,T,$){return[O,o,T,$]}},Symbol.toStringTag,{value:"Module"}))},50011:(Ne,re,v)=>{v.d(re,{F:()=>Ve,M:()=>t});const t={Base64:0,Hex:1,String:2,Raw:3},J=8,C=(1<<J)-1;function D(a,x){const r=(65535&a)+(65535&x);return(a>>16)+(x>>16)+(r>>16)<<16|65535&r}function $(a,x,r,n,l,p){return D(function T(a,x){return a<<x|a>>>32-x}(D(D(x,a),D(n,p)),l),r)}function L(a,x,r,n,l,p,y){return $(x&r|~x&n,a,x,l,p,y)}function _(a,x,r,n,l,p,y){return $(x&n|r&~n,a,x,l,p,y)}function V(a,x,r,n,l,p,y){return $(x^r^n,a,x,l,p,y)}function z(a,x,r,n,l,p,y){return $(r^(x|~n),a,x,l,p,y)}function Ve(a,x=t.Hex){const r=x||t.Base64,n=function Y(a,x){a[x>>5]|=128<<x%32,a[14+(x+64>>>9<<4)]=x;let r=1732584193,n=-271733879,l=-1732584194,p=271733878;for(let y=0;y<a.length;y+=16){const ne=r,Ce=n,se=l,G=p;r=L(r,n,l,p,a[y],7,-680876936),p=L(p,r,n,l,a[y+1],12,-389564586),l=L(l,p,r,n,a[y+2],17,606105819),n=L(n,l,p,r,a[y+3],22,-1044525330),r=L(r,n,l,p,a[y+4],7,-176418897),p=L(p,r,n,l,a[y+5],12,1200080426),l=L(l,p,r,n,a[y+6],17,-1473231341),n=L(n,l,p,r,a[y+7],22,-45705983),r=L(r,n,l,p,a[y+8],7,1770035416),p=L(p,r,n,l,a[y+9],12,-1958414417),l=L(l,p,r,n,a[y+10],17,-42063),n=L(n,l,p,r,a[y+11],22,-1990404162),r=L(r,n,l,p,a[y+12],7,1804603682),p=L(p,r,n,l,a[y+13],12,-40341101),l=L(l,p,r,n,a[y+14],17,-1502002290),n=L(n,l,p,r,a[y+15],22,1236535329),r=_(r,n,l,p,a[y+1],5,-165796510),p=_(p,r,n,l,a[y+6],9,-1069501632),l=_(l,p,r,n,a[y+11],14,643717713),n=_(n,l,p,r,a[y],20,-373897302),r=_(r,n,l,p,a[y+5],5,-701558691),p=_(p,r,n,l,a[y+10],9,38016083),l=_(l,p,r,n,a[y+15],14,-660478335),n=_(n,l,p,r,a[y+4],20,-405537848),r=_(r,n,l,p,a[y+9],5,568446438),p=_(p,r,n,l,a[y+14],9,-1019803690),l=_(l,p,r,n,a[y+3],14,-187363961),n=_(n,l,p,r,a[y+8],20,1163531501),r=_(r,n,l,p,a[y+13],5,-1444681467),p=_(p,r,n,l,a[y+2],9,-51403784),l=_(l,p,r,n,a[y+7],14,1735328473),n=_(n,l,p,r,a[y+12],20,-1926607734),r=V(r,n,l,p,a[y+5],4,-378558),p=V(p,r,n,l,a[y+8],11,-2022574463),l=V(l,p,r,n,a[y+11],16,1839030562),n=V(n,l,p,r,a[y+14],23,-35309556),r=V(r,n,l,p,a[y+1],4,-1530992060),p=V(p,r,n,l,a[y+4],11,1272893353),l=V(l,p,r,n,a[y+7],16,-155497632),n=V(n,l,p,r,a[y+10],23,-1094730640),r=V(r,n,l,p,a[y+13],4,681279174),p=V(p,r,n,l,a[y],11,-358537222),l=V(l,p,r,n,a[y+3],16,-722521979),n=V(n,l,p,r,a[y+6],23,76029189),r=V(r,n,l,p,a[y+9],4,-640364487),p=V(p,r,n,l,a[y+12],11,-421815835),l=V(l,p,r,n,a[y+15],16,530742520),n=V(n,l,p,r,a[y+2],23,-995338651),r=z(r,n,l,p,a[y],6,-198630844),p=z(p,r,n,l,a[y+7],10,1126891415),l=z(l,p,r,n,a[y+14],15,-1416354905),n=z(n,l,p,r,a[y+5],21,-57434055),r=z(r,n,l,p,a[y+12],6,1700485571),p=z(p,r,n,l,a[y+3],10,-1894986606),l=z(l,p,r,n,a[y+10],15,-1051523),n=z(n,l,p,r,a[y+1],21,-2054922799),r=z(r,n,l,p,a[y+8],6,1873313359),p=z(p,r,n,l,a[y+15],10,-30611744),l=z(l,p,r,n,a[y+6],15,-1560198380),n=z(n,l,p,r,a[y+13],21,1309151649),r=z(r,n,l,p,a[y+4],6,-145523070),p=z(p,r,n,l,a[y+11],10,-1120210379),l=z(l,p,r,n,a[y+2],15,718787259),n=z(n,l,p,r,a[y+9],21,-343485551),r=D(r,ne),n=D(n,Ce),l=D(l,se),p=D(p,G)}return[r,n,l,p]}(function W(a){const x=[];for(let r=0,n=a.length*J;r<n;r+=J)x[r>>5]|=(a.charCodeAt(r/J)&C)<<r%32;return x}(a),a.length*J);switch(r){case t.Raw:return n;case t.Hex:return function O(a){const x="0123456789abcdef",r=[];for(let n=0,l=4*a.length;n<l;n++)r.push(x.charAt(a[n>>2]>>n%4*8+4&15)+x.charAt(a[n>>2]>>n%4*8&15));return r.join("")}(n);case t.String:return function M(a){const x=[];for(let r=0,n=32*a.length;r<n;r+=J)x.push(String.fromCharCode(a[r>>5]>>>r%32&C));return x.join("")}(n);case t.Base64:return function o(a){const n=[];for(let l=0,p=4*a.length;l<p;l+=3){const y=(a[l>>2]>>l%4*8&255)<<16|(a[l+1>>2]>>(l+1)%4*8&255)<<8|a[l+2>>2]>>(l+2)%4*8&255;for(let ne=0;ne<4;ne++)n.push(8*l+6*ne>32*a.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(y>>6*(3-ne)&63))}return n.join("")}(n)}}},26007:(Ne,re,v)=>{v.r(re),v.d(re,{default:()=>ut});var t=v(17626),J=v(73281),C=v(74333),D=v(26584),W=v(63290),M=v(99959),O=v(10699),o=v(77712),T=v(90912),_=(v(85931),v(8314),v(68653)),V=v(76898),z=v(84161),Y=v(28093),Ve=v(2004),a=v(44917),x=v(50085),r=v(65088),n=v(49286),l=v(6647),p=v(99555),y=v(42432),ne=v(38305),Ce=v(13812),se=v(36255),G=v(79608),ee=v(23719),Z=v(86810),Le=v(128),be=v(48977),je=v(78451),he=v(39863);const B=(0,Y.c)(),Ae=(0,je.a)(),_e=(0,je.a)(),X=(0,je.a)(),De=(0,Y.f)(0,0,1),Fe=(0,Y.f)(0,1,0),qe=(0,Y.f)(1,0,0);function ae(e){(0,z.c)(B,e),(0,z.n)(B,B);const i=Math.atan2(B[1],B[0]),c=(0,be.s)((0,je.a)(),De,-i);(0,z.v)(B,B,c);const h=-1*Math.atan2(B[2],B[0]);return[(0,he.a)(i)+270,(0,he.a)(h)+90]}function ge(e,i){return(0,be.s)(_e,De,(0,he.t)(e-270)),(0,be.s)(X,Fe,(0,he.t)(i-90)),(0,be.m)(Ae,_e,X),(0,z.c)(B,qe),(0,z.v)(B,B,Ae),(0,z.n)(B,B),[B[0],B[1],B[2]]}var we=v(66656);let ie=class extends((0,G.J)(Z.wq)){constructor(e){super(e),this.enabled=!0,this.label="",this.normal=null,this.point=null}get orientation(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[e,i]=ae(this.normal);return ee.BV.normalize((0,T.q9)(e),0,!0)}set orientation(e){const i=ge(e,this.tilt);this._set("normal",i),this._set("orientation",e)}get tilt(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[e,i]=ae(this.normal);return ee.BV.normalize((0,T.q9)(i),0,!0)}set tilt(e){const i=ge(this.orientation,e);this._set("normal",i),this._set("tilt",e)}};(0,t._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],ie.prototype,"enabled",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],ie.prototype,"label",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,we.p)(e=>ee.BV.normalize((0,T.q9)(e),0,!0))],ie.prototype,"orientation",null),(0,t._)([(0,o.Cb)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,we.p)(e=>ee.BV.normalize((0,T.q9)(e),0,!0))],ie.prototype,"tilt",null),(0,t._)([(0,o.Cb)({type:[Number],json:{write:!0}})],ie.prototype,"normal",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:!0}})],ie.prototype,"point",void 0),ie=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelSlice")],ie);const ze=ie;var s=v(29840);let u=class extends((0,G.J)(Z.wq)){constructor(){super(...arguments),this.enabled=!0,this.href=null,this.id=null,this.label="",this.normal=null,this.point=null,this.sizeInPixel=null,this.slices=null,this.timeId=0,this.variableId=null}get orientation(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[e,i]=ae(this.normal);return ee.BV.normalize((0,T.q9)(e),0,!0)}get tilt(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[e,i]=ae(this.normal);return ee.BV.normalize((0,T.q9)(i),0,!0)}};(0,t._)([(0,o.Cb)({type:Boolean,json:{default:!0,write:!0}})],u.prototype,"enabled",void 0),(0,t._)([(0,o.Cb)({type:String,json:{origins:{service:{read:s.r}},write:{enabled:!0,isRequired:!0}}}),(0,Le.B)({origins:["web-scene"],type:"resource",prefix:"sections",compress:!0})],u.prototype,"href",void 0),(0,t._)([(0,o.Cb)({type:T.z8,json:{write:{enabled:!0,isRequired:!0}}})],u.prototype,"id",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,t._)([(0,o.Cb)({type:Number,clonable:!1,readOnly:!0,range:{min:0,max:360}})],u.prototype,"orientation",null),(0,t._)([(0,o.Cb)({type:Number,clonable:!1,readOnly:!0,range:{min:0,max:360}})],u.prototype,"tilt",null),(0,t._)([(0,o.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],u.prototype,"normal",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],u.prototype,"point",void 0),(0,t._)([(0,o.Cb)({type:[T.z8],json:{write:{enabled:!0,isRequired:!0}}})],u.prototype,"sizeInPixel",void 0),(0,t._)([(0,o.Cb)({type:[ze],json:{write:!0}})],u.prototype,"slices",void 0),(0,t._)([(0,o.Cb)({type:T.z8,json:{default:0,write:!0}})],u.prototype,"timeId",void 0),(0,t._)([(0,o.Cb)({type:T.z8,json:{write:{enabled:!0,isRequired:!0}}})],u.prototype,"variableId",void 0),u=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelSection")],u);const b=u;let d=class extends Z.wq{constructor(){super(...arguments),this.diffuseFactor=.5,this.specularFactor=.5}};(0,t._)([(0,o.Cb)({type:Number,range:{min:0,max:1},json:{default:.5,write:!0}})],d.prototype,"diffuseFactor",void 0),(0,t._)([(0,o.Cb)({type:Number,range:{min:0,max:1},json:{default:.5,write:!0}})],d.prototype,"specularFactor",void 0),d=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelSimpleShading")],d);const m=d;let f=class extends Z.wq{constructor(){super(...arguments),this.continuity=null,this.hasNoData=!1,this.noData=0,this.offset=0,this.scale=1,this.type=null}};(0,t._)([(0,o.Cb)({type:["discrete","continuous"],json:{write:!0}})],f.prototype,"continuity",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],f.prototype,"hasNoData",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],f.prototype,"noData",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],f.prototype,"offset",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],f.prototype,"scale",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],f.prototype,"type",void 0),f=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelFormat")],f);const j=f;let S=class extends Z.wq{constructor(){super(...arguments),this.id=null,this.description="",this.name=null,this.originalFormat=null,this.renderingFormat=null,this.unit="",this.volumeId=0,this.type=null}};(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],S.prototype,"id",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],S.prototype,"description",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],S.prototype,"name",void 0),(0,t._)([(0,o.Cb)({type:j,json:{write:!0}})],S.prototype,"originalFormat",void 0),(0,t._)([(0,o.Cb)({type:j,json:{write:{enabled:!0,isRequired:!0}}})],S.prototype,"renderingFormat",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],S.prototype,"unit",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],S.prototype,"volumeId",void 0),(0,t._)([(0,o.Cb)({type:["stc-hot-spot-results","stc-cluster-outlier-results","stc-estimated-bin","generic-nearest-interpolated"],json:{write:!0}})],S.prototype,"type",void 0),S=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelVariable")],S);const I=S;var P=v(58817),F=v(91558);let K=class extends((0,G.J)(Z.wq)){constructor(){super(...arguments),this.color=F.Z.fromArray([0,0,0,0]),this.value=0,this.enabled=!0,this.label="",this.colorLocked=!1}};(0,t._)([(0,o.Cb)({type:F.Z,json:{type:[T.z8],write:{enabled:!0,isRequired:!0}}})],K.prototype,"color",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],K.prototype,"value",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{default:!0,write:!0}})],K.prototype,"enabled",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],K.prototype,"label",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{default:!1,write:!0}})],K.prototype,"colorLocked",void 0),K=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelIsosurface")],K);const ue=K;var pe=v(89726),Q=v(21286);let le=class extends((0,G.J)(Z.wq)){constructor(){super(...arguments),this.color=null,this.position=0}};(0,t._)([(0,o.Cb)({type:F.Z,json:{type:[T.z8],write:{enabled:!0,isRequired:!0}}})],le.prototype,"color",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],le.prototype,"position",void 0),le=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelColorStop")],le);const me=le;let Ie=class extends((0,G.J)(Z.wq)){constructor(){super(...arguments),this.opacity=1,this.position=0}};(0,t._)([(0,o.Cb)({type:Number,json:{name:"alpha",write:{enabled:!0,isRequired:!0}}})],Ie.prototype,"opacity",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ie.prototype,"position",void 0),Ie=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelOpacityStop")],Ie);const Be=Ie;let Re=class extends((0,G.J)(Z.wq)){constructor(){super(...arguments),this.enabled=!1,this.range=null}};(0,t._)([(0,o.Cb)({type:Boolean,json:{default:!1,write:!0}})],Re.prototype,"enabled",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:!0}})],Re.prototype,"range",void 0),Re=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelRangeFilter")],Re);const tt=Re;var te,e;(e=te||(te={}))[e.Color=1]="Color",e[e.Alpha=2]="Alpha",e[e.Both=3]="Both";let ce=class extends((0,G.J)(Z.wq)){constructor(e){super(e),this.interpolation=null,this.stretchRange=null,this.rangeFilter=null,this._colorMapSize=256,this.colorStops=new(C.Z.ofType(me)),this.opacityStops=new(C.Z.ofType(Be))}set colorStops(e){this._set("colorStops",(0,pe.Z)(e,this._get("colorStops"),C.Z.ofType(me)))}set opacityStops(e){this._set("opacityStops",(0,pe.Z)(e,this._get("opacityStops"),C.Z.ofType(Be)))}getPreviousNext(e,i,c){let h=e;for(;--h>0&&i[h].type!==c&&i[h].type!==te.Both;);let g=e;const R=i.length;for(;++g<R&&i[g].type!==c&&i[g].type!==te.Both;);return[h,g]}get rasterizedTransferFunction(){const e=[];if(this.colorStops.length<2)return e;const i=[],c=[];for(const A of this.colorStops){if(!A.color)return e;c.push({color:{r:A.color.r,g:A.color.g,b:A.color.b,a:Math.round(255*(1-A.color.a))},position:A.position,type:te.Color})}if(0===this.opacityStops.length)for(const A of c)i.push({color:A.color,position:A.position});else{for(const N of this.opacityStops){const q=(0,Q.uZ)(N.position,0,1),E=Math.round(255*(0,Q.uZ)(1-N.opacity,0,1));let H=!1;for(const U of c)if(U.type===te.Color&&Math.abs(U.position-q)<1e-5){U.color.a=E,U.type=te.Both,H=!0;break}H||c.push({color:{r:0,g:0,b:0,a:E},position:N.position,type:te.Alpha})}c.sort((N,q)=>N.position<q.position?-1:1);const A=c.length;for(let N=0;N<A;++N){const q=c[N];if(q.type!==te.Both)if(q.type===te.Color){const[E,H]=this.getPreviousNext(N,c,te.Alpha);q.color.a=-1!==E&&H!==A?Math.round((0,Q.t7)(c[E].color.a,c[H].color.a,(q.position-c[E].position)/(c[H].position-c[E].position))):-1!==E?c[E].color.a:c[H].color.a}else{const[E,H]=this.getPreviousNext(N,c,te.Color);if(-1!==E&&H!==A){const U=(q.position-c[E].position)/(c[H].position-c[E].position),Te=c[E].color,pt=c[H].color;Ze.forEach(Ke=>{q.color[Ke]=Math.round((0,Q.t7)(Te[Ke],pt[Ke],U))})}else Ze.forEach(-1!==E?U=>{q.color[U]=c[E].color[U]}:U=>{q.color[U]=c[H].color[U]})}}for(const N of c)i.push({color:N.color,position:N.position})}i[0].position=0,i[i.length-1].position=1;let g=0,R=1;for(let A=0;A<this._colorMapSize;++A){const N=A/this._colorMapSize;for(;N>i[R].position;)g=R++;const q=(N-i[g].position)/(i[R].position-i[g].position),E=i[g].color,H=i[R].color,U=new F.Z;Ze.forEach(Te=>{U[Te]=Math.round((0,Q.t7)(E[Te],H[Te],q))}),U.a=(0,Q.uZ)(1-(0,Q.t7)(E.a,H.a,q)/255,0,1),e.push(U)}return e}getColorForContinuousDataValue(e,i){const c=this.rasterizedTransferFunction;if(this.colorStops.length<2||!Array.isArray(this.stretchRange)||this.stretchRange.length<2||c.length<256)return null;let h=this.stretchRange[0],g=this.stretchRange[1];if(h>g){const A=h;h=g,g=A}e=(0,Q.uZ)(e,h,g);const R=c[Math.round((e-h)/(g-h)*(this._colorMapSize-1))].clone();return i||(R.a=1),R}};(0,t._)([(0,o.Cb)({type:["linear","nearest"],json:{write:!0}})],ce.prototype,"interpolation",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],ce.prototype,"stretchRange",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(me),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.colorStops&&this.colorStops.length>0}}}}})],ce.prototype,"colorStops",null),(0,t._)([(0,o.Cb)({type:C.Z.ofType(Be),json:{read:{source:"alphaStops"},write:{enabled:!0,target:"alphaStops",overridePolicy(){return{enabled:!!this.opacityStops&&this.opacityStops.length>0}}}}})],ce.prototype,"opacityStops",null),(0,t._)([(0,o.Cb)({type:tt,json:{write:!0}})],ce.prototype,"rangeFilter",void 0),(0,t._)([(0,o.Cb)({type:[F.Z],clonable:!1,json:{read:!1}})],ce.prototype,"rasterizedTransferFunction",null),ce=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelTransferFunctionStyle")],ce);const ot=ce,Ze=["r","g","b"];let fe=class extends((0,G.J)(Z.wq)){constructor(){super(...arguments),this.color=F.Z.fromArray([0,0,0,0]),this.value=0,this.enabled=!0,this.label=""}};(0,t._)([(0,o.Cb)({type:F.Z,json:{type:[T.z8],write:{enabled:!0,isRequired:!0}}})],fe.prototype,"color",void 0),(0,t._)([(0,o.Cb)({type:T.z8,json:{write:{enabled:!0,isRequired:!0}}})],fe.prototype,"value",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{default:!0,write:!0}})],fe.prototype,"enabled",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],fe.prototype,"label",void 0),fe=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelUniqueValue")],fe);const He=fe;var Ee;let ve=Ee=class extends Z.wq{constructor(e){super(e),this.variableId=0,this.label="",this.transferFunction=null,this.uniqueValues=null,this.isosurfaces=null,this.uniqueValues=new(C.Z.ofType(He)),this.isosurfaces=new(C.Z.ofType(ue))}clone(){return new Ee({variableId:this.variableId,label:this.label,transferFunction:(0,P.d9)(this.transferFunction),uniqueValues:(0,P.d9)(this.uniqueValues),isosurfaces:(0,P.d9)(this.isosurfaces)})}};(0,t._)([(0,o.Cb)({type:T.z8,json:{write:{enabled:!0,isRequired:!0}}})],ve.prototype,"variableId",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],ve.prototype,"label",void 0),(0,t._)([(0,o.Cb)({type:ot,json:{write:{enabled:!0,overridePolicy(){return{enabled:!this.uniqueValues||this.uniqueValues.length<1}}}}})],ve.prototype,"transferFunction",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(He),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.uniqueValues&&this.uniqueValues.length>0}}}}})],ve.prototype,"uniqueValues",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(ue),json:{write:{enabled:!0,overridePolicy(){return{enabled:(!this.uniqueValues||this.uniqueValues.length<1)&&!!this.isosurfaces&&this.isosurfaces.length>0}}}}})],ve.prototype,"isosurfaces",void 0),ve=Ee=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelVariableStyle")],ve);const Ye=ve;var Oe=v(72642),$e=v(65234),it=v(37053);let Pe=class extends Z.wq{constructor(){super(...arguments),this.values=null}};(0,t._)([(0,o.Cb)({type:[Number],json:{write:!0}})],Pe.prototype,"values",void 0),Pe=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelIrregularSpacing")],Pe);const rt=Pe;let Me=class extends Z.wq{constructor(){super(...arguments),this.scale=1,this.offset=0}};(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],Me.prototype,"scale",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],Me.prototype,"offset",void 0),Me=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelRegularSpacing")],Me);const nt=Me;let k=class extends Z.wq{constructor(){super(...arguments),this.irregularSpacing=null,this.isPositiveUp=!0,this.isWrappedDateLine=!1,this.label=null,this.name=null,this.quantity=null,this.regularSpacing=null,this.size=0,this.unit=null}get isRegular(){return(null==this.irregularSpacing||void 0===this.irregularSpacing)&&null!==this.regularSpacing}getRange(){return this.isRegular?[this.regularSpacing.offset,this.regularSpacing.offset+this.regularSpacing.scale*(this.size-1)]:Array.isArray(this.irregularSpacing?.values)&&this.irregularSpacing.values.length>1?[this.irregularSpacing.values[0],this.irregularSpacing.values[this.irregularSpacing.values.length-1]]:[0,0]}};(0,t._)([(0,o.Cb)({type:rt,json:{write:!0}})],k.prototype,"irregularSpacing",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],k.prototype,"isPositiveUp",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],k.prototype,"isWrappedDateLine",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],k.prototype,"label",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],k.prototype,"name",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],k.prototype,"quantity",void 0),(0,t._)([(0,o.Cb)({type:nt,json:{write:!0}})],k.prototype,"regularSpacing",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:!0}})],k.prototype,"size",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],k.prototype,"unit",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{read:!1}})],k.prototype,"isRegular",null),k=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelDimension")],k);const st=k,Ge="esri.layers.voxel.VoxelVolume",Xe=W.Z.getLogger(Ge);let oe=class extends Z.wq{constructor(e){super(e),this.id=0,this.dimensions=null,this.spatialReference=$e.Z.WGS84}get zDimension(){if(!this.dimensions||!Array.isArray(this.dimensions)||4!==this.dimensions.length)return-1;for(let e=2;e<4;++e)if(this.dimensions[e].size>0)return e;return-1}get isValid(){return!(!this.dimensions||!Array.isArray(this.dimensions)||4!==this.dimensions.length||this.dimensions[0].size<1||this.dimensions[1].size<1||-1===this.zDimension||this.dimensions[this.zDimension].size<1)}get originInLayerSpace3D(){if(!this.isValid||"xyt"===this.volumeType)return[0,0,0];const e=this.dimensions[0].getRange(),i=this.dimensions[1].getRange(),c=this.dimensions[2],h=c.isRegular?c.getRange():[0,c.size];return[e[0],i[0],h[0]]}get voxelSizeInLayerSpaceSigned(){if(!this.isValid||"xyt"===this.volumeType)return[0,0,0];const e=this.dimensions[0].getRange(),i=this.dimensions[1].getRange(),c=this.dimensions[2],h=c.isRegular?c.getRange():[0,c.size],g=[this.sizeInVoxels[0],this.sizeInVoxels[1],this.sizeInVoxels[2]];for(let R=0;R<3;++R)g[R]<2?g[R]=1:g[R]-=1;return c.isRegular&&!c.isPositiveUp&&(g[2]*=-1),[(e[1]-e[0])/g[0],(i[1]-i[0])/g[1],(h[1]-h[0])/g[2]]}get volumeType(){if(this.isValid){const e=this.dimensions[2].size>0,i=this.dimensions[3].size>0;if(!e&&i)return"xyt";if(e&&i)return"xyzt"}return"xyz"}get sizeInVoxels(){return this.isValid?[this.dimensions[0].size,this.dimensions[1].size,this.dimensions[this.zDimension].size]:[0,0,0]}computeVoxelSpaceLocation(e){if(!this.isValid)return[0,0,0];if("xyt"===this.volumeType)return Xe.error("computeVoxelSpacePosition cannot be used with XYT volumes."),[0,0,0];if(!(0,it.fS)(this.spatialReference,e.spatialReference))return Xe.error("pos argument should have the same spatial reference as the VoxelLayer."),[0,0,0];const i=(0,Y.f)(e.x,e.y,e.z??0);(0,z.f)(i,i,this.originInLayerSpace3D),(0,z.B)(i,i,this.voxelSizeInLayerSpaceSigned);const c=this.dimensions[this.zDimension];if(!c.isRegular&&Array.isArray(c.irregularSpacing?.values)&&c.irregularSpacing.values.length>1){const h=e.z??0,g=c.irregularSpacing.values,R=c.isPositiveUp?1:-1,A=g.reduce((N,q)=>Math.abs(R*q-h)<Math.abs(R*N-h)?q:N);for(let N=0;N<g.length;++N)if(g[N]===A){i[2]=N;break}}return[i[0],i[1],i[2]]}computeLayerSpaceLocation(e){if(!this.isValid)return new Oe.Z({x:0,y:0,spatialReference:this.spatialReference});const i=(0,Y.e)(e);if((0,z.A)(i,i,this.voxelSizeInLayerSpaceSigned),(0,z.g)(i,i,this.originInLayerSpace3D),"xyt"===this.volumeType)return new Oe.Z({x:i[0],y:i[1],spatialReference:this.spatialReference});const c=this.dimensions[this.zDimension];return c.isRegular||Array.isArray(c.irregularSpacing?.values)&&(i[2]=e[2]<0?c.irregularSpacing.values[0]:e[2]<c.irregularSpacing.values.length?c.irregularSpacing.values[e[2]]:c.irregularSpacing.values[c.irregularSpacing.values.length-1],c.isPositiveUp||(i[2]*=-1)),new Oe.Z({x:i[0],y:i[1],z:i[2],spatialReference:this.spatialReference})}};(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],oe.prototype,"id",void 0),(0,t._)([(0,o.Cb)({type:[st],json:{write:{enabled:!0,isRequired:!0}}})],oe.prototype,"dimensions",void 0),(0,t._)([(0,o.Cb)({type:$e.Z,json:{read:{enabled:!1}}})],oe.prototype,"spatialReference",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{read:!1}})],oe.prototype,"zDimension",null),(0,t._)([(0,o.Cb)({type:[Boolean],json:{read:!1}})],oe.prototype,"isValid",null),(0,t._)([(0,o.Cb)({type:[Number],json:{read:!1}})],oe.prototype,"originInLayerSpace3D",null),(0,t._)([(0,o.Cb)({type:[Number],json:{read:!1}})],oe.prototype,"voxelSizeInLayerSpaceSigned",null),(0,t._)([(0,o.Cb)({type:["xyz","xyzt","xyt"],json:{read:{enabled:!1}}})],oe.prototype,"volumeType",null),(0,t._)([(0,o.Cb)({type:[Number],json:{read:!1}})],oe.prototype,"sizeInVoxels",null),oe=(0,t._)([(0,V.j)(Ge)],oe);const Qe=oe;var Ue;let Se=Ue=class extends Z.wq{constructor(){super(...arguments),this.apronWidth=1,this.brickSize=[32,32,32],this.maxLodLevel=0,this.nodeSize=[4,4,4]}isValid(){const e=new Ue;return e.apronWidth===this.apronWidth&&e.maxLodLevel===this.maxLodLevel&&!!this.brickSize&&!!this.nodeSize&&!(!Array.isArray(this.brickSize)||!Array.isArray(this.nodeSize))&&3===this.brickSize.length&&3===this.nodeSize.length&&32===this.brickSize[0]&&32===this.brickSize[1]&&32===this.brickSize[2]&&4===this.nodeSize[0]&&4===this.nodeSize[1]&&4===this.nodeSize[2]}};(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Se.prototype,"apronWidth",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Se.prototype,"brickSize",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Se.prototype,"maxLodLevel",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Se.prototype,"nodeSize",void 0),Se=Ue=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelVolumeIndex")],Se);const lt=Se;let ye=class extends((0,G.J)(Z.wq)){constructor(e){super(e),this.enabled=!0,this.label="",this.normal=null,this.point=null}get orientation(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[e,i]=ae(this.normal);return ee.BV.normalize((0,T.q9)(e),0,!0)}set orientation(e){const i=ge(e,this.tilt);this._set("normal",i),this._set("orientation",e)}get tilt(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[e,i]=ae(this.normal);return ee.BV.normalize((0,T.q9)(i),0,!0)}set tilt(e){const i=ge(this.orientation,e);this._set("normal",i),this._set("tilt",e)}};(0,t._)([(0,o.Cb)({type:Boolean,json:{default:!0,write:!0}})],ye.prototype,"enabled",void 0),(0,t._)([(0,o.Cb)({type:String,json:{write:!0}})],ye.prototype,"label",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,we.p)(e=>ee.BV.normalize((0,T.q9)(e),0,!0))],ye.prototype,"orientation",null),(0,t._)([(0,o.Cb)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,we.p)(e=>ee.BV.normalize((0,T.q9)(e),0,!0))],ye.prototype,"tilt",null),(0,t._)([(0,o.Cb)({type:[Number],json:{write:!0}})],ye.prototype,"normal",void 0),(0,t._)([(0,o.Cb)({type:[Number],json:{write:!0}})],ye.prototype,"point",void 0),ye=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelDynamicSection")],ye);const Je=ye;var We;let de=We=class extends Z.wq{constructor(e){super(e),this.volumeId=0,this.verticalExaggeration=1,this.exaggerationMode="scale-height",this.verticalOffset=0,this.slices=new(C.Z.ofType(ze)),this.dynamicSections=new(C.Z.ofType(Je))}set slices(e){this._set("slices",(0,pe.Z)(e,this._get("slices"),C.Z.ofType(ze)))}set dynamicSections(e){this._set("dynamicSections",(0,pe.Z)(e,this._get("dynamicSections"),C.Z.ofType(Je)))}clone(){return new We({volumeId:this.volumeId,verticalExaggeration:this.verticalExaggeration,exaggerationMode:this.exaggerationMode,verticalOffset:this.verticalOffset,slices:(0,P.d9)(this.slices),dynamicSections:(0,P.d9)(this.dynamicSections)})}};(0,t._)([(0,o.Cb)({type:T.z8,json:{write:{enabled:!0,isRequired:!0}}})],de.prototype,"volumeId",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{default:1,write:!0}})],de.prototype,"verticalExaggeration",void 0),(0,t._)([(0,o.Cb)({type:["scale-position","scale-height"],json:{default:"scale-height",write:!0}})],de.prototype,"exaggerationMode",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{default:0,write:!0}})],de.prototype,"verticalOffset",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(ze),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.slices&&this.slices.length>0}}}}})],de.prototype,"slices",null),(0,t._)([(0,o.Cb)({type:C.Z.ofType(Je),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.dynamicSections&&this.dynamicSections.length>0}}}}})],de.prototype,"dynamicSections",null),de=We=(0,t._)([(0,V.j)("esri.layers.voxel.VoxelVolumeStyle")],de);const ke=de;var at=v(49430);const et="esri.layers.VoxelLayer",xe=W.Z.getLogger(et);let w=class extends((0,y.Vt)((0,r.Y)((0,n.q)((0,l.I)((0,p.M)((0,M.R)((0,x.V)(a.Z)))))))){constructor(e){super(e),this.serviceRoot="",this.operationalLayerType="Voxel",this.legendEnabled=!0,this.title=null,this.sections=null,this.currentVariableId=0,this.volumeStyles=null,this.renderMode="volume",this.variableStyles=null,this.enableSlices=!0,this.enableSections=!0,this.enableDynamicSections=!0,this.enableIsosurfaces=!0,this.shading=new m,this.opacity=1,this.variables=new C.Z,this.volumes=new C.Z,this.index=null,this.minScale=0,this.maxScale=0,this.type="voxel",this.version={major:Number.NaN,minor:Number.NaN,versionString:""},this.fullExtent=null,this.popupEnabled=!1,this.test=null,this.volumeStyles=new(C.Z.ofType(ke)),this.variableStyles=new(C.Z.ofType(Ye)),this.sections=new(C.Z.ofType(b))}normalizeCtorArgs(e){return e?.constantUpscaling&&(this.test={constantUpscaling:!0},delete e.constantUpscaling),e}set url(e){this._set("url",(0,ne.Nm)(e,xe))}load(e){const i=null!=e?e.signal:null,c=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(O.r9).then(()=>this._fetchService(i)).then(()=>this.serviceRoot=this.url);return this.addResolvingPromise(c),Promise.resolve(this)}read(e,i){super.read(e,i);for(const c of this.volumes)c.spatialReference=this.spatialReference}readVersion(e,i){return super.parseVersionString(e)}validateLayer(e){if(e.layerType&&e.layerType!==this.operationalLayerType)throw new D.Z("voxel-layer:layer-type-not-supported","VoxelLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor)||this.version.major<3)throw new D.Z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"3.x"});if(this.version.major>3)throw new D.Z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"3.x"})}readFullExtent(e,i,c){if(null!=e&&"object"==typeof e){const h=Ve.Z.fromJSON(e,c);if(0===h.zmin&&0===h.zmax&&Array.isArray(i.volumes)){const g=Qe.fromJSON(i.volumes[0]);if(g.isValid&&"xyt"!==g.volumeType){const R=g.dimensions[2];if(R.isRegular){let A=R.regularSpacing.offset,N=R.regularSpacing.offset+R.regularSpacing.scale*(R.size-1);if(A>N){const q=A;A=N,N=q}h.zmin=A,h.zmax=N}}}return h}return null}get voxelFields(){const e=[new se.Z({name:"Voxel.ServiceValue",alias:"Value",domain:null,editable:!1,length:128,type:"string"}),new se.Z({name:"Voxel.ServiceVariableLabel",alias:"Variable",domain:null,editable:!1,length:128,type:"string"}),new se.Z({name:"Voxel.Position",alias:"Voxel Position",domain:null,editable:!1,length:128,type:"string"})],i=this.getVolume(null);if(null!=i){if("xyzt"===i.volumeType||"xyt"===i.volumeType){const c=new se.Z({name:"Voxel.ServiceLocalTime",alias:"Local Time",domain:null,editable:!1,length:128,type:"string"});e.push(c);const h=new se.Z({name:"Voxel.ServiceNativeTime",alias:"Native Time",domain:null,editable:!1,length:128,type:"string"});e.push(h)}if("xyt"!==i.volumeType){const c=new se.Z({name:"Voxel.ServiceDepth",alias:"Depth",domain:null,editable:!1,length:128,type:"string"});e.push(c)}}return e}get popupTemplate(){return this.loaded?this.createPopupTemplate():null}get defaultPopupTemplate(){return this.createPopupTemplate()}createPopupTemplate(e){return(0,at.eZ)({fields:this.voxelFields,title:this.title},e)}getConfiguration(){const e={layerType:this.operationalLayerType,version:this.version.versionString,name:this.title,spatialReference:this.spatialReference,fullExtent:this.fullExtent,volumes:this.volumes.toJSON(),variables:this.variables.toJSON(),index:this.index?.toJSON(),sections:this.getSections(),style:{volumeStyles:this.getVolumeStyles(),currentVariableId:this.currentVariableId,renderMode:this.renderMode,variableStyles:this.getVariableStyles(),enableSections:this.enableSections,enableDynamicSections:this.enableDynamicSections,enableIsosurfaces:this.enableIsosurfaces,enableSlices:this.enableSlices,shading:this.shading}};return e.index&&this.index?.isValid()?JSON.stringify(e):""}getVariableStyle(e){let i=-1;if(i=e??this.currentVariableId,!this.variableStyles||-1===i)return null;const c=this.variableStyles.findIndex(h=>h.variableId===i);return c<0?null:this.variableStyles.at(c)}getVariable(e){let i=-1;if(i=e??this.currentVariableId,!this.variables||-1===i)return null;const c=this.variables.findIndex(h=>h.id===i);return c<0?null:this.variables.at(c)}getVolume(e){const i=this.getVariable(e);return null!=i?this.volumes.find(({id:c})=>c===i.volumeId):null}getVolumeStyle(e){const i=this.getVariable(e);return null!=i?this.volumeStyles.find(({volumeId:c})=>c===i.volumeId):null}getColorForContinuousDataValue(e,i,c){const h=this.getVariable(e);if(null==h||"continuous"!==h.renderingFormat?.continuity||!this.variableStyles)return null;const g=this.variableStyles.findIndex(A=>A.variableId===e);if(g<0)return null;const R=this.variableStyles.at(g);return R?.transferFunction?R.transferFunction.getColorForContinuousDataValue(i,c):null}getSections(){const e=[];for(const i of this.sections)e.push(new b({enabled:i.enabled,href:i.href,id:i.id,label:i.label,normal:i.normal,point:i.point,sizeInPixel:i.sizeInPixel,slices:i.slices,timeId:i.timeId,variableId:i.variableId}));return e}getVariableStyles(){const e=[];for(const i of this.variableStyles){const c=this._getVariable(i);if(null!=c){const h=i.clone();h.isosurfaces.length>4&&(h.isosurfaces=h.isosurfaces.slice(0,3),xe.error("A maximum of 4 isosurfaces are supported for Voxel Layers."));for(const g of h.isosurfaces)if(!g.colorLocked){const R=this.getColorForContinuousDataValue(h.variableId,g.value,!1);null===R||R.equals(g.color)||(g.color=R)}if("continuous"===c.renderingFormat.continuity)(null===h.transferFunction||h.transferFunction.colorStops.length<2)&&xe.error(`VoxelVariableStyle for variable ${c.id} is invalid. At least 2 color stops are required in the transferFunction for continuous Voxel Layer variables.`),null!==h.transferFunction&&(Array.isArray(h.transferFunction.stretchRange)&&2===h.transferFunction.stretchRange.length||(xe.error(`VoxelVariableStyle for variable ${c.id} is invalid. The stretchRange of the transferFunction for continuous Voxel Layer variables must be of the form [minimumDataValue, maximumDataValue].`),h.transferFunction.stretchRange=[0,1],h.transferFunction.colorStops.removeAll()));else if("discrete"===c.renderingFormat.continuity)if(0===i.uniqueValues.length)xe.error(`VoxelVariableStyle for variable ${c.id} is invalid. Unique values are required for discrete Voxel Layer variables.`);else for(const g of i.uniqueValues)null!=g.label||null==g.value||(g.label=g.value.toString());e.push(h)}else xe.error(`VoxelVariable ID=${i.variableId} doesn't exist, VoxelVariableStyle for this VoxelVariable will be ignored.`)}return e}getVolumeStyles(){const e=[];for(const i of this.volumeStyles){const c=this._getVolumeFromVolumeId(i.volumeId);if(null!=c){const h=i.clone();for(const g of h.slices)this._isPlaneValid(g,[0,1,c.zDimension],c.dimensions)||(g.enabled=!1,g.label="invalid");for(const g of h.dynamicSections)this._isPlaneValid(g,[0,1,c.zDimension],c.dimensions)||(g.enabled=!1,g.label="invalid");e.push(h)}else xe.error(`VoxelVolume ID=${i.volumeId} doesn't exist, VoxelVolumeStyle for this VoxelVolume will be ignored.`)}return e}_getVariable(e){const i=e.variableId;for(const c of this.variables)if(c.id===i)return c;return null}_getVolumeFromVolumeId(e){for(const i of this.volumes)if(i.id===e)return i;return null}_isPlaneValid(e,i,c){if(!(e.point&&Array.isArray(e.point)&&3===e.point.length&&e.normal&&Array.isArray(e.normal)&&3===e.normal.length))return!1;const h=(0,Y.f)(e.normal[0],e.normal[1],e.normal[2]);return(0,z.n)(h,h),!(Math.abs(h[0])+Math.abs(h[1])+Math.abs(h[2])<1e-6||(e.normal[0]=h[0],e.normal[1]=h[1],e.normal[2]=h[2],0))}};(0,t._)([(0,o.Cb)({type:["Voxel"]})],w.prototype,"operationalLayerType",void 0),(0,t._)([(0,o.Cb)(Ce.rn)],w.prototype,"legendEnabled",void 0),(0,t._)([(0,o.Cb)({json:{write:!0}})],w.prototype,"title",void 0),(0,t._)([(0,o.Cb)(Ce.HQ)],w.prototype,"url",null),(0,t._)([(0,o.Cb)({type:C.Z.ofType(b),json:{origins:{"web-scene":{name:"layerDefinition.sections",write:!0}}}})],w.prototype,"sections",void 0),(0,t._)([(0,o.Cb)({type:T.z8,json:{origins:{"web-scene":{name:"layerDefinition.style.currentVariableId",write:{enabled:!0,isRequired:!0,ignoreOrigin:!0}},service:{name:"style.currentVariableId"}}}})],w.prototype,"currentVariableId",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(ke),json:{origins:{"web-scene":{name:"layerDefinition.style.volumeStyles",write:!0},service:{name:"style.volumeStyles"}}}})],w.prototype,"volumeStyles",void 0),(0,t._)([(0,o.Cb)({type:["volume","surfaces"],json:{origins:{"web-scene":{name:"layerDefinition.style.renderMode",write:!0},service:{name:"style.renderMode"}}}})],w.prototype,"renderMode",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(Ye),json:{origins:{"web-scene":{name:"layerDefinition.style.variableStyles",write:!0},service:{name:"style.variableStyles"}}}})],w.prototype,"variableStyles",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableSlices",write:!0},service:{name:"style.enableSlices"}}}})],w.prototype,"enableSlices",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableSections",write:!0},service:{name:"style.enableSections"}}}})],w.prototype,"enableSections",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableDynamicSections",write:!0},service:{name:"style.enableDynamicSections"}}}})],w.prototype,"enableDynamicSections",void 0),(0,t._)([(0,o.Cb)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableIsosurfaces",write:!0},service:{name:"style.enableIsosurfaces"}}}})],w.prototype,"enableIsosurfaces",void 0),(0,t._)([(0,o.Cb)({type:m,json:{origins:{"web-scene":{name:"layerDefinition.style.shading",write:!0},service:{name:"style.shading"}}}})],w.prototype,"shading",void 0),(0,t._)([(0,o.Cb)({type:["show","hide"]})],w.prototype,"listMode",void 0),(0,t._)([(0,o.Cb)({type:Number,range:{min:0,max:1},nonNullable:!0,json:{read:!1,write:!1,origins:{"web-scene":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],w.prototype,"opacity",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(I)})],w.prototype,"variables",void 0),(0,t._)([(0,o.Cb)({type:C.Z.ofType(Qe)})],w.prototype,"volumes",void 0),(0,t._)([(0,o.Cb)({type:lt})],w.prototype,"index",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{name:"layerDefinition.minScale",read:!1,write:!1,origins:{service:{read:!1,write:!1}}}})],w.prototype,"minScale",void 0),(0,t._)([(0,o.Cb)({type:Number,json:{name:"layerDefinition.maxScale",read:!1,write:!1,origins:{service:{read:!1,write:!1}}}})],w.prototype,"maxScale",void 0),(0,t._)([(0,o.Cb)({json:{read:!1},readOnly:!0})],w.prototype,"type",void 0),(0,t._)([(0,o.Cb)({readOnly:!0,json:{name:"serviceVersion"}})],w.prototype,"version",void 0),(0,t._)([(0,_.r)("service","version")],w.prototype,"readVersion",null),(0,t._)([(0,o.Cb)({type:Ve.Z})],w.prototype,"fullExtent",void 0),(0,t._)([(0,_.r)("service","fullExtent",["fullExtent"])],w.prototype,"readFullExtent",null),(0,t._)([(0,o.Cb)({readOnly:!0,clonable:!1,json:{read:!1}})],w.prototype,"voxelFields",null),(0,t._)([(0,o.Cb)({type:Boolean,json:{name:"disablePopup",read:{reader:(e,i)=>!i.disablePopup},write:{enabled:!0,ignoreOrigin:!0,writer(e,i,c){i[c]=!e}},origins:{"portal-item":{default:!0},"web-scene":{default:!0}}}})],w.prototype,"popupEnabled",void 0),(0,t._)([(0,o.Cb)({type:J.Z,json:{read:!1}})],w.prototype,"popupTemplate",null),(0,t._)([(0,o.Cb)({readOnly:!0})],w.prototype,"defaultPopupTemplate",null),w=(0,t._)([(0,V.j)(et)],w);const ut=w}}]);