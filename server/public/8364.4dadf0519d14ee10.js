"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[8364],{78260:(Lt,ct,O)=>{O.d(ct,{EX:()=>Q,Y3:()=>X,_Y:()=>G,sJ:()=>$,xr:()=>ht});var P=O(91558);function c(u){return"h"in u&&"s"in u&&"v"in u}function h(u){return"l"in u&&"a"in u&&"b"in u}function y(u){return"l"in u&&"c"in u&&"h"in u}O(993),O(4794);const L=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],D=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function N(u,_){const E=[];let T,R;if(u[0].length!==_.length)throw new Error("dimensions do not match");const k=u.length,C=u[0].length;let ot=0;for(T=0;T<k;T++){for(ot=0,R=0;R<C;R++)ot+=u[T][R]*_[R];E.push(ot)}return E}function B(u){const _=[u.r/255,u.g/255,u.b/255].map(T=>T<=.04045?T/12.92:((T+.055)/1.055)**2.4),E=N(L,_);return{x:100*E[0],y:100*E[1],z:100*E[2]}}function x(u){const _=N(D,[u.x/100,u.y/100,u.z/100]).map(E=>Math.min(1,Math.max(E<=.0031308?12.92*E:1.055*E**.4166666666666667-.055,0)));return{r:Math.round(255*_[0]),g:Math.round(255*_[1]),b:Math.round(255*_[2])}}function j(u){const _=[u.x/95.047,u.y/100,u.z/108.883].map(E=>E>.008856451679035631?E**.3333333333333333:7.787037037037035*E+.13793103448275862);return{l:116*_[1]-16,a:500*(_[0]-_[1]),b:200*(_[1]-_[2])}}function bt(u){const _=u.l,E=[(_+16)/116+u.a/500,(_+16)/116,(_+16)/116-u.b/200].map(T=>T>6/29?T**3:3*(6/29)**2*(T-4/29));return{x:95.047*E[0],y:100*E[1],z:108.883*E[2]}}function ht(u){return function w(u){return"r"in u&&"g"in u&&"b"in u}(u)?u:y(u)?function vt(u){return x(bt(function st(u){const E=u.c,T=u.h;return{l:u.l,a:E*Math.cos(T),b:E*Math.sin(T)}}(u)))}(u):h(u)?function F(u){return x(bt(u))}(u):function m(u){return"x"in u&&"y"in u&&"z"in u}(u)?x(u):c(u)?function Z(u){const _=(u.h+360)%360/60,T=u.v/100*255,R=T*(u.s/100),k=R*(1-Math.abs(_%2-1));let C;switch(Math.floor(_)){case 0:C={r:R,g:k,b:0};break;case 1:C={r:k,g:R,b:0};break;case 2:C={r:0,g:R,b:k};break;case 3:C={r:0,g:k,b:R};break;case 4:C={r:k,g:0,b:R};break;case 5:case 6:C={r:R,g:0,b:k};break;default:C={r:0,g:0,b:0}}return C.r=Math.round(C.r+T-R),C.g=Math.round(C.g+T-R),C.b=Math.round(C.b+T-R),C}(u):u}function G(u){return c(u)?u:function Ft(u){const _=u.r,E=u.g,T=u.b,R=Math.max(_,E,T),k=R-Math.min(_,E,T);let C=R,ot=0===k?0:R===_?(E-T)/k%6:R===E?(T-_)/k+2:(_-E)/k+4,wt=0===k?0:k/C;return ot<0&&(ot+=6),ot*=60,wt*=100,C*=100/255,{h:ot,s:wt,v:C}}(ht(u))}function X(u){return h(u)?u:function at(u){return j(B(u))}(ht(u))}function $(u){return y(u)?u:function ft(u){return function St(u){const _=u.l,E=u.a,T=u.b,R=Math.sqrt(E*E+T*T);let k=Math.atan2(T,E);return k=k>0?k:k+2*Math.PI,{l:_,c:R,h:k}}(j(B(u)))}(ht(u))}function Q(u,_){const{r:E,g:T,b:R}=_?.ignoreAlpha?u:function _t(u){let{r:_,g:E,b:T,a:R}=u;return R<1&&(_=Math.round(R*_+255*(1-R)),E=Math.round(R*E+255*(1-R)),T=Math.round(R*T+255*(1-R))),new P.Z({r:_,g:E,b:T})}(u);return.2126*E+.7152*T+.0722*R}var pt,u;(u=pt||(pt={}))[u.Low=160]="Low",u[u.High=225]="High"},36243:(Lt,ct,O)=>{O.d(ct,{Z:()=>P});class P{constructor(f){this._array=[],f<=0&&console.error("strideInBytes must be positive!"),this._stride=f}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(f,w){return 65535&f|w<<16}static i8888to32(f,w,c,h){return 255&f|(255&w)<<8|(255&c)<<16|h<<24}static i8816to32(f,w,c){return 255&f|(255&w)<<8|c<<16}}},919:(Lt,ct,O)=>{var P,H,f,w;O.d(ct,{Fr:()=>f,_K:()=>H,al:()=>P}),(w=P||(P={}))[w.FILL=1]="FILL",w[w.LINE=2]="LINE",w[w.SYMBOL=3]="SYMBOL",w[w.CIRCLE=4]="CIRCLE",function(w){w[w.BACKGROUND=0]="BACKGROUND",w[w.FILL=1]="FILL",w[w.OUTLINE=2]="OUTLINE",w[w.LINE=3]="LINE",w[w.ICON=4]="ICON",w[w.CIRCLE=5]="CIRCLE",w[w.TEXT=6]="TEXT",w[w.TILEINFO=7]="TILEINFO"}(H||(H={})),function(w){w[w.PAINTER_CHANGED=0]="PAINTER_CHANGED",w[w.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",w[w.LAYER_CHANGED=2]="LAYER_CHANGED",w[w.LAYER_REMOVED=3]="LAYER_REMOVED",w[w.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(f||(f={}))},77928:(Lt,ct,O)=>{O.d(ct,{Et:()=>Ee,sj:()=>ve,Le:()=>we,_L:()=>De,gf:()=>Ie,jG:()=>be,nj:()=>Te});var f,w,l,P=O(919),H=O(36243);(l=f||(f={}))[l.R8_SIGNED=0]="R8_SIGNED",l[l.R8_UNSIGNED=1]="R8_UNSIGNED",l[l.R16_SIGNED=2]="R16_SIGNED",l[l.R16_UNSIGNED=3]="R16_UNSIGNED",l[l.R8G8_SIGNED=4]="R8G8_SIGNED",l[l.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",l[l.R16G16_SIGNED=6]="R16G16_SIGNED",l[l.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",l[l.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",l[l.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",l[l.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",l[l.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",l[l.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN",function(l){l[l.UNIFORM=0]="UNIFORM",l[l.DATA_DRIVEN=1]="DATA_DRIVEN",l[l.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",l[l.UNUSED=3]="UNUSED"}(w||(w={}));var c=O(67969),h=O(40852);class y{constructor(e){this._locations=new Map,this._key=e}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(e,s,a,i,o){const d=this.getUniforms();for(const p of d){const{name:g,type:I,getValue:A}=p,v=A(a,s,i,o);if(null!==v)switch(I){case"float":e.setUniform1f(g,v);break;case"vec2":e.setUniform2fv(g,v);break;case"vec4":e.setUniform4fv(g,v)}}}encodeAttributes(e,s,a,i){const o=this.attributesInfo(),d=this.getEncodingInfos(),p=[];let g=0,I=0;for(const A of Object.keys(d)){const v=d[A],{type:S,precisionFactor:U,isLayout:lt}=o[A],It=lt?a.getLayoutProperty(A):a.getPaintProperty(A),ut=It.interpolator?.getInterpolationRange(s);let yt=0;for(const K of v){const{offset:M,bufferElementsToAdd:tt}=K;if(tt>0){for(let gt=0;gt<tt;gt++)p.push(0);g+=I,I=K.bufferElementsToAdd}const z=i??It.getValue(ut?ut[yt]:s,e);switch(S){case f.R8_SIGNED:case f.R8_UNSIGNED:p[g]|=this._encodeByte(z*(U||1),8*M);break;case f.R16_SIGNED:case f.R16_UNSIGNED:p[g]|=this._encodeShort(z*(U||1),8*M);break;case f.R8G8_SIGNED:case f.R8G8_UNSIGNED:p[g]|=this._encodeByte(z*(U||1),8*M),p[g]|=this._encodeByte(z*(U||1),8*M+8);break;case f.R16G16_SIGNED:case f.R16G16_UNSIGNED:p[g]|=this._encodeShort(z*(U||1),8*M),p[g]|=this._encodeShort(z*(U||1),8*M+16);break;case f.R8G8B8A8_SIGNED:case f.R8G8B8A8_UNSIGNED:p[g]|=this._encodeByte(z*(U||1),8*M),p[g]|=this._encodeByte(z*(U||1),8*M+8),p[g]|=this._encodeByte(z*(U||1),8*M+16),p[g]|=this._encodeByte(z*(U||1),8*M+24);break;case f.R8G8B8A8_COLOR:p[g]=this._encodeColor(z);break;case f.R16G16B16A16_DASHARRAY:case f.R16G16B16A16_PATTERN:this._encodePattern(g,p,z);break;default:throw new Error("Unsupported encoding type")}yt++}}return p}getAtributeState(e){let s=0;const a=3+2*e;return s|=this._bit(a),s|=this._bit(a+1)<<1,s}_buildAttributesInfo(){const e=[],s={},a={};let i=-1;const o=this.attributesInfo(),d=this.attributes();let p=-1;for(const v of d){p++;const S=this.getAtributeState(p);if(S===w.UNIFORM||S===w.UNUSED)continue;const U=o[v],lt=[];s[v]=lt;const It=U.type;for(let ut=0;ut<S;ut++){const{dataType:yt,bytesPerElement:K,count:M,normalized:tt}=y._encodingInfo[It],z=K*M,gt=`${yt}-${!0===tt}`;let J=a[gt],et=0;if(!J||J.count+M>4)i++,J={dataIndex:i,count:0,offset:0},4!==M&&(a[gt]=J),e.push({location:-1,name:"a_data_"+i,count:M,type:yt,normalized:tt}),et=Math.ceil(Math.max(z/4,1));else{const rt=e[J.dataIndex];rt.count+=M,et=Math.ceil(Math.max(rt.count*K/4,1))-Math.ceil(Math.max(J.offset/4,1))}lt.push({dataIndex:J.dataIndex,offset:J.offset,bufferElementsToAdd:et}),J.offset+=z,J.count+=M}}for(const v of e)switch(v.type){case c.g.BYTE:case c.g.UNSIGNED_BYTE:v.count=4;break;case c.g.SHORT:case c.g.UNSIGNED_SHORT:v.count+=v.count%2}this._buildVertexBufferLayout(e);let g=0;const I=this._layoutInfo.geometry;for(const v of I)this._locations.set(v.name,g++);const A=this._layoutInfo.opacity;if(A)for(const v of A)this._locations.set(v.name,g++);this._buildShaderInfo(e,s),this._propertyEncodingInfo=s}_buildVertexBufferLayout(e){const s={},a=this.geometryInfo();let i=a[0].stride;if(0===e.length)s.geometry=a;else{const o=[];let d=i;for(const p of e)i+=m(p.type)*p.count;for(const p of a)o.push(new h.G(p.name,p.count,p.type,p.offset,i,p.normalized));for(const p of e)o.push(new h.G(p.name,p.count,p.type,d,i,p.normalized)),d+=m(p.type)*p.count;s.geometry=o}this.opacityInfo()&&(s.opacity=this.opacityInfo()),this._layoutInfo=s,this._stride=i}_buildShaderInfo(e,s){let a="\n",i="\n";const o=[];for(const I of e)a+=`attribute ${this._getType(I.count)} ${I.name};\n`;const d=this.attributes(),p=this.attributesInfo();let g=-1;for(const I of d){g++;const{name:A,type:v,precisionFactor:S,isLayout:U}=p[I],lt=S&&1!==S?" * "+1/S:"",{bytesPerElement:It,count:ut}=y._encodingInfo[v],yt=K=>`a_data_${K.dataIndex}${L(ut,K.offset,It)}`;switch(this.getAtributeState(g)){case w.UNIFORM:{const K=this._getType(ut),M=`u_${A}`;o.push({name:M,type:K,getValue:(tt,z,gt,J)=>{const et=U?tt.getLayoutValue(I,z):tt.getPaintValue(I,z);if(v===f.R16G16B16A16_DASHARRAY){const rt=tt.getDashKey(et,tt.getLayoutValue("line-cap",z)),At=J.getMosaicItemPosition(rt,!1);if(null==At)return null;const{tl:Nt,br:he}=At;return[Nt[0],he[1],he[0],Nt[1]]}if(v===f.R16G16B16A16_PATTERN){const rt=J.getMosaicItemPosition(et,!I.includes("line-"));if(null==rt)return null;const{tl:At,br:Nt}=rt;return[At[0],Nt[1],Nt[0],At[1]]}if(v===f.R8G8B8A8_COLOR){const rt=et[3];return[rt*et[0],rt*et[1],rt*et[2],rt]}return et}}),a+=`uniform ${K} ${M};\n`,i+=`${K} ${A} = ${M};\n`}break;case w.DATA_DRIVEN:{const K=yt(s[I][0]);i+=`${this._getType(ut)} ${A} = ${K}${lt};\n`}break;case w.INTERPOLATED_DATA_DRIVEN:{const K=`u_t_${A}`;o.push({name:K,type:"float",getValue:(z,gt,J,et)=>(U?z.getLayoutProperty(I):z.getPaintProperty(I)).interpolator.interpolationUniformValue(J,gt)}),a+=`uniform float ${K};\n`;const M=yt(s[I][0]),tt=yt(s[I][1]);i+=`${this._getType(ut)} ${A} = mix(${M}${lt}, ${tt}${lt}, ${K});\n`}}}this._shaderHeader=a,this._shaderMain=i,this._uniforms=o}_bit(e){return(this._key&1<<e)>>e}_getType(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(e){const s=255*e[3];return H.Z.i8888to32(e[0]*s,e[1]*s,e[2]*s,s)}_encodePattern(e,s,a){if(!a?.rect)return;const o=a.rect,d=a.width,p=a.height;s[e]=this._encodeShort(o.x+2,0),s[e]|=this._encodeShort(o.y+2+p,16),s[e+1]=this._encodeShort(o.x+2+d,0),s[e+1]|=this._encodeShort(o.y+2,16)}_encodeByte(e,s){return(255&e)<<s}_encodeShort(e,s){return(65535&e)<<s}}y._encodingInfo={[f.R8_SIGNED]:{dataType:c.g.BYTE,bytesPerElement:1,count:1,normalized:!1},[f.R8_UNSIGNED]:{dataType:c.g.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[f.R16_SIGNED]:{dataType:c.g.SHORT,bytesPerElement:2,count:1,normalized:!1},[f.R16_UNSIGNED]:{dataType:c.g.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[f.R8G8_SIGNED]:{dataType:c.g.BYTE,bytesPerElement:1,count:2,normalized:!1},[f.R8G8_UNSIGNED]:{dataType:c.g.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[f.R16G16_SIGNED]:{dataType:c.g.SHORT,bytesPerElement:2,count:2,normalized:!1},[f.R16G16_UNSIGNED]:{dataType:c.g.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[f.R8G8B8A8_SIGNED]:{dataType:c.g.BYTE,bytesPerElement:1,count:4,normalized:!1},[f.R8G8B8A8_UNSIGNED]:{dataType:c.g.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[f.R8G8B8A8_COLOR]:{dataType:c.g.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[f.R16G16B16A16_DASHARRAY]:{dataType:c.g.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[f.R16G16B16A16_PATTERN]:{dataType:c.g.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const m=l=>{switch(l){case c.g.FLOAT:case c.g.INT:case c.g.UNSIGNED_INT:return 4;case c.g.SHORT:case c.g.UNSIGNED_SHORT:return 2;case c.g.BYTE:case c.g.UNSIGNED_BYTE:return 1}},L=(l,e,s)=>{const a=e/s;if(1===l)switch(a){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===l)switch(a){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===l)switch(a){case 0:return".xyz";case 1:return".yzw"}return""};class D extends y{constructor(e){super(e)}geometryInfo(){return D.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return D.ATTRIBUTES}attributesInfo(){return D.ATTRIBUTES_INFO}}D.ATTRIBUTES=[],D.GEOMETRY_LAYOUT=[new h.G("a_pos",2,c.g.BYTE,0,2)],D.ATTRIBUTES_INFO={};class N extends y{constructor(e){super(e)}geometryInfo(){return N.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return N.ATTRIBUTES}attributesInfo(){return N.ATTRIBUTES_INFO}}N.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],N.GEOMETRY_LAYOUT=[new h.G("a_pos",2,c.g.SHORT,0,4)],N.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:f.R8_UNSIGNED},"circle-color":{name:"color",type:f.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:f.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:f.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:f.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:f.R8_UNSIGNED,precisionFactor:32}};class B extends y{constructor(e){super(e)}geometryInfo(){return B.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return B.ATTRIBUTES}attributesInfo(){return B.ATTRIBUTES_INFO}}B.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],B.GEOMETRY_LAYOUT=[new h.G("a_pos",2,c.g.SHORT,0,4)],B.ATTRIBUTES_INFO={"fill-color":{name:"color",type:f.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:f.R16G16B16A16_PATTERN,isOptional:!0}};class x extends y{constructor(e,s){super(e),this._usefillColor=s}geometryInfo(){return x.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?x.ATTRIBUTES_FILL:x.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?x.ATTRIBUTES_INFO_FILL:x.ATTRIBUTES_INFO_OUTLINE}}x.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],x.ATTRIBUTES_FILL=["fill-color","fill-opacity"],x.GEOMETRY_LAYOUT=[new h.G("a_pos",2,c.g.SHORT,0,8),new h.G("a_offset",2,c.g.BYTE,4,8),new h.G("a_xnormal",2,c.g.BYTE,6,8)],x.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:f.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100}},x.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:f.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100}};class j extends y{constructor(e){super(e)}geometryInfo(){return j.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return j.ATTRIBUTES}attributesInfo(){return j.ATTRIBUTES_INFO}}j.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],j.GEOMETRY_LAYOUT=[new h.G("a_pos",2,c.g.SHORT,0,16),new h.G("a_extrude_offset",4,c.g.BYTE,4,16),new h.G("a_dir_normal",4,c.g.BYTE,8,16),new h.G("a_accumulatedDistance",2,c.g.UNSIGNED_SHORT,12,16)],j.ATTRIBUTES_INFO={"line-width":{name:"width",type:f.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:f.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:f.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:f.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:f.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:f.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:f.R16G16B16A16_DASHARRAY,isOptional:!0}};const bt=[new h.G("a_pos",2,c.g.SHORT,0,16),new h.G("a_vertexOffset",2,c.g.SHORT,4,16),new h.G("a_texAngleRange",4,c.g.UNSIGNED_BYTE,8,16),new h.G("a_levelInfo",4,c.g.UNSIGNED_BYTE,12,16)],St=[new h.G("a_opacityInfo",1,c.g.UNSIGNED_BYTE,0,1)];class st extends y{constructor(e){super(e)}geometryInfo(){return bt}opacityInfo(){return St}attributes(){return st.ATTRIBUTES}attributesInfo(){return st.ATTRIBUTES_INFO}}st.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],st.ATTRIBUTES_INFO={"icon-color":{name:"color",type:f.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:f.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:f.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:f.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:f.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};class at extends y{constructor(e){super(e)}geometryInfo(){return bt}opacityInfo(){return St}attributes(){return at.ATTRIBUTES}attributesInfo(){return at.ATTRIBUTES_INFO}}at.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],at.ATTRIBUTES_INFO={"text-color":{name:"color",type:f.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:f.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:f.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:f.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:f.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:f.R8_UNSIGNED,isLayout:!0}};var F=O(91558),ft=O(78260),vt=O(13160),Ft=O(78041),Z=O(86575);const ht={kind:"null"},G={kind:"number"},X={kind:"string"},$={kind:"boolean"},it={kind:"color"},_t={kind:"object"},Q={kind:"value"};function pt(l,e){return{kind:"array",itemType:l,n:e}}const oe=[ht,G,X,$,it,_t,pt(Q)];function dt(l){if("array"===l.kind){const e=dt(l.itemType);return"number"==typeof l.n?`array<${e}, ${l.n}>`:"value"===l.itemType.kind?"array":`array<${e}>`}return l.kind}function Dt(l){if(null===l)return ht;if("string"==typeof l)return X;if("boolean"==typeof l)return $;if("number"==typeof l)return G;if(l instanceof F.Z)return it;if(Array.isArray(l)){let e;for(const s of l){const a=Dt(s);if(e){if(e!==a){e=Q;break}}else e=a}return pt(e||Q,l.length)}return"object"==typeof l?_t:Q}function xt(l,e){if("array"===e.kind)return"array"===l.kind&&(0===l.n&&"value"===l.itemType.kind||xt(l.itemType,e.itemType))&&("number"!=typeof e.n||e.n===l.n);if("value"===e.kind)for(const s of oe)if(xt(l,s))return!0;return e.kind===l.kind}function Pt(l){if(null===l)return"";const e=typeof l;return"string"===e?l:"number"===e||"boolean"===e?String(l):l instanceof F.Z?l.toString():JSON.stringify(l)}class le{constructor(e){this._parent=e,this._vars={}}add(e,s){this._vars[e]=s}get(e){return this._vars[e]?this._vars[e]:this._parent?this._parent.get(e):null}}class Ut{constructor(){this.type=Q}static parse(e){if(e.length>1)throw new Error('"id" does not expect arguments');return new Ut}evaluate(e,s){return e?.id}}class Gt{constructor(){this.type=X}static parse(e){if(e.length>1)throw new Error('"geometry-type" does not expect arguments');return new Gt}evaluate(e,s){if(!e)return null;switch(e.type){case vt.Vl.Point:return"Point";case vt.Vl.LineString:return"LineString";case vt.Vl.Polygon:return"Polygon";default:return null}}}class Ot{constructor(){this.type=_t}static parse(e){if(e.length>1)throw new Error('"properties" does not expect arguments');return new Ot}evaluate(e,s){return e?.values}}class u{constructor(){this.type=G}static parse(e){if(e.length>1)throw new Error('"zoom" does not expect arguments');return new u}evaluate(e,s){return s}}class _{constructor(e,s,a){this._lhs=e,this._rhs=s,this._compare=a,this.type=$}static parse(e,s,a){if(3!==e.length&&4!==e.length)throw new Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw new Error(`"${e[0]}" collator not supported`);return new _(b(e[1],s),b(e[2],s),a)}evaluate(e,s){return this._compare(this._lhs.evaluate(e,s),this._rhs.evaluate(e,s))}}class wt{constructor(e){this._arg=e,this.type=$}static parse(e,s){if(2!==e.length)throw new Error('"!" expects 1 argument');return new wt(b(e[1],s))}evaluate(e,s){return!this._arg.evaluate(e,s)}}class Vt{constructor(e){this._args=e,this.type=$}static parse(e,s){const a=[];for(let i=1;i<e.length;i++)a.push(b(e[i],s));return new Vt(a)}evaluate(e,s){for(const a of this._args)if(!a.evaluate(e,s))return!1;return!0}}class $t{constructor(e){this._args=e,this.type=$}static parse(e,s){const a=[];for(let i=1;i<e.length;i++)a.push(b(e[i],s));return new $t(a)}evaluate(e,s){for(const a of this._args)if(a.evaluate(e,s))return!0;return!1}}class Yt{constructor(e){this._args=e,this.type=$}static parse(e,s){const a=[];for(let i=1;i<e.length;i++)a.push(b(e[i],s));return new Yt(a)}evaluate(e,s){for(const a of this._args)if(a.evaluate(e,s))return!1;return!0}}class Ht{constructor(e,s,a){this.type=e,this._args=s,this._fallback=a}static parse(e,s,a){if(e.length<4)throw new Error('"case" expects at least 3 arguments');if(e.length%2==1)throw new Error('"case" expects an odd number of arguments');let i;const o=[];for(let p=1;p<e.length-1;p+=2){const g=b(e[p],s),I=b(e[p+1],s,a);i||(i=I.type),o.push({condition:g,output:I})}const d=b(e[e.length-1],s,a);return i||(i=d.type),new Ht(i,o,d)}evaluate(e,s){for(const a of this._args)if(a.condition.evaluate(e,s))return a.output.evaluate(e,s);return this._fallback.evaluate(e,s)}}class jt{constructor(e,s){this.type=e,this._args=s}static parse(e,s){if(e.length<2)throw new Error('"coalesce" expects at least 1 argument');let a;const i=[];for(let o=1;o<e.length;o++){const d=b(e[o],s);a||(a=d.type),i.push(d)}return new jt(a,i)}evaluate(e,s){for(const a of this._args){const i=a.evaluate(e,s);if(null!==i)return i}return null}}class Kt{constructor(e,s,a,i,o){this.type=e,this._input=s,this._labels=a,this._outputs=i,this._fallback=o}static parse(e,s){if(e.length<3)throw new Error('"match" expects at least 3 arguments');if(e.length%2==0)throw new Error('"case" expects an even number of arguments');let a;const i=b(e[1],s),o=[],d={};let p;for(let g=2;g<e.length-1;g+=2){let I=e[g];Array.isArray(I)||(I=[I]);for(const v of I){const S=typeof v;if("string"!==S&&"number"!==S)throw new Error('"match" requires string or number literal as labels');if(p){if(S!==p)throw new Error('"match" requires labels to have the same type')}else p=S;d[v]=o.length}const A=b(e[g+1],s);a||(a=A.type),o.push(A)}return new Kt(a,i,d,o,b(e[e.length-1],s))}evaluate(e,s){const a=this._input.evaluate(e,s);return(this._outputs[this._labels[a]]||this._fallback).evaluate(e,s)}}class nt{constructor(e,s,a,i,o){this._operator=e,this.type=s,this.interpolation=a,this.input=i,this._stops=o}static parse(e,s,a){const i=e[0];if(e.length<5)throw new Error(`"${i}" expects at least 4 arguments`);const o=e[1];if(!Array.isArray(o)||0===o.length)throw new Error(`"${o}" is not a valid interpolation`);switch(o[0]){case"linear":if(1!==o.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==o.length||"number"!=typeof o[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==o.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let I=1;I<5;I++){const A=o[I];if("number"!=typeof A||A<0||A>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${e[0]}" unknown interpolation type "${o[0]}"`)}if(e.length%2!=1)throw new Error(`"${i}" expects an even number of arguments`);const d=b(e[2],s,G);let p;"interpolate-hcl"===i||"interpolate-lab"===i?p=it:a&&"value"!==a.kind&&(p=a);const g=[];for(let I=3;I<e.length;I+=2){const A=e[I];if("number"!=typeof A)throw new Error(`"${i}" requires stop inputs as literal numbers`);if(g.length&&g[g.length-1][0]>=A)throw new Error(`"${i}" requires strictly ascending stop inputs`);const v=b(e[I+1],s,p);p||(p=v.type),g.push([A,v])}if(p&&p!==it&&p!==G&&("array"!==p.kind||p.itemType!==G))throw new Error(`"${i}" cannot interpolate type ${dt(p)}`);return new nt(i,p,o,d,g)}evaluate(e,s){const a=this._stops;if(1===a.length)return a[0][1].evaluate(e,s);const i=this.input.evaluate(e,s);if(i<=a[0][0])return a[0][1].evaluate(e,s);if(i>=a[a.length-1][0])return a[a.length-1][1].evaluate(e,s);let o=0;for(;++o<a.length&&!(i<a[o][0]););const g=nt.interpolationRatio(this.interpolation,i,a[o-1][0],a[o][0]),I=a[o-1][1].evaluate(e,s),A=a[o][1].evaluate(e,s);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(I)&&Array.isArray(A))return I.map((v,S)=>(0,Z.sX)(v,A[S],g));if("color"===this.type.kind&&I instanceof F.Z&&A instanceof F.Z){const v=new F.Z(I),S=new F.Z(A);return new F.Z([(0,Z.sX)(v.r,S.r,g),(0,Z.sX)(v.g,S.g,g),(0,Z.sX)(v.b,S.b,g),(0,Z.sX)(v.a,S.a,g)])}if("number"===this.type.kind&&"number"==typeof I&&"number"==typeof A)return(0,Z.sX)(I,A,g);throw new Error(`"${this._operator}" cannot interpolate type ${dt(this.type)}`)}if("interpolate-hcl"===this._operator){const v=(0,ft.sJ)(I),S=(0,ft.sJ)(A),U=S.h-v.h,lt=(0,ft.xr)({h:v.h+g*(U>180||U<-180?U-360*Math.round(U/360):U),c:(0,Z.sX)(v.c,S.c,g),l:(0,Z.sX)(v.l,S.l,g)});return new F.Z({a:(0,Z.sX)(I.a,A.a,g),...lt})}if("interpolate-lab"===this._operator){const v=(0,ft.Y3)(I),S=(0,ft.Y3)(A),U=(0,ft.xr)({l:(0,Z.sX)(v.l,S.l,g),a:(0,Z.sX)(v.a,S.a,g),b:(0,Z.sX)(v.b,S.b,g)});return new F.Z({a:(0,Z.sX)(I.a,A.a,g),...U})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(e,s){const a=this._stops;if(1===a.length||e>=a[a.length-1][0])return 0;let i=0;for(;++i<a.length&&!(e<a[i][0]););return nt.interpolationRatio(this.interpolation,s,a[i-1][0],a[i][0])}getInterpolationRange(e){const s=this._stops;if(1===s.length){const o=s[0][0];return[o,o]}const a=s[s.length-1][0];if(e>=a)return[a,a];let i=0;for(;++i<s.length&&!(e<s[i][0]););return[s[i-1][0],s[i][0]]}static interpolationRatio(e,s,a,i){let o=0;return"linear"===e[0]?o=nt._exponentialInterpolationRatio(s,1,a,i):"exponential"===e[0]?o=nt._exponentialInterpolationRatio(s,e[1],a,i):"cubic-bezier"===e[0]&&(o=(0,Ft.n_)(e[1],e[2],e[3],e[4])(nt._exponentialInterpolationRatio(s,1,a,i),1e-5)),o<0?o=0:o>1&&(o=1),o}static _exponentialInterpolationRatio(e,s,a,i){const o=i-a;if(0===o)return 0;const d=e-a;return 1===s?d/o:(s**d-1)/(s**o-1)}}class Zt{constructor(e,s,a){this.type=e,this._input=s,this._stops=a}static parse(e,s){if(e.length<5)throw new Error('"step" expects at least 4 arguments');if(e.length%2!=1)throw new Error('"step" expects an even number of arguments');const a=b(e[1],s,G);let i;const o=[];o.push([-1/0,b(e[2],s)]);for(let d=3;d<e.length;d+=2){const p=e[d];if("number"!=typeof p)throw new Error('"step" requires stop inputs as literal numbers');if(o.length&&o[o.length-1][0]>=p)throw new Error('"step" requires strictly ascending stop inputs');const g=b(e[d+1],s);i||(i=g.type),o.push([p,g])}return new Zt(i,a,o)}evaluate(e,s){const a=this._stops;if(1===a.length)return a[0][1].evaluate(e,s);const i=this._input.evaluate(e,s);let o=0;for(;++o<a.length&&!(i<a[o][0]););return this._stops[o-1][1].evaluate(e,s)}}class Xt{constructor(e,s){this.type=e,this._output=s}static parse(e,s,a){if(e.length<4)throw new Error('"let" expects at least 3 arguments');if(e.length%2==1)throw new Error('"let" expects an odd number of arguments');const i=new le(s);for(let d=1;d<e.length-1;d+=2){const p=e[d];if("string"!=typeof p)throw new Error(`"let" requires a string to define variable names - found ${p}`);i.add(p,b(e[d+1],s))}const o=b(e[e.length-1],i,a);return new Xt(o.type,o)}evaluate(e,s){return this._output.evaluate(e,s)}}class Wt{constructor(e,s){this.type=e,this.output=s}static parse(e,s,a){if(2!==e.length||"string"!=typeof e[1])throw new Error('"var" requires just one literal string argument');const i=s.get(e[1]);if(!i)throw new Error(`${e[1]} must be defined before being used in a "var" expression`);return new Wt(a||Q,i)}evaluate(e,s){return this.output.evaluate(e,s)}}class Jt{constructor(e,s,a){this.type=e,this._index=s,this._array=a}static parse(e,s){if(3!==e.length)throw new Error('"at" expects 2 arguments');const a=b(e[1],s,G),i=b(e[2],s);return new Jt(i.type.itemType,a,i)}evaluate(e,s){const a=this._index.evaluate(e,s),i=this._array.evaluate(e,s);if(a<0||a>=i.length)throw new Error('"at" index out of bounds');if(a!==Math.floor(a))throw new Error('"at" index must be an integer');return i[a]}}class Bt{constructor(e,s){this._key=e,this._obj=s,this.type=Q}static parse(e,s){let a,i;switch(e.length){case 2:return a=b(e[1],s),new Bt(a);case 3:return a=b(e[1],s),i=b(e[2],s),new Bt(a,i);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(e,s){const a=this._key.evaluate(e,s);return this._obj?this._obj.evaluate(e,s)[a]:e?.values[a]}}class kt{constructor(e,s){this._key=e,this._obj=s,this.type=$}static parse(e,s){let a,i;switch(e.length){case 2:return a=b(e[1],s),new kt(a);case 3:return a=b(e[1],s),i=b(e[2],s),new kt(a,i);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(e,s){const a=this._key.evaluate(e,s);return this._obj?a in this._obj.evaluate(e,s):!!e?.values[a]}}class qt{constructor(e,s){this._key=e,this._vals=s,this.type=$}static parse(e,s){if(3!==e.length)throw new Error('"in" expects 2 arguments');return new qt(b(e[1],s),b(e[2],s))}evaluate(e,s){const a=this._key.evaluate(e,s);return this._vals.evaluate(e,s).includes(a)}}class Mt{constructor(e,s,a){this._item=e,this._array=s,this._from=a,this.type=G}static parse(e,s){if(e.length<3||e.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const a=b(e[1],s),i=b(e[2],s);if(4===e.length){const o=b(e[3],s,G);return new Mt(a,i,o)}return new Mt(a,i)}evaluate(e,s){const a=this._item.evaluate(e,s),i=this._array.evaluate(e,s);if(this._from){const o=this._from.evaluate(e,s);if(o!==Math.floor(o))throw new Error('"index-of" index must be an integer');return i.indexOf(a,o)}return i.indexOf(a)}}class Qt{constructor(e){this._arg=e,this.type=G}static parse(e,s){if(2!==e.length)throw new Error('"length" expects 2 arguments');const a=b(e[1],s);return new Qt(a)}evaluate(e,s){const a=this._arg.evaluate(e,s);if("string"==typeof a||Array.isArray(a))return a.length;throw new Error('"length" expects string or array')}}class Ct{constructor(e,s,a,i){this.type=e,this._array=s,this._from=a,this._to=i}static parse(e,s){if(e.length<3||e.length>4)throw new Error('"slice" expects 2 or 3 arguments');const a=b(e[1],s),i=b(e[2],s,G);if(i.type!==G)throw new Error('"slice" index must return a number');if(4===e.length){const o=b(e[3],s,G);if(o.type!==G)throw new Error('"slice" index must return a number');return new Ct(a.type,a,i,o)}return new Ct(a.type,a,i)}evaluate(e,s){const a=this._array.evaluate(e,s);if(!Array.isArray(a)&&"string"!=typeof a)throw new Error('"slice" input must be an array or a string');const i=this._from.evaluate(e,s);if(i<0||i>=a.length)throw new Error('"slice" index out of bounds');if(i!==Math.floor(i))throw new Error('"slice" index must be an integer');if(this._to){const o=this._to.evaluate(e,s);if(o<0||o>=a.length)throw new Error('"slice" index out of bounds');if(o!==Math.floor(o))throw new Error('"slice" index must be an integer');return a.slice(i,o)}return a.slice(i)}}class te{constructor(){this.type=$}static parse(e){if(1!==e.length)throw new Error('"has-id" expects no arguments');return new te}evaluate(e,s){return void 0!==e?.id}}class W{constructor(e,s){this._args=e,this._calculate=s,this.type=G}static parse(e,s,a){const i=e.slice(1).map(o=>b(o,s));return new W(i,a)}evaluate(e,s){let a;return this._args&&(a=this._args.map(i=>i.evaluate(e,s))),this._calculate(a)}}let Y=(()=>{class l{constructor(s,a){this._args=s,this._calculate=a,this.type=G}static parse(s,a){const i=s.slice(1).map(o=>b(o,a));return new l(i,l.ops[s[0]])}evaluate(s,a){let i;return this._args&&(i=this._args.map(o=>o.evaluate(s,a))),this._calculate(i)}}return l.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])},l})();class ee{constructor(e){this._args=e,this.type=X}static parse(e,s){return new ee(e.slice(1).map(a=>b(a,s)))}evaluate(e,s){return this._args.map(a=>a.evaluate(e,s)).join("")}}let ue=(()=>{class l{constructor(s,a){this._arg=s,this._calculate=a,this.type=X}static parse(s,a){if(2!==s.length)throw new Error(`${s[0]} expects 1 argument`);const i=b(s[1],a);return new l(i,l.ops[s[0]])}evaluate(s,a){return this._calculate(this._arg.evaluate(s,a))}}return l.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()},l})();class re{constructor(e){this._args=e,this.type=it}static parse(e,s){if(4!==e.length)throw new Error('"rgb" expects 3 arguments');const a=e.slice(1).map(i=>b(i,s));return new re(a)}evaluate(e,s){const a=this._validate(this._args[0].evaluate(e,s)),i=this._validate(this._args[1].evaluate(e,s)),o=this._validate(this._args[2].evaluate(e,s));return new F.Z({r:a,g:i,b:o})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}}class ne{constructor(e){this._args=e,this.type=it}static parse(e,s){if(5!==e.length)throw new Error('"rgba" expects 4 arguments');const a=e.slice(1).map(i=>b(i,s));return new ne(a)}evaluate(e,s){const a=this._validate(this._args[0].evaluate(e,s)),i=this._validate(this._args[1].evaluate(e,s)),o=this._validate(this._args[2].evaluate(e,s)),d=this._validateAlpha(this._args[3].evaluate(e,s));return new F.Z({r:a,g:i,b:o,a:d})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}_validateAlpha(e){if("number"!=typeof e||e<0||e>1)throw new Error(`${e}: invalid alpha color component`);return e}}class se{constructor(e){this._color=e,this.type=pt(G,4)}static parse(e,s){if(2!==e.length)throw new Error('"to-rgba" expects 1 argument');const a=b(e[1],s);return new se(a)}evaluate(e,s){return new F.Z(this._color.evaluate(e,s)).toRgba()}}class mt{constructor(e,s){this.type=e,this._args=s}static parse(e,s){const a=e[0];if(e.length<2)throw new Error(`${a} expects at least one argument`);let i,o=1;if("array"===a){if(e.length>2){switch(e[1]){case"string":i=X;break;case"number":i=G;break;case"boolean":i=$;break;default:throw new Error('"array" type argument must be string, number or boolean')}o++}else i=Q;let p;if(e.length>3){if(p=e[2],null!==p&&("number"!=typeof p||p<0||p!==Math.floor(p)))throw new Error('"array" length argument must be a positive integer literal');o++}i=pt(i,p)}else switch(a){case"string":i=X;break;case"number":i=G;break;case"boolean":i=$;break;case"object":i=_t}const d=[];for(;o<e.length;o++){const p=b(e[o],s);d.push(p)}return new mt(i,d)}evaluate(e,s){let a;for(const i of this._args){const o=i.evaluate(e,s);if(a=Dt(o),xt(a,this.type))return o}throw new Error(`Expected ${dt(this.type)} but got ${dt(a)}`)}}let Et=(()=>{class l{constructor(s,a){this.type=s,this._args=a}static parse(s,a){const i=s[0],o=l.types[i];if(o===$||o===X){if(2!==s.length)throw new Error(`${i} expects one argument`)}else if(s.length<2)throw new Error(`${i} expects at least one argument`);const d=[];for(let p=1;p<s.length;p++){const g=b(s[p],a);d.push(g)}return new l(o,d)}evaluate(s,a){if(this.type===$)return Boolean(this._args[0].evaluate(s,a));if(this.type===X)return Pt(this._args[0].evaluate(s,a));if(this.type===G){for(const i of this._args){const o=Number(i.evaluate(s,a));if(!isNaN(o))return o}return null}if(this.type===it){for(const i of this._args)try{const o=l.toColor(i.evaluate(s,a));if(o instanceof F.Z)return o}catch{}return null}}static toBoolean(s){return Boolean(s)}static toString(s){return Pt(s)}static toNumber(s){const a=Number(s);if(isNaN(a))throw new Error(`"${s}" is not a number`);return a}static toColor(s){if(s instanceof F.Z)return s;if("string"==typeof s){const a=F.Z.fromString(s);if(a)return a;throw new Error(`"${s}" is not a color`)}if(Array.isArray(s))return F.Z.fromArray(s);throw new Error(`"${s}" is not a color`)}}return l.types={"to-boolean":$,"to-color":it,"to-number":G,"to-string":X},l})();class ae{constructor(e){this._val=e,this.type=Dt(e)}static parse(e){if(2!==e.length)throw new Error('"literal" expects 1 argument');return new ae(e[1])}evaluate(e,s){return this._val}}class ie{constructor(e){this._arg=e,this.type=X}static parse(e,s){if(2!==e.length)throw new Error('"typeof" expects 1 argument');return new ie(b(e[1],s))}evaluate(e,s){return dt(Dt(this._arg.evaluate(e,s)))}}function b(l,e,s){const a=typeof l;if("string"===a||"boolean"===a||"number"===a||null===l){if(s)switch(s.kind){case"string":"string"!==a&&(l=Et.toString(l));break;case"number":"number"!==a&&(l=Et.toNumber(l));break;case"color":l=Et.toColor(l)}l=["literal",l]}if(!Array.isArray(l)||0===l.length)throw new Error("Expression must be a non empty array");const i=l[0];if("string"!=typeof i)throw new Error("First element of expression must be a string");const o=ce[i];if(void 0===o)throw new Error(`Invalid expression operator "${i}"`);if(!o)throw new Error(`Unimplemented expression operator "${i}"`);return o.parse(l,e,s)}const ce={array:mt,boolean:mt,collator:null,format:null,image:null,literal:ae,number:mt,"number-format":null,object:mt,string:mt,"to-boolean":Et,"to-color":Et,"to-number":Et,"to-string":Et,typeof:ie,accumulated:null,"feature-state":null,"geometry-type":Gt,id:Ut,"line-progress":null,properties:Ot,at:Jt,get:Bt,has:kt,in:qt,"index-of":Mt,length:Qt,slice:Ct,"!":wt,"!=":class T extends _{static parse(e,s){return _.parse(e,s,(a,i)=>a!==i)}},"<":class R extends _{static parse(e,s){return _.parse(e,s,(a,i)=>a<i)}},"<=":class k extends _{static parse(e,s){return _.parse(e,s,(a,i)=>a<=i)}},"==":class E extends _{static parse(e,s){return _.parse(e,s,(a,i)=>a===i)}},">":class C extends _{static parse(e,s){return _.parse(e,s,(a,i)=>a>i)}},">=":class ot extends _{static parse(e,s){return _.parse(e,s,(a,i)=>a>=i)}},all:Vt,any:$t,case:Ht,coalesce:jt,match:Kt,within:null,interpolate:nt,"interpolate-hcl":nt,"interpolate-lab":nt,step:Zt,let:Xt,var:Wt,concat:ee,downcase:ue,"is-supported-script":null,"resolved-locale":null,upcase:ue,rgb:re,rgba:ne,"to-rgba":se,"-":class pe extends W{static parse(e,s){switch(e.length){case 2:return W.parse(e,s,a=>-a[0]);case 3:return W.parse(e,s,a=>a[0]-a[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},"*":class ye extends W{static parse(e,s){return W.parse(e,s,a=>{let i=1;for(const o of a)i*=o;return i})}},"/":class fe extends W{static parse(e,s){if(3===e.length)return W.parse(e,s,a=>a[0]/a[1]);throw new Error('"/" expects 2 arguments')}},"%":class ge extends W{static parse(e,s){if(3===e.length)return W.parse(e,s,a=>a[0]%a[1]);throw new Error('"%" expects 2 arguments')}},"^":class _e extends W{static parse(e,s){if(3===e.length)return W.parse(e,s,a=>a[0]**a[1]);throw new Error('"^" expects 1 or 2 arguments')}},"+":class de extends W{static parse(e,s){return W.parse(e,s,a=>{let i=0;for(const o of a)i+=o;return i})}},abs:Y,acos:Y,asin:Y,atan:Y,ceil:Y,cos:Y,e:Y,floor:Y,ln:Y,ln2:Y,log10:Y,log2:Y,max:Y,min:Y,pi:Y,round:Y,sin:Y,sqrt:Y,tan:Y,zoom:u,"heatmap-density":null,"has-id":te,none:Yt};class q{constructor(e){this._expression=e}filter(e,s){if(!this._expression)return!0;try{return this._expression.evaluate(e,s)}catch(a){return console.log(a.message),!0}}static createFilter(e){if(!e)return null;this.isLegacyFilter(e)&&(e=this.convertLegacyFilter(e));try{const s=b(e,null,$);return new q(s)}catch(s){return console.log(s.message),null}}static isLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let s=1;s<e.length;s++)if(this.isLegacyFilter(e[s]))return!0;return!1;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);default:return!1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;const s=e[0];if(1===e.length)return"any"!==s;switch(s){case"==":return q.convertComparison("==",e[1],e[2]);case"!=":return q.negate(q.convertComparison("==",e[1],e[2]));case">":case"<":case">=":case"<=":return q.convertComparison(s,e[1],e[2]);case"in":return q.convertIn(e[1],e.slice(2));case"!in":return q.negate(q.convertIn(e[1],e.slice(2)));case"any":case"all":case"none":return q.convertCombining(s,e.slice(1));case"has":return q.convertHas(e[1]);case"!has":return q.negate(q.convertHas(e[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(e,s,a){switch(s){case"$type":return[e,["geometry-type"],a];case"$id":return[e,["id"],a];default:return[e,["get",s],a]}}static convertIn(e,s){switch(e){case"$type":return["in",["geometry-type"],["literal",s]];case"$id":return["in",["id"],["literal",s]];default:return["in",["get",e],["literal",s]]}}static convertHas(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}static convertCombining(e,s){return[e].concat(s.map(this.convertLegacyFilter))}static negate(e){return["!",e]}}var V=O(1268);class zt{constructor(e,s){let a;switch(this.isDataDriven=!1,this.interpolator=null,e.type){case"number":case"color":a=!0;break;case"array":a="number"===e.value;break;default:a=!1}if(null==s&&(s=e.default),Array.isArray(s)&&s.length>0&&ce[s[0]]){const o={number:G,color:it,string:X,boolean:$,enum:X};try{const p=b(s,null,"array"===e.type?pt(o[e.value]||Q,e.length):o[e.type]);this.getValue=this._buildExpression(p,e),this.isDataDriven=!0,p instanceof nt&&p.input instanceof u&&(this.interpolator=p)}catch(d){console.log(d.message),this.getValue=this._buildSimple(e.default)}return}a&&"interval"===s.type&&(a=!1);const i=s?.stops&&s.stops.length>0;if(i)for(const o of s.stops)o[1]=this._validate(o[1],e);if(this.isDataDriven=!!s&&!!s.property,this.isDataDriven)if(void 0!==s.default&&(s.default=this._validate(s.default,e)),i)switch(s.type){case"identity":this.getValue=this._buildIdentity(s,e);break;case"categorical":this.getValue=this._buildCategorical(s,e);break;default:this.getValue=a?this._buildInterpolate(s,e):this._buildInterval(s,e)}else this.getValue=this._buildIdentity(s,e);else i?this.getValue=a?this._buildZoomInterpolate(s):this._buildZoomInterval(s):(s=this._validate(s,e),this.getValue=this._buildSimple(s))}_validate(e,s){if("number"===s.type){if(null!=s.minimum&&e<s.minimum)return s.minimum;if(null!=s.maximum&&e>s.maximum)return s.maximum}else"color"===s.type?e=zt._parseColor(e):"enum"===s.type?"string"==typeof e&&(e=s.values.indexOf(e)):"array"===s.type&&"enum"===s.value?e=e.map(a=>"string"==typeof a?s.values.indexOf(a):a):"string"===s.type&&(e=Pt(e));return e}_buildSimple(e){return()=>e}_buildExpression(e,s){return(a,i)=>{try{const o=e.evaluate(i,a);return void 0===o?s.default:this._validate(o,s)}catch(o){return console.log(o.message),s.default}}}_buildIdentity(e,s){return(a,i)=>{let o;return i&&(o=i.values[e.property]),void 0!==o&&(o=this._validate(o,s)),o??(void 0!==e.default?e.default:s.default)}}_buildCategorical(e,s){return(a,i)=>{let o;return i&&(o=i.values[e.property]),o=this._categorical(o,e.stops),void 0!==o?o:void 0!==e.default?e.default:s.default}}_buildInterval(e,s){return(a,i)=>{let o;return i&&(o=i.values[e.property]),"number"==typeof o?this._interval(o,e.stops):void 0!==e.default?e.default:s.default}}_buildInterpolate(e,s){return(a,i)=>{let o;return i&&(o=i.values[e.property]),"number"==typeof o?this._interpolate(o,e.stops,e.base||1):void 0!==e.default?e.default:s.default}}_buildZoomInterpolate(e){return s=>this._interpolate(s,e.stops,e.base||1)}_buildZoomInterval(e){return s=>this._interval(s,e.stops)}_categorical(e,s){const a=s.length;for(let i=0;i<a;i++)if(s[i][0]===e)return s[i][1]}_interval(e,s){const a=s.length;let i=0;for(let o=0;o<a&&s[o][0]<=e;o++)i=o;return s[i][1]}_interpolate(e,s,a){let i,o;const d=s.length;for(let p=0;p<d;p++){const g=s[p];if(!(g[0]<=e)){o=g;break}i=g}if(i&&o){const p=o[0]-i[0],g=e-i[0],I=1===a?g/p:(a**g-1)/(a**p-1);if(Array.isArray(i[1])){const A=i[1],v=o[1],S=[];for(let U=0;U<A.length;U++)S.push((0,Z.sX)(A[U],v[U],I));return S}return(0,Z.sX)(i[1],o[1],I)}return i?i[1]:o?o[1]:void 0}static _isEmpty(e){for(const s in e)if(e.hasOwnProperty(s))return!1;return!0}static _parseColor(e){return Array.isArray(e)?e:("string"==typeof e&&(e=new F.Z(e)),e instanceof F.Z&&!this._isEmpty(e)?F.Z.toUnitRGBA(e):void 0)}}var Tt,me=O(39351);!function(l){l[l.BUTT=0]="BUTT",l[l.ROUND=1]="ROUND",l[l.SQUARE=2]="SQUARE",l[l.UNKNOWN=4]="UNKNOWN"}(Tt||(Tt={}));class Rt{constructor(e,s,a,i){switch(this.type=e,this.typeName=s.type,this.id=s.id,this.source=s.source,this.sourceLayer=s["source-layer"],this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,this.filter=s.filter,this.layout=s.layout,this.paint=s.paint,this.z=a,this.uid=i,e){case V.fR.BACKGROUND:this._layoutDefinition=V.f2.backgroundLayoutDefinition,this._paintDefinition=V.f2.backgroundPaintDefinition;break;case V.fR.FILL:this._layoutDefinition=V.f2.fillLayoutDefinition,this._paintDefinition=V.f2.fillPaintDefinition;break;case V.fR.LINE:this._layoutDefinition=V.f2.lineLayoutDefinition,this._paintDefinition=V.f2.linePaintDefinition;break;case V.fR.SYMBOL:this._layoutDefinition=V.f2.symbolLayoutDefinition,this._paintDefinition=V.f2.symbolPaintDefinition;break;case V.fR.CIRCLE:this._layoutDefinition=V.f2.circleLayoutDefinition,this._paintDefinition=V.f2.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=q.createFilter(this.filter)}getLayoutProperty(e){return this._layoutProperties[e]}getPaintProperty(e){return this._paintProperties[e]}getLayoutValue(e,s,a){let i;const o=this._layoutProperties[e];return o&&(i=o.getValue(s,a)),void 0===i&&(i=this._layoutDefinition[e].default),i}getPaintValue(e,s,a){let i;const o=this._paintProperties[e];return o&&(i=o.getValue(s,a)),void 0===i&&(i=this._paintDefinition[e].default),i}isPainterDataDriven(){const e=this._paintProperties;if(e)for(const s in e)if(e[s].isDataDriven)return!0;return!1}_parseLayout(e){const s={};for(const a in e){const i=this._layoutDefinition[a];i&&(s[a]=new zt(i,e[a]))}return s}_parsePaint(e){const s={};for(const a in e){const i=this._paintDefinition[a];i&&(s[a]=new zt(i,e[a]))}return s}computeAttributesKey(e,s,a,i){let o=0,d=0;for(const p of s){let g=3;if(!p||p!==i){const I=a[p],{isLayout:A,isOptional:v}=I,S=A?this.getLayoutProperty(p):this.getPaintProperty(p);g=S?.interpolator?2:S?.isDataDriven?1:v&&!S?3:0}d|=g<<o,o+=2}return d<<3|e}}class Ee extends Rt{constructor(e,s,a,i){super(e,s,a,i),this.backgroundMaterial=new D(this.computeAttributesKey(P._K.BACKGROUND,D.ATTRIBUTES,D.ATTRIBUTES_INFO))}}class we extends Rt{constructor(e,s,a,i){super(e,s,a,i);const o=this.getPaintProperty("fill-color"),d=this.getPaintProperty("fill-opacity"),p=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=o?.isDataDriven,this.hasDataDrivenOpacity=d?.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||p?.isDataDriven;const g=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!g,this.hasDataDrivenOutlineColor=g?.isDataDriven,this.hasDataDrivenOutline=g?g.isDataDriven:!!o&&o.isDataDriven,this.hasDataDrivenOutline=(g?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new B(this.computeAttributesKey(P._K.FILL,B.ATTRIBUTES,B.ATTRIBUTES_INFO)),this.outlineMaterial=new x(this.computeAttributesKey(P._K.OUTLINE,this.outlineUsesFillColor?x.ATTRIBUTES_FILL:x.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?x.ATTRIBUTES_INFO_FILL:x.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}}class Ie extends Rt{constructor(e,s,a,i){super(e,s,a,i);const o=this.getPaintProperty("line-pattern");if(this.lineMaterial=new j(this.computeAttributesKey(P._K.LINE,j.ATTRIBUTES,j.ATTRIBUTES_INFO,o?"line-dasharray":"")),this.hasDataDrivenLine=this.getPaintProperty("line-blur")?.isDataDriven||this.getPaintProperty("line-color")?.isDataDriven||this.getPaintProperty("line-gap-width")?.isDataDriven||this.getPaintProperty("line-offset")?.isDataDriven||this.getPaintProperty("line-opacity")?.isDataDriven||this.getPaintProperty("line-pattern")?.isDataDriven||this.getPaintProperty("line-dasharray")?.isDataDriven||this.getLayoutProperty("line-cap")?.isDataDriven||this.getPaintProperty("line-width")?.isDataDriven,this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const d=this.getPaintProperty("line-width");if(!d||"number"==typeof d&&.5*d<me.do){const p=this.getPaintProperty("line-offset");(!p||"number"==typeof p&&0===p)&&(this.canUseThinTessellation=!0)}}}getDashKey(e,s){let a;switch(s){case Tt.BUTT:a="Butt";break;case Tt.ROUND:a="Round";break;case Tt.SQUARE:a="Square";break;default:a="Butt"}return`dasharray-[${e.toString()}]-${a}`}}class be extends Rt{constructor(e,s,a,i){super(e,s,a,i),this.iconMaterial=new st(this.computeAttributesKey(P._K.ICON,st.ATTRIBUTES,st.ATTRIBUTES_INFO)),this.textMaterial=new at(this.computeAttributesKey(P._K.TEXT,at.ATTRIBUTES,at.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=this.getPaintProperty("icon-color")?.isDataDriven||this.getPaintProperty("icon-halo-blur")?.isDataDriven||this.getPaintProperty("icon-halo-color")?.isDataDriven||this.getPaintProperty("icon-halo-width")?.isDataDriven||this.getPaintProperty("icon-opacity")?.isDataDriven||this.getLayoutProperty("icon-size")?.isDataDriven,this.hasDataDrivenText=this.getPaintProperty("text-color")?.isDataDriven||this.getPaintProperty("text-halo-blur")?.isDataDriven||this.getPaintProperty("text-halo-color")?.isDataDriven||this.getPaintProperty("text-halo-width")?.isDataDriven||this.getPaintProperty("text-opacity")?.isDataDriven||this.getLayoutProperty("text-size")?.isDataDriven}}class ve extends Rt{constructor(e,s,a,i){super(e,s,a,i),this.circleMaterial=new N(this.computeAttributesKey(P._K.CIRCLE,N.ATTRIBUTES,N.ATTRIBUTES_INFO))}}class De{constructor(e,s,a){let i;this.allowOverlap=e.getLayoutValue("icon-allow-overlap",s),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",s),this.keepUpright=e.getLayoutValue("icon-keep-upright",s),this.optional=e.getLayoutValue("icon-optional",s),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",s),this.rotationAlignment===V.aF.AUTO&&(this.rotationAlignment=a?V.aF.MAP:V.aF.VIEWPORT),i=e.getLayoutProperty("icon-anchor"),i?.isDataDriven?this._anchorProp=i:this.anchor=e.getLayoutValue("icon-anchor",s),i=e.getLayoutProperty("icon-offset"),i?.isDataDriven?this._offsetProp=i:this.offset=e.getLayoutValue("icon-offset",s),i=e.getLayoutProperty("icon-padding"),i?.isDataDriven?this._paddingProp=i:this.padding=e.getLayoutValue("icon-padding",s),i=e.getLayoutProperty("icon-rotate"),i?.isDataDriven?this._rotateProp=i:this.rotate=e.getLayoutValue("icon-rotate",s),i=e.getLayoutProperty("icon-size"),i?.isDataDriven?this._sizeProp=i:this.size=e.getLayoutValue("icon-size",s)}update(e,s){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,s)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,s)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,s)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,s)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,s))}}class Te{constructor(e,s,a){let i;this.allowOverlap=e.getLayoutValue("text-allow-overlap",s),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",s),this.keepUpright=e.getLayoutValue("text-keep-upright",s),this.optional=e.getLayoutValue("text-optional",s),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",s),this.rotationAlignment===V.aF.AUTO&&(this.rotationAlignment=a?V.aF.MAP:V.aF.VIEWPORT),i=e.getLayoutProperty("text-anchor"),i?.isDataDriven?this._anchorProp=i:this.anchor=e.getLayoutValue("text-anchor",s),i=e.getLayoutProperty("text-justify"),i?.isDataDriven?this._justifyProp=i:this.justify=e.getLayoutValue("text-justify",s),i=e.getLayoutProperty("text-letter-spacing"),i?.isDataDriven?this._letterSpacingProp=i:this.letterSpacing=e.getLayoutValue("text-letter-spacing",s),i=e.getLayoutProperty("text-line-height"),i?.isDataDriven?this._lineHeightProp=i:this.lineHeight=e.getLayoutValue("text-line-height",s),i=e.getLayoutProperty("text-max-angle"),i?.isDataDriven?this._maxAngleProp=i:this.maxAngle=e.getLayoutValue("text-max-angle",s),i=e.getLayoutProperty("text-max-width"),i?.isDataDriven?this._maxWidthProp=i:this.maxWidth=e.getLayoutValue("text-max-width",s),i=e.getLayoutProperty("text-offset"),i?.isDataDriven?this._offsetProp=i:this.offset=e.getLayoutValue("text-offset",s),i=e.getLayoutProperty("text-padding"),i?.isDataDriven?this._paddingProp=i:this.padding=e.getLayoutValue("text-padding",s),i=e.getLayoutProperty("text-rotate"),i?.isDataDriven?this._rotateProp=i:this.rotate=e.getLayoutValue("text-rotate",s),i=e.getLayoutProperty("text-size"),i?.isDataDriven?this._sizeProp=i:this.size=e.getLayoutValue("text-size",s),i=e.getLayoutProperty("text-writing-mode"),i?.isDataDriven?this._writingModeProp=i:this.writingMode=e.getLayoutValue("text-writing-mode",s)}update(e,s){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,s)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,s)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,s)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,s)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,s)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,s)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,s)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,s)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,s)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,s)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,s))}}},78364:(Lt,ct,O)=>{O.d(ct,{Z:()=>f});var P=O(1268),H=O(77928);class f{constructor(c){if(this._style=c,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,c.layers||(c.layers=[]),this.version=parseFloat(c.version),this.layers=c.layers.map((h,y,m)=>this._create(h,y,m)).filter(h=>!!h),this.layers){let h;for(let y=0;y<this.layers.length;y++)h=this.layers[y],this._layerByName[h.id]=h,this._uidToLayer.set(h.uid,h),h.type===P.fR.BACKGROUND&&this.backgroundBucketIds.push(h.id)}this._identifyRefLayers()}isPainterDataDriven(c){const h=this._layerByName[c];return!!h&&h.isPainterDataDriven()}getStyleLayerId(c){return c>=this.layers.length?null:this.layers[c].id}getStyleLayerByUID(c){return this._uidToLayer.get(c)??null}getStyleLayerIndex(c){const h=this._layerByName[c];return h?this.layers.indexOf(h):-1}setStyleLayer(c,h){if(!c?.id)return;const y=this._style;null!=h&&h>=this.layers.length&&(h=this.layers.length-1);let m,L=!0;const D=this._layerByName[c.id];if(D){const N=this.layers.indexOf(D);h||(h=N),h===N?(L=!1,m=f._recreateLayer(c,D),this.layers[h]=m,y.layers[h]=c):(this.layers.splice(N,1),y.layers.splice(N,1),m=this._create(c,h,this.layers),this.layers.splice(h,0,m),y.layers.splice(h,0,c))}else m=this._create(c,h,this.layers),!h||h>=this.layers.length?(this.layers.push(m),y.layers.push(c)):(this.layers.splice(h,0,m),y.layers.splice(h,0,c));this._layerByName[c.id]=m,this._uidToLayer.set(m.uid,m),L&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(c){const h=this._layerByName[c];return h?{type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:h.layout,paint:h.paint}:null}deleteStyleLayer(c){const h=this._layerByName[c];if(h){delete this._layerByName[c],this._uidToLayer.delete(h.uid);const y=this.layers.indexOf(h);this.layers.splice(y,1),this._style.layers.splice(y,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(c){return this._layerByName[c]}getLayoutProperties(c){const h=this._layerByName[c];return h?h.layout:null}getPaintProperties(c){const h=this._layerByName[c];return h?h.paint:null}setPaintProperties(c,h){const y=this._layerByName[c];if(!y)return;const L=f._recreateLayer({type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:y.layout,paint:h},y),D=this.layers.indexOf(y);this.layers[D]=L,this._style.layers[D].paint=h,this._layerByName[y.id]=L,this._uidToLayer.set(y.uid,L)}setLayoutProperties(c,h){const y=this._layerByName[c];if(!y)return;const L=f._recreateLayer({type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:h,paint:y.paint},y),D=this.layers.indexOf(y);this.layers[D]=L,this._style.layers[D].layout=h,this._layerByName[y.id]=L,this._uidToLayer.set(y.uid,L)}setStyleLayerVisibility(c,h){const y=this._layerByName[c];if(!y)return;const m=y.layout||{};m.visibility=h;const D=f._recreateLayer({type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:m,paint:y.paint},y),N=this.layers.indexOf(y);this.layers[N]=D,this._style.layers[N].layout=m,this._layerByName[y.id]=D,this._uidToLayer.set(y.uid,D)}getStyleLayerVisibility(c){const h=this._layerByName[c];return h?h.layout?.visibility??"visible":"none"}_recomputeZValues(){const c=this.layers,h=1/(c.length+1);for(let y=0;y<c.length;y++)c[y].z=1-(1+y)*h}_identifyRefLayers(){const c=[],h=[];let y=0;for(const m of this.layers){const L=m.layout;if(m.type===P.fR.FILL){const D=m;let N=m.source+"|"+m.sourceLayer;N+="|"+(L?.visibility??""),N+="|"+m.minzoom,N+="|"+m.maxzoom,N+="|"+JSON.stringify(m.filter),(D.hasDataDrivenFill||D.hasDataDrivenOutline)&&(N+="|"+y),c.push({key:N,layer:m})}else if(m.type===P.fR.LINE){const D=m,N=m.paint,B=null!=N&&(null!=N["line-pattern"]||null!=N["line-dasharray"]);let x=m.source+"|"+m.sourceLayer;x+="|"+(L?.visibility??""),x+="|"+m.minzoom,x+="|"+m.maxzoom,x+="|"+JSON.stringify(m.filter),x+="|"+(void 0!==L?L["line-cap"]:""),x+="|"+(void 0!==L?L["line-join"]:""),(D.hasDataDrivenLine||B)&&(x+="|"+y),h.push({key:x,layer:m})}++y}this._assignRefLayers(c),this._assignRefLayers(h)}_assignRefLayers(c){let h,y;c.sort((L,D)=>L.key<D.key?-1:L.key>D.key?1:0);const m=c.length;for(let L=0;L<m;L++){const D=c[L];if(D.key===h)D.layer.refLayerId=y;else if(h=D.key,y=D.layer.id,D.layer.type===P.fR.FILL){if(!D.layer.getPaintProperty("fill-outline-color"))for(let N=L+1;N<m;N++){const B=c[N];if(B.key!==h)break;if(B.layer.getPaintProperty("fill-outline-color")){c[L]=B,c[N]=D,y=B.layer.id;break}}}else if(D.layer.type===P.fR.LINE){let N=D.layer;for(let B=L+1;B<m;B++){const x=c[B];if(x.key!==h)break;const j=x.layer;(N.canUseThinTessellation&&!j.canUseThinTessellation||!N.canUseThinTessellation&&(j.getPaintProperty("line-pattern")||j.getPaintProperty("line-dasharray")))&&(N=j,c[L]=x,c[B]=D,y=x.layer.id)}}}}_create(c,h,y){const m=1-(1+h)*(1/(y.length+1)),L=this._runningId++;switch(c.type){case"background":return new H.Et(P.fR.BACKGROUND,c,m,L);case"fill":return new H.Le(P.fR.FILL,c,m,L);case"line":return new H.gf(P.fR.LINE,c,m,L);case"symbol":return new H.jG(P.fR.SYMBOL,c,m,L);case"raster":return console.warn(`Unsupported vector tile raster layer ${c.id}`),null;case"circle":return new H.sj(P.fR.CIRCLE,c,m,L)}return null}static _recreateLayer(c,h){switch(c.type){case"background":return new H.Et(P.fR.BACKGROUND,c,h.z,h.uid);case"fill":return new H.Le(P.fR.FILL,c,h.z,h.uid);case"line":return new H.gf(P.fR.LINE,c,h.z,h.uid);case"symbol":return new H.jG(P.fR.SYMBOL,c,h.z,h.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${c.id}`),null;case"circle":return new H.sj(P.fR.CIRCLE,c,h.z,h.uid)}return null}}}}]);