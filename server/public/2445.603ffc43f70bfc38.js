"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[2445],{22445:(T,v,r)=>{r.r(v),r.d(v,{createLabelFunction:()=>I,formatField:()=>p});var M=r(15861),E=r(26584),P=r(63290),y=r(95737),D=r(88411),g=r(15348),C=r(91077),O=r(90194),h=r(86793),R=r(46679);const d=P.Z.getLogger("esri.layers.support.labelFormatUtils"),f={type:"simple",evaluate:()=>null},U={getAttribute:(t,n)=>t.field(n)};function I(t,n,i){return m.apply(this,arguments)}function m(){return(m=(0,M.Z)(function*(t,n,i){if(!t||!t.symbol||!n)return f;const o=t.where,u=(0,h.hV)(t);let a;if("arcade"===u.type){const e=yield(0,R.WW)(u.expression,i,n);if(null==e)return f;a={type:"arcade",evaluate(_,l){try{const s="attributes"in _?e.repurposeFeature(_):_;s.contextTimeZone=l??null;const c=e.evaluate({$view:{timeZone:l},$feature:s},e.services);if(null!=c)return c.toString()}catch(s){d.error(new E.Z("arcade-expression-error","Encountered an error when evaluating label expression for feature",{error:s,feature:_,expression:u}))}return null},needsHydrationToEvaluate:()=>null==(0,h.el)(u.expression)}}else a={type:"simple",evaluate:e=>u.expression.replaceAll(/{[^}]*}/g,_=>{const l=_.slice(1,-1),s=n.get(l);if(!s)return _;let c=null;return"attributes"in e?e&&e.attributes&&(c=e.attributes[s.name]):c=e.field(s.name),null==c?"":p(c,s)})};if(o){let e;try{e=yield(0,y.E)(o,n)}catch(l){return d.error(new E.Z("bad-where-clause","Encountered an error when evaluating where clause, ignoring",{where:o,error:l})),f}const _=a.evaluate;a.evaluate=(l,s)=>{const c="attributes"in l?void 0:U;try{if(e.testFeature(l,c))return _(l,s)}catch(L){d.error(new E.Z("bad-where-clause","Encountered an error when evaluating where clause for feature",{where:o,feature:l,error:L}))}return null}}return a})).apply(this,arguments)}function p(t,n){if(null==t)return"";const i=n.domain;if(i)if("codedValue"===i.type||"coded-value"===i.type){const u=t;for(const a of i.codedValues)if(a.code===u)return a.name}else if("range"===i.type){const{max:u,min:a}=(0,C.D3)(n),e=+t;if(null!=a&&null!=u&&a<=e&&e<=u)return i.name}let o=t;return(0,O.y2)(n)?o=(0,D.p6)(o,(0,D.Ze)("short-date")):(0,O.H7)(n)&&(o=(0,g.uf)(+o)),o||""}}}]);