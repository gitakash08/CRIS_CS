"use strict";(self.webpackChunkCRIS=self.webpackChunkCRIS||[]).push([[3482],{3482:(X,H,w)=>{w.d(H,{Z:()=>C});var m=w(15861),I=w(62074),p=w(47982),R=w(49086),k=w(91510),P=w(77132),O=w(87215);class C extends R.Z{constructor(g){super(g),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=g.relationString,this._parent=g.parentfeatureset,this._maxProcessing=40,this._relation=g.relation,this._relationGeom=g.relationGeom}_getSet(g){var h=this;return(0,m.Z)(function*(){if(null===h._wset){yield h._ensureLoaded();const M=yield h._parent._getFilteredSet("esriSpatialRelRelation"!==h._relation?h._relation:h._relation+":"+h._relationString,h._relationGeom,null,null,g);return h._checkCancelled(g),h._wset=new k.Z(M._candidates.slice(0),M._known.slice(0),M._ordered,h._clonePageDefinition(M.pagesDefinition)),h._wset}return h._wset})()}_isInFeatureSet(g){let h=this._parent._isInFeatureSet(g);return h===P.dj.NotInFeatureSet?h:(h=this._idstates[g],void 0===h?P.dj.Unknown:h)}_getFeature(g,h,M){return this._parent._getFeature(g,h,M)}_getFeatures(g,h,M,E){return this._parent._getFeatures(g,h,M,E)}_featureFromCache(g){return this._parent._featureFromCache(g)}executeSpatialRelationTest(g){var h=this;return(0,m.Z)(function*(){if(null===g.geometry)return!1;switch(h._relation){case"esriSpatialRelEnvelopeIntersects":return(0,O.kK)((0,P.SV)(h._relationGeom),(0,P.SV)(g.geometry));case"esriSpatialRelIntersects":return(0,O.kK)(h._relationGeom,g.geometry);case"esriSpatialRelContains":return(0,O.r3)(h._relationGeom,g.geometry);case"esriSpatialRelOverlaps":return(0,O.Nm)(h._relationGeom,g.geometry);case"esriSpatialRelWithin":return(0,O.uh)(h._relationGeom,g.geometry);case"esriSpatialRelTouches":return(0,O.W4)(h._relationGeom,g.geometry);case"esriSpatialRelCrosses":return(0,O.jU)(h._relationGeom,g.geometry);case"esriSpatialRelRelation":return(0,O.LV)(h._relationGeom,g.geometry,h._relationString??"")}})()}_fetchAndRefineFeatures(g,h,M){var E=this;return(0,m.Z)(function*(){const j=new k.Z([],g,!1,null),v=Math.min(h,g.length);yield E._parent?._getFeatures(j,-1,v,M),E._checkCancelled(M);const T=[];for(let e=0;e<v;e++){const r=E._parent._featureFromCache(g[e]);T.push(yield E.executeSpatialRelationTest(r))}for(let e=0;e<h;e++)E._idstates[g[e]]=!0===T[e]?P.dj.InFeatureSet:P.dj.NotInFeatureSet;return"success"})()}_getFilteredSet(g,h,M,E,j){var v=this;return(0,m.Z)(function*(){yield v._ensureLoaded();const T=yield v._parent._getFilteredSet("esriSpatialRelRelation"!==v._relation?v._relation:v._relation+":"+v._relationString,v._relationGeom,M,E,j);let e;return v._checkCancelled(j),e=null!==h?new k.Z(T._candidates.slice(0).concat(T._known.slice(0)),[],T._ordered,v._clonePageDefinition(T.pagesDefinition)):new k.Z(T._candidates.slice(0),T._known.slice(0),T._ordered,v._clonePageDefinition(T.pagesDefinition)),e})()}_stat(g,h,M,E,j,v,T){var e=this;return(0,m.Z)(function*(){if(""!==M)return{calculated:!1};const r=yield e._parent._stat(g,h,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,j,v,T);return!1===r.calculated?null===j&&""===M&&null===E?e._manualStat(g,h,v,T):{calculated:!1}:r})()}_canDoAggregates(g,h,M,E,j){var v=this;return(0,m.Z)(function*(){return""===M&&null===E&&null!==v._parent&&v._parent._canDoAggregates(g,h,"esriSpatialRelRelation"!==v._relation?v._relation:v._relation+":"+v._relationString,v._relationGeom,j)})()}_getAggregatePagesDataSourceDefinition(g,h,M,E,j,v,T){var e=this;return(0,m.Z)(function*(){if(null===e._parent)throw new p.EN(p.H9.NeverReach);return e._parent._getAggregatePagesDataSourceDefinition(g,h,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,j,v,T)})()}static registerAction(){R.Z._featuresetFunctions.intersects=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:g})},R.Z._featuresetFunctions.envelopeIntersects=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:g})},R.Z._featuresetFunctions.contains=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:g})},R.Z._featuresetFunctions.overlaps=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:g})},R.Z._featuresetFunctions.within=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:g})},R.Z._featuresetFunctions.touches=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:g})},R.Z._featuresetFunctions.crosses=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:g})},R.Z._featuresetFunctions.relate=function(g,h){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:g,relationString:h})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}},62074:(X,H,w)=>{w.d(H,{Z:()=>P});var m=w(15861),I=w(47982),p=w(49086),R=w(91510),k=w(77132);class P extends p.Z{constructor(C){super(C),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new R.Z([],[],!1,null),this._parent=C.parentfeatureset,this._databaseType=k.Bj.Standardised}_getSet(){var C=this;return(0,m.Z)(function*(){return C._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return k.dj.NotInFeatureSet}_getFeature(){return(0,m.Z)(function*(){throw new I.EN(I.H9.NeverReach)})()}queryAttachments(){return(0,m.Z)(function*(){return[]})()}_getFeatures(){return(0,m.Z)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,m.Z)(function*(){throw new I.EN(I.H9.NeverReach)})()}_getFilteredSet(){return(0,m.Z)(function*(){return new R.Z([],[],!1,null)})()}_stat(C,V,g,h,M,E,j){return this._manualStat(C,V,E,j)}_canDoAggregates(){return(0,m.Z)(function*(){return!1})()}}},49086:(X,H,w)=>{w.d(H,{Z:()=>j});var m=w(15861),I=w(53791),p=w(47982),R=w(42275);class k{constructor(T,e){this._lastId=-1,this._progress=e,this._parent=T}reset(){this._lastId=-1}nextBatchAsArcadeFeatures(T,e){var r=this;return(0,m.Z)(function*(){const s=yield r.nextBatch(T);return null===s?s:s.map(n=>R.Z.createFromGraphicLikeObject(n.geometry,n.attributes,r._parent,e))})()}nextBatch(T){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(s=>this.nextBatch(T),s=>this.nextBatch(T));const e={returnpromise:null,hasset:!1},r=[];return e.returnpromise=new Promise((s,n)=>{this._parent._getSet(this._progress).then(o=>{const c=o._known;let D=c.length-1;if("GETPAGES"===c[c.length-1]&&(D-=1),this._lastId+T>D&&c.length>0&&"GETPAGES"===c[c.length-1])this._parent._expandPagedSet(o,this._parent._maxQueryRate(),0,0,this._progress).then(N=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(T).then(s,n)},N=>{e.hasset=!0,this._parent._mainSetInUse=null,n(N)});else{if(D>=this._lastId+T||0===o._candidates.length){for(let N=0;N<T;N++){const Y=N+this._lastId+1;if(Y>=c.length)break;r[N]=c[Y]}return this._lastId+=r.length,0===r.length&&(e.hasset=!0,this._parent._mainSetInUse=null,s([])),void this._parent._getFeatureBatch(r,this._progress).then(N=>{e.hasset=!0,this._parent._mainSetInUse=null,s(N)},N=>{e.hasset=!0,this._parent._mainSetInUse=null,n(N)})}this._parent._refineSetBlock(o,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(T).then(s,n)},N=>{e.hasset=!0,this._parent._mainSetInUse=null,n(N)})}},o=>{e.hasset=!0,this._parent._mainSetInUse=null,n(o)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(e=>this.next(),e=>this.next());const T={returnpromise:null,hasset:!1};return T.returnpromise=new Promise((e,r)=>{this._parent._getSet(this._progress).then(s=>{const n=s._known;this._lastId<n.length-1?"GETPAGES"===n[this._lastId+1]?this._parent._expandPagedSet(s,this._parent._maxQueryRate(),0,0,this._progress).then(o=>(T.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(e,r):(this._lastId+=1,this._parent._getFeature(s,n[this._lastId],this._progress).then(o=>{T.hasset=!0,this._parent._mainSetInUse=null,e(o)},o=>{T.hasset=!0,this._parent._mainSetInUse=null,r(o)})):s._candidates.length>0?this._parent._refineSetBlock(s,this._parent._maxProcessingRate(),this._progress).then(()=>{T.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,r)},o=>{T.hasset=!0,this._parent._mainSetInUse=null,r(o)}):(T.hasset=!0,this._parent._mainSetInUse=null,e(null))},s=>{T.hasset=!0,this._parent._mainSetInUse=null,r(s)})}),!1===T.hasset&&(this._parent._mainSetInUse=T.returnpromise,T.hasset=!0),T.returnpromise}count(){var T=this;return(0,m.Z)(function*(){if(-1!==T._parent._totalCount)return T._parent._totalCount;const e=yield T._parent._getSet(T._progress),r=yield T._refineAllSets(e);return T._parent._totalCount=r._known.length,T._parent._totalCount})()}_refineAllSets(T){var e=this;return(0,m.Z)(function*(){if(T._known.length>0&&"GETPAGES"===T._known[T._known.length-1])return yield e._parent._expandPagedSet(T,e._parent._maxQueryRate(),0,1,e._progress),e._refineAllSets(T);if(T._candidates.length>0){if("GETPAGES"===T._known[T._candidates.length-1])return yield e._parent._expandPagedSet(T,e._parent._maxQueryRate(),0,2,e._progress),e._refineAllSets(T);const r=yield e._parent._refineSetBlock(T,e._parent._maxProcessingRate(),e._progress);return r._candidates.length>0?e._refineAllSets(r):r}return T})()}}var P=w(91510),O=w(77132),C=w(45333),V=w(10699),g=w(80774),h=w(87215),M=w(65234),E=w(60466);let j=(()=>{class v{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=O.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.typeIdField=null,this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,this.fsetInfo=null,e?.lrucache&&(this.recentlyUsedQueries=e.lrucache),e?.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,r){return void 0===r?this[e]:(void 0!==this[e]&&(this[e]=r),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,m.Z)(function*(){return!0===e._parent?.loaded?(e._initialiseFeatureSet(),e):(yield e._parent?.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new M.Z({wkid:4326}),this.geometryType=O.Qk.point)}getField(e,r){let s;return(r=r||this.fields)&&(e=e.toLowerCase(),r.some(n=>(n&&n.name.toLowerCase()===e&&(s=n),!!s))),s}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=E.Z.fromLayer({timeInfo:this.timeInfo,editFieldsInfo:this.editFieldsInfo,dateFieldsTimeZone:this.dateFieldsTimeZone,datesInUnknownTimezone:this.datesInUnknownTimezone,fields:this.fields})),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new p.EN(p.H9.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,r,s,n,o){var c=this;return(0,m.Z)(function*(){return null!==c._parent&&c._parent._canDoAggregates(e,r,s,n,o)})()}_getAggregatePagesDataSourceDefinition(e,r,s,n,o,c,D){var x=this;return(0,m.Z)(function*(){if(null===x._parent)throw new p.EN(p.H9.NeverReach);return x._parent._getAggregatePagesDataSourceDefinition(e,r,s,n,o,c,D)})()}_getAgregagtePhysicalPage(e,r,s){var n=this;return(0,m.Z)(function*(){if(null===n._parent)throw new p.EN(p.H9.NeverReach);return n._parent._getAgregagtePhysicalPage(e,r,s)})()}databaseType(){var e=this;return(0,m.Z)(function*(){if(e._databaseType===O.Bj.NotEvaluated){if(null!==I.Z.applicationCache){const r=I.Z.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==r)return r}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==I.Z.applicationCache&&I.Z.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(r){throw null!==I.Z.applicationCache&&I.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),r}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,m.Z)(function*(){const r=[{thetype:O.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:O.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:O.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const s of r)if(!0===(yield e._runDatabaseProbe(s.testwhere)))return s.thetype;return O.Bj.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var r=this;return(0,m.Z)(function*(){if(null!==r._parent)return r._parent._runDatabaseProbe(e);throw new p.EN(p.H9.NotImplemented)})()}isTable(){return this._parent?.isTable()??!1}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return O.dj.Unknown}_getSet(e){throw new p.EN(p.H9.NotImplemented)}_getFeature(e,r,s){var n=this;return(0,m.Z)(function*(){if(n._checkCancelled(s),void 0!==n._featureFromCache(r)||(yield n._getFeatures(e,r,n._maxProcessingRate(),s),n._checkCancelled(s),void 0!==n._featureFromCache(r)))return n._featureFromCache(r);throw new p.EN(p.H9.MissingFeatures)})()}_getFeatureBatch(e,r){var s=this;return(0,m.Z)(function*(){s._checkCancelled(r);const n=new P.Z([],e,!1,null),o=[];yield s._getFeatures(n,-1,e.length,r),s._checkCancelled(r);for(const c of e)void 0!==s._featureFromCache(c)&&o.push(s._featureFromCache(c));return o})()}_getFeatures(e,r,s,n){return(0,m.Z)(function*(){return"success"})()}_getFilteredSet(e,r,s,n,o){throw new p.EN(p.H9.NotImplemented)}_refineSetBlock(e,r,s){var n=this;return(0,m.Z)(function*(){if(!0===n._checkIfNeedToExpandCandidatePage(e,n._maxQueryRate()))return yield n._expandPagedSet(e,n._maxQueryRate(),0,0,s),n._refineSetBlock(e,r,s);n._checkCancelled(s);const o=e._candidates.length;n._refineKnowns(e,r);let c=o-e._candidates.length;if(0===e._candidates.length||c>=r)return e;if(yield n._refineIfParentKnown(e,r-c,s),n._checkCancelled(s),n._refineKnowns(e,r-c),c=o-e._candidates.length,c<r&&e._candidates.length>0){const D=r-c,x=n._prepareFetchAndRefineSet(e._candidates);return yield n._fetchAndRefineFeatures(x,x.length>D?D:e._candidates.length,s),n._checkCancelled(s),n._refineKnowns(e,r-c),e}return e})()}_fetchAndRefineFeatures(e,r,s){return null}_prepareFetchAndRefineSet(e){const r=[];for(let s=0;s<e.length;s++)this._isPhysicalFeature(e[s])&&r.push(e[s]);return r}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,r){let s=0,n=null;const o=[];r=this._maxQueryRate();for(let c=0;c<e._candidates.length&&"GETPAGES"!==e._candidates[c];c++){let D=!1;const x=this._candidateIdTransform(e._candidates[c]);x!==e._candidates[c]&&(D=!0);const N=this._isInFeatureSet(x);if(N===O.dj.InFeatureSet)!0===D?e._known.includes(x)||(e._known.push(x),s+=1):(e._known.push(e._candidates[c]),s+=1),null===n?n={start:c,end:c}:n.end===c-1?n.end=c:(o.push(n),n={start:c,end:c});else if(N===O.dj.NotInFeatureSet)null===n?n={start:c,end:c}:n.end===c-1?n.end=c:(o.push(n),n={start:c,end:c}),s+=1;else if(N===O.dj.Unknown&&(s+=1,!0===e._ordered))break;if(s>=r)break}null!==n&&o.push(n);for(let c=o.length-1;c>=0;c--)e._candidates.splice(o[c].start,o[c].end-o[c].start+1)}_refineIfParentKnown(e,r,s){const n=new P.Z([],[],e._ordered,null);return n._candidates=e._candidates.slice(0),this._parent._refineSetBlock(n,r,s)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,r){if(null===e.pagesDefinition)return!1;let s=0;for(let n=e._lastFetchedIndex;n<e._known.length;n++){if("GETPAGES"===e._known[n])return!0;if(void 0===this._featureCache[e._known[n]]&&(s+=1,s>=r))break}return!1}_checkIfNeedToExpandCandidatePage(e,r){if(null===e.pagesDefinition)return!1;let s=0;for(let n=0;n<e._candidates.length;n++){if("GETPAGES"===e._candidates[n])return!0;if(s+=1,s>=r)break}return!1}_expandPagedSet(e,r,s,n,o){var c=this;return(0,m.Z)(function*(){if(null===c._parent)throw new p.EN(p.H9.NotImplemented);return c._parent._expandPagedSet(e,r,s,n,o)})()}_expandPagedSetFeatureSet(e,r,s,n,o){var c=this;return(0,m.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(n=1),0===n&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(n=2),0===n)return"finished";const D=yield c._getPage(e,n,o);return s+D<r?c._expandPagedSet(e,r,s+D,0,o):"success"})()}_getPage(e,r,s){var n=this;return(0,m.Z)(function*(){const o=1===r?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){o.length=o.length-1;let c=0;for(let x=0;x<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+x>=e.pagesDefinition.internal.set.length);x++)o[o.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+x],c++;e.pagesDefinition.resultOffset+=c;let D=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(D=!0),!1===D&&o.push("GETPAGES"),c}return yield n._getPhysicalPage(e,r,s),n._getPage(e,r,s)})()}_getPhysicalPage(e,r,s){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,r,s,n){var o=this;return(0,m.Z)(function*(){yield o._ensureLoaded();let c=yield o._stat(e,r,"",null,null,s,n);return!1===c.calculated&&(c=yield o._manualStat(e,r,s,n)),c.result})()}_manualStat(e,r,s,n){var o=this;return(0,m.Z)(function*(){let c=null;switch(e.toLowerCase()){case"count":return c=yield(0,C.QX)(o,n),{calculated:!0,result:c};case"distinct":return c=yield(0,C.EB)(o,r,s,n),{calculated:!0,result:c};case"avg":case"mean":return c=yield(0,C.J6)(o,r,n),{calculated:!0,result:c};case"stdev":return c=yield(0,C.m)(o,r,n),{calculated:!0,result:c};case"variance":return c=yield(0,C.CA)(o,r,n),{calculated:!0,result:c};case"sum":return c=yield(0,C.Sm)(o,r,n),{calculated:!0,result:c};case"min":return c=yield(0,C.VV)(o,r,n),{calculated:!0,result:c};case"max":return c=yield(0,C.Fp)(o,r,n),{calculated:!0,result:c};default:return{calculated:!0,result:0}}})()}_stat(e,r,s,n,o,c,D){var x=this;return(0,m.Z)(function*(){const N=yield x._parent._stat(e,r,s,n,o,c,D);return!1===N.calculated?null===o&&""===s&&null===n?x._manualStat(e,r,c,D):{calculated:!1}:N})()}_unionAllGeomSelf(e){const r=this.iterator(this._defaultTracker(e)),s=[];return new Promise((n,o)=>{this._unionShapeInBatches(s,r,n,o)})}_unionAllGeom(e){return new Promise((r,s)=>{const n=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],n,r,s)})}_unionShapeInBatches(e,r,s,n){r.next().then(o=>{try{null!==o&&null!==o.geometry&&e.push(o.geometry),e.length>30||null===o&&e.length>1?(0,h.G0)(e).then(c=>{try{null===o?s(c):this._unionShapeInBatches(e=[c],r,s,n)}catch(D){n(D)}},n):null===o?s(1===e.length?e[0]:null):this._unionShapeInBatches(e,r,s,n)}catch(c){n(c)}},n)}iterator(e){return new k(this,e)}intersection(e,r=!1){return v._featuresetFunctions.intersection.bind(this)(e,r)}difference(e,r=!1,s=!0){return v._featuresetFunctions.difference.bind(this)(e,r,s)}symmetricDifference(e,r=!1,s=!0){return v._featuresetFunctions.symmetricDifference.bind(this)(e,r,s)}morphShape(e,r,s="unknown",n=null){return v._featuresetFunctions.morphShape.bind(this)(e,r,s,n)}morphShapeAndAttributes(e,r,s="unknown"){return v._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,r,s)}union(e,r=!1){return v._featuresetFunctions.union.bind(this)(e,r)}intersects(e){return v._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return v._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return v._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return v._featuresetFunctions.overlaps.bind(this)(e)}relate(e,r){return v._featuresetFunctions.relate.bind(this)(e,r)}within(e){return v._featuresetFunctions.within.bind(this)(e)}touches(e){return v._featuresetFunctions.touches.bind(this)(e)}top(e){return v._featuresetFunctions.top.bind(this)(e)}crosses(e){return v._featuresetFunctions.crosses.bind(this)(e)}buffer(e,r,s,n=!0){return v._featuresetFunctions.buffer.bind(this)(e,r,s,n)}filter(e,r=null){return v._featuresetFunctions.filter.bind(this)(e,r)}orderBy(e){return v._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,r){return v._featuresetFunctions.dissolve.bind(this)(e,r)}groupby(e,r){return v._featuresetFunctions.groupby.bind(this)(e,r)}reduce(e,r=null,s){return new Promise((n,o)=>{this._reduceImpl(this.iterator(this._defaultTracker(s)),e,r,0,n,o,0)})}_reduceImpl(e,r,s,n,o,c,D){try{if(++D>1e3)return void setTimeout(()=>{this._reduceImpl(e,r,s,n,o,c,D=0)});e.next().then(x=>{try{if(null===x)o(s);else{const N=r(s,x,n,this);(0,V.y8)(N)?N.then(Y=>{this._reduceImpl(e,r,Y,n+1,o,c,D)},c):this._reduceImpl(e,r,N,n+1,o,c,D)}}catch(N){c(N)}},c)}catch(x){c(x)}}removeField(e){return v._featuresetFunctions.removeField.bind(this)(e)}addField(e,r,s=null){return v._featuresetFunctions.addField.bind(this)(e,r,s)}sumArea(e,r=!1,s){const n=(0,O.EI)(e);return this.reduce((o,c)=>null===c.geometry?0:r?(0,h.Y4)(c.geometry,n).then(D=>o+D):(0,h.CJ)(c.geometry,n).then(D=>o+D),0,s)}sumLength(e,r=!1,s){const n=(0,O.Lz)(e);return this.reduce((o,c)=>null===c.geometry?0:r?(0,h.kQ)(c.geometry,n).then(D=>o+D):(0,h.sz)(c.geometry,n).then(D=>o+D),0,s)}_substituteVars(e,r){if(null!==r){const s={};for(const n in r)s[n.toLowerCase()]=r[n];e.parameters=s}}distinct(e,r=1e3,s=null,n){var o=this;return(0,m.Z)(function*(){yield o.load();const c=g.WhereClause.create(e,o.getFieldsIndex(),o.dateFieldsTimeZoneDefaultUTC);return o._substituteVars(c,s),o.calculateStatistic("distinct",c,r,o._defaultTracker(n))})()}min(e,r=null,s){var n=this;return(0,m.Z)(function*(){yield n.load();const o=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(o,r),n.calculateStatistic("min",o,-1,n._defaultTracker(s))})()}max(e,r=null,s){var n=this;return(0,m.Z)(function*(){yield n.load();const o=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(o,r),n.calculateStatistic("max",o,-1,n._defaultTracker(s))})()}avg(e,r=null,s){var n=this;return(0,m.Z)(function*(){yield n.load();const o=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(o,r),n.calculateStatistic("avg",o,-1,n._defaultTracker(s))})()}sum(e,r=null,s){var n=this;return(0,m.Z)(function*(){yield n.load();const o=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(o,r),n.calculateStatistic("sum",o,-1,n._defaultTracker(s))})()}stdev(e,r=null,s){var n=this;return(0,m.Z)(function*(){yield n.load();const o=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(o,r),n.calculateStatistic("stdev",o,-1,n._defaultTracker(s))})()}variance(e,r=null,s){var n=this;return(0,m.Z)(function*(){yield n.load();const o=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(o,r),n.calculateStatistic("variance",o,-1,n._defaultTracker(s))})()}count(e){var r=this;return(0,m.Z)(function*(){return yield r.load(),r.calculateStatistic("count",g.WhereClause.create("1",r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC),-1,r._defaultTracker(e))})()}_defaultTracker(e){return e??{aborted:!1}}forEach(e,r){return new Promise((s,n)=>{this._forEachImpl(this.iterator(this._defaultTracker(r)),e,this,s,n,0)})}_forEachImpl(e,r,s,n,o,c){try{if(++c>1e3)return void setTimeout(()=>{this._forEachImpl(e,r,s,n,o,c=0)},0);e.next().then(D=>{try{if(null===D)n(s);else{const x=r(D);null==x?this._forEachImpl(e,r,s,n,o,c):(0,V.y8)(x)?x.then(()=>{try{this._forEachImpl(e,r,s,n,o,c)}catch(N){o(N)}},o):this._forEachImpl(e,r,s,n,o,c)}}catch(x){o(x)}},o)}catch(D){o(D)}}convertToJSON(e){const r={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let s=0;s<this.fields.length;s++)r.layerDefinition.fields.push((0,O.Sh)(this.fields[s]));return this.reduce((s,n)=>{const o={geometry:n.geometry?.toJSON(),attributes:{}};for(const c in n.attributes)o.attributes[c]=n.attributes[c];return r.featureSet.features.push(o),1},0,e).then(()=>r)}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,r,s,n,o){return this._parent.queryAttachments(e,r,s,n,o)}serviceUrl(){return this._parent.serviceUrl()}subtypes(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const r of this.fields)e.push((0,O.Sh)(r));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===O.q2[this.geometryType]?"esriGeometryNull":O.q2[this.geometryType],fields:e}}convertToText(e,r){var s=this;return(0,m.Z)(function*(){if("schema"===e)return yield s._ensureLoaded(),JSON.stringify(s.schema());if("featureset"===e){yield s._ensureLoaded();const n=[];yield s.reduce((c,D)=>{const x={geometry:D.geometry?D.geometry.toJSON():null,attributes:D.attributes};return null!==x.geometry&&x.geometry.spatialReference&&delete x.geometry.spatialReference,n.push(x),1},0,r);const o=s.schema();return o.features=n,o.spatialReference=s.spatialReference.toJSON(),JSON.stringify(o)}return s.castToText()})()}getFeatureByObjectId(e,r){return this._parent.getFeatureByObjectId(e,r)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,r=null){var s=this;return(0,m.Z)(function*(){if("keeptype"===r?.featureset)return s;if("schema"===r?.featureset)return yield s._ensureLoaded(),JSON.parse(JSON.stringify(s.schema()));if("none"===r?.featureset)return null;yield s._ensureLoaded();const n=[];yield s.reduce((c,D)=>{const x={geometry:D.geometry?!0===r?.keepGeometryType?D.geometry:D.geometry.toJSON():null,attributes:D.attributes};return null!==x.geometry&&x.geometry.spatialReference&&!0!==r?.keepGeometryType&&delete x.geometry.spatialReference,n.push(x),1},0,e);const o=s.schema();return o.features=n,o.spatialReference=!0===r?.keepGeometryType?s.spatialReference:s.spatialReference?.toJSON(),o})()}fieldTimeZone(e){return this.getFieldsIndex().getTimeZone(e)}get preferredTimeZone(){return this._parent?.preferredTimeZone??null}get dateFieldsTimeZone(){return this._parent?.dateFieldsTimeZone??null}get dateFieldsTimeZoneDefaultUTC(){if(this.datesInUnknownTimezone)return"unknown";const e=this.dateFieldsTimeZone??"UTC";return""===e?"UTC":e}get datesInUnknownTimezone(){return this._parent.datesInUnknownTimezone}get editFieldsInfo(){return this._parent?.editFieldsInfo??null}get timeInfo(){return this._parent?.timeInfo??null}set featureSetInfo(e){this.fsetInfo=e}getFeatureSetInfo(){var e=this;return(0,m.Z)(function*(){return e.fsetInfo??(yield e._parent?.getFeatureSetInfo())??null})()}}return v._featuresetFunctions={},v})()},91510:(X,H,w)=>{w.d(H,{Z:()=>m});class m{constructor(p,R,k,P){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=p,this._known=R,this._ordered=k,this.pagesDefinition=P}}},53791:(X,H,w)=>{w.d(H,{Z:()=>m});let m=(()=>{class I{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(R){void 0===this._databaseTypeMetaData[R]&&delete this._databaseTypeMetaData[R]}getDatabaseType(R){return"MUSTBESET"===R||void 0===this._databaseTypeMetaData[R]?null:this._databaseTypeMetaData[R]}setDatabaseType(R,k){this._databaseTypeMetaData[R]=k}getLayerInfo(R){return void 0===this._layerInfo[R]?null:this._layerInfo[R]}setLayerInfo(R,k){this._layerInfo[R]=k}clearLayerInfo(R){void 0!==this._layerInfo[R]&&delete this._layerInfo[R]}}return I.applicationCache=null,I})()},83947:(X,H,w)=>{w.d(H,{$e:()=>g,DT:()=>r,TE:()=>Y,XF:()=>C,av:()=>j,bB:()=>V,fz:()=>M,hq:()=>c,mA:()=>E,vR:()=>e,vn:()=>T,wF:()=>v,y5:()=>D,zR:()=>O});var m=w(91365),I=w(47982),p=w(77132),R=w(29535),k=w(80774),P=w(21837);function O(u,a){return h(u?.parseTree,a,u?.parameters)}function C(u,a,d){return h(u,a,d)}function V(u,a,d,l){return k.WhereClause.create(h(u.parseTree,p.Bj.Standardised,u.parameters,a,d),l,u.timeZone)}function g(u,a,d="AND"){return k.WhereClause.create("(("+O(u,p.Bj.Standardised)+")"+d+"("+O(a,p.Bj.Standardised)+"))",u.fieldsIndex,u.timeZone)}function h(u,a,d,l=null,S=null){let B,L,y,F;switch(u.type){case"interval":return Y(h(u.value,a,d,l,S),u.qualifier,u.op);case"case-expression":{let f=" CASE ";"simple"===u.format&&(f+=h(u.operand,a,d,l,S));for(let b=0;b<u.clauses.length;b++)f+=" WHEN "+h(u.clauses[b].operand,a,d,l,S)+" THEN "+h(u.clauses[b].value,a,d,l,S);return null!==u.else&&(f+=" ELSE "+h(u.else,a,d,l,S)),f+=" END ",f}case"parameter":{const f=d[u.value.toLowerCase()];if("string"==typeof f)return"'"+d[u.value.toLowerCase()].toString().replaceAll("'","''")+"'";if((0,p.J_)(f)||(0,p.T4)(f))return T(f,a);if((0,p._U)(f))return v(f,a);if((0,p.NP)(f))return E(f,a);if((0,p.$A)(f))return j(f,a);if(f instanceof Array){const b=[];for(let Z=0;Z<f.length;Z++)"string"==typeof f[Z]?b.push("'"+f[Z].toString().replaceAll("'","''")+"'"):(0,p.J_)(f[Z])||(0,p.T4)(f[Z])?b.push(T(f[Z],a)):(0,p._U)(f[Z])?b.push(v(f[Z],a)):(0,p.NP)(f[Z])?b.push(E(f[Z],a)):(0,p.$A)(f[Z])?b.push(j(f[Z],a)):b.push(f[Z].toString());return b}return f.toString()}case"expression-list":L=[];for(const f of u.value)L.push(h(f,a,d,l,S));return L;case"unary-expression":return" ( NOT "+h(u.expr,a,d,l,S)+" ) ";case"binary-expression":switch(u.operator){case"AND":return" ("+h(u.left,a,d,l,S)+" AND "+h(u.right,a,d,l,S)+") ";case"OR":return" ("+h(u.left,a,d,l,S)+" OR "+h(u.right,a,d,l,S)+") ";case"IS":if("null"!==u.right.type)throw new I.eS(I.f.UnsupportedIsRhs);return" ("+h(u.left,a,d,l,S)+" IS NULL )";case"ISNOT":if("null"!==u.right.type)throw new I.eS(I.f.UnsupportedIsRhs);return" ("+h(u.left,a,d,l,S)+" IS NOT NULL )";case"IN":return B=[],"expression-list"===u.right.type?(B=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" IN ("+B.join(",")+")) "):(F=h(u.right,a,d,l,S),F instanceof Array?" ("+h(u.left,a,d,l,S)+" IN ("+F.join(",")+")) ":" ("+h(u.left,a,d,l,S)+" IN ("+F+")) ");case"NOT IN":return B=[],"expression-list"===u.right.type?(B=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" NOT IN ("+B.join(",")+")) "):(F=h(u.right,a,d,l,S),F instanceof Array?" ("+h(u.left,a,d,l,S)+" NOT IN ("+F.join(",")+")) ":" ("+h(u.left,a,d,l,S)+" NOT IN ("+F+")) ");case"BETWEEN":return y=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" BETWEEN "+y[0]+" AND "+y[1]+" ) ";case"NOTBETWEEN":return y=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" NOT BETWEEN "+y[0]+" AND "+y[1]+" ) ";case"LIKE":return""!==u.escape?" ("+h(u.left,a,d,l,S)+" LIKE "+h(u.right,a,d,l,S)+" ESCAPE '"+u.escape+"') ":" ("+h(u.left,a,d,l,S)+" LIKE "+h(u.right,a,d,l,S)+") ";case"NOT LIKE":return""!==u.escape?" ("+h(u.left,a,d,l,S)+" NOT LIKE "+h(u.right,a,d,l,S)+" ESCAPE '"+u.escape+"') ":" ("+h(u.left,a,d,l,S)+" NOT LIKE "+h(u.right,a,d,l,S)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+h(u.left,a,d,l,S)+" "+u.operator+" "+h(u.right,a,d,l,S)+") ";case"||":return" ("+h(u.left,a,d,l,S)+" "+(a===p.Bj.SqlServer?"+":u.operator)+" "+h(u.right,a,d,l,S)+") "}throw new I.eS(I.f.UnsupportedOperator,{operator:u.operator});case"null":return"null";case"boolean":return!0===u.value?"1":"0";case"string":return"'"+u.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${u.value}'`;case"date":return`date '${u.value}'`;case"time":return`time '${u.value}'`;case"number":return u.value.toString();case"current-time":return e("date"===u.mode,a);case"column-reference":return l?l.toLowerCase()===u.column.toLowerCase()?"("+S+")":!0===u.delimited?`"${u.column.split('"').join('""')}"`:u.column:u.column;case"data-type":return u.value;case"function":{const f=h(u.args,a,d,l,S);return M(u.name,f,a)}}throw new I.eS(I.f.UnsupportedSyntax,{node:u.type})}function M(u,a,d){switch(u.toLowerCase().trim()){case"cos":case"sin":case"tan":case"cosh":case"tanh":case"sinh":case"acos":case"asin":case"atan":case"floor":case"log10":case"log":case"abs":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:u.toLowerCase().trim()});return`${u.toUpperCase().trim()}(${a[0]})`;case"ceiling":case"ceil":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"ceiling"});return"CEILING("+a[0]+")";case"mod":case"power":case"nullif":if(2!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:u.toLowerCase().trim()});return`${u.toUpperCase().trim()}(${a[0]},${a[1]})`;case"round":if(2===a.length)return"ROUND("+a[0]+","+a[1]+")";if(1===a.length)return"ROUND("+a[0]+")";throw new I.eS(I.f.InvalidFunctionParameters,{function:"round"});case"truncate":if(a.length<1||a.length>2)throw new I.eS(I.f.InvalidFunctionParameters,{function:"truncate"});return d===p.Bj.SqlServer?"ROUND("+a[0]+(1===a.length?"0":","+a[1])+",1)":"TRUNCATE("+a[0]+(1===a.length?")":","+a[1]+")");case"char_length":case"len":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"char_length"});switch(d){case p.Bj.SqlServer:return"LEN("+a[0]+")";case p.Bj.Oracle:return"LENGTH("+a[0]+")";default:return"CHAR_LENGTH("+a[0]+")"}case"coalesce":case"concat":{if(a.length<1)throw new I.eS(I.f.InvalidFunctionParameters,{function:u.toLowerCase()});let l=u.toUpperCase().trim()+"(";for(let S=0;S<a.length;S++)0!==S&&(l+=","),l+=a[S];return l+=")",l}case"lower":case"lcase":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"lower"});return"LOWER("+a[0]+")";case"upper":case"ucase":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"upper"});return"UPPER("+a[0]+")";case"substring":{let l="";switch(d){case p.Bj.Oracle:return l="SUBSTR("+a[0]+","+a[1],3===a.length&&(l+=","+a[2]),l+=")",l;case p.Bj.SqlServer:return l=3===a.length?"SUBSTRING("+a[0]+","+a[1]+","+a[2]+")":"SUBSTRING("+a[0]+",  "+a[1]+", LEN("+a[0]+") - "+a[1]+")",l;default:return l="SUBSTRING("+a[0]+" FROM "+a[1],3===a.length&&(l+=" FOR "+a[2]),l+=")",l}}case"extract":return"EXTRACT("+a[0].replaceAll("'","")+" FROM "+a[1]+")";case"cast":{let l="";switch(d){case p.Bj.Oracle:switch(a[1].type){case"date":l="DATE";break;case"float":l="DOUBLE";break;case"integer":l="INTEGER";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="TIMESTAMP";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`;case p.Bj.Postgres:switch(a[1].type){case"date":l="DATE";break;case"float":l="DOUBLE PRECISION";break;case"integer":l="INT";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="TIMESTAMP";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`;case p.Bj.SqlServer:switch(a[1].type){case"date":l="DATE";break;case"float":l="FLOAT";break;case"integer":l="INT";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="DATETIME";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`;default:switch(a[1].type){case"date":l="DATE";break;case"float":l="FLOAT";break;case"integer":l="INTEGER";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="TIMESTAMP";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`}}}throw new I.eS(I.f.InvalidFunctionParameters,{function:u})}function E(u,a){const d=u.toDateTime(),l=0===d.hour&&0===d.minute&&0===d.second&&0===d.millisecond;switch(a){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:return l?`date '${d.toFormat("yyyy-LL-dd")}'`:`timestamp '${d.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case p.Bj.Oracle:return l?`TO_DATE('${d.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${d.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case p.Bj.SqlServer:return`'${d.toFormat(l?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case p.Bj.PGDB:return`#${d.toFormat(l?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case p.Bj.Postgres:return`TIMESTAMP '${d.toFormat(l?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`timestamp '${d.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function j(u,a){switch(a){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:return u.toSQLWithKeyword();case p.Bj.Oracle:return`TO_DATE('${u.toFormat("Y-MM-DD")}'`;case p.Bj.SqlServer:return`'${u.toFormat("Y-MM-DD")}'`;case p.Bj.PGDB:return`#${u.toFormat("Y-MM-DD")}#`;case p.Bj.Postgres:return`TIMESTAMP '${u.toFormat("Y-MM-DD")}'`;default:return u.toSQLWithKeyword()}}function v(u,a){switch(u instanceof R.n&&(u=u.toStorageString()),a){case p.Bj.Oracle:return`TO_DATE('${u}', 'HH24:MI:SS')`;case p.Bj.SqlServer:return`'${u}'`;default:return`time '${u}'`}}function T(u,a){return E(m.iG.dateTimeToArcadeDate((0,p.T4)(u)?u:P.ou.fromJSDate(u)),a)}function e(u,a){switch(a){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:case p.Bj.Oracle:return u?"CURRENT_DATE":"CURRENT_TIMESTAMP";case p.Bj.SqlServer:return u?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return u?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function r(u,a,d={}){const l={},S={},B={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeBigInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeTimeOnly:"time-only",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimestampOffset:"timestamp-offset",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"guid",oid:"integer",long:"integer","small-integer":"integer",integer:"integer","big-integer":"integer",single:"double","time-only":"time-only","date-only":"date-only","timestamp-offset":"timestemp-offset",double:"double",date:"date",guid:"guid","global-id":"guid",string:"string"};for(const L of a){const y=L.type?B[L.type]:void 0;l[L.name.toLowerCase()]=void 0===y?"":y}for(const L in d){const y=B[d[L]];S[L.toLowerCase()]=void 0===y?"":y}switch(s(l,u.parseTree,u.parameters,S)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"date-only":return"date-only";case"time-only":return"time-only";case"timestamp-offset":return"timestamp-offset";case"string":return"string";case"global-id":case"guid":return"guid"}return""}function s(u,a,d,l){let S;switch(a.type){case"interval":return"integer";case"case-expression":{const B=[];if("simple"===a.format){for(let L=0;L<a.clauses.length;L++)B.push(s(u,a.clauses[L].value,d,l));null!==a.else&&B.push(s(u,a.else,d,l))}else{for(let L=0;L<a.clauses.length;L++)B.push(s(u,a.else,d,l));null!==a.else&&B.push(s(u,a.else,d,l))}return o(B)}case"parameter":{const B=l[a.value.toLowerCase()];if(void 0===B&&d){const L=d[a.value.toLowerCase()];if(null==L)return"";if("string"==typeof L||L instanceof String)return"string";if("boolean"==typeof L)return"boolean";if((0,p.J_)(L)||(0,p.NP)(L))return"date";if((0,p.$A)(L))return"date-only";if((0,p._U)(L))return"time-only";if("number"==typeof L)return L%1==0?"integer":"double"}return void 0===B?"":B}case"expression-list":{const B=[];for(const L of a.value)B.push(s(u,L,d,l));return B}case"unary-expression":return"boolean";case"binary-expression":switch(a.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==a.right.type)throw new I.eS(I.f.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return o([s(u,a.left,d,l),s(u,a.right,d,l)]);case"||":return"string";default:throw new I.eS(I.f.UnsupportedOperator,{operator:a.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===a.value?"":a.value%1==0?"integer":"double";case"date":return"date";case"timestamp":return a.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"current-time":return"date";case"column-reference":{const B=u[a.column.toLowerCase()];return void 0===B?"":B}case"function":switch(a.name.toLowerCase()){case"cast":switch(a.args?.value[1]?.value.type??""){case"integer":case"smallint":return"integer";case"real":case"float":return"double";case"date":case"timestamp":return!0===a.args?.value[1]?.value?.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"varchar":return"string";default:return""}case"position":case"extract":case"char_length":case"mod":return"integer";case"round":if(S=s(u,a.args,d,l),S instanceof Array){if(S.length<=0)return"double";S=S[0]}return S;case"sign":return"integer";case"ceiling":case"floor":case"abs":return S=s(u,a.args,d,l),S instanceof Array&&(S=o(S)),"integer"===S||"double"===S?S:"double";case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"cosh":case"sinh":case"tanh":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"nullif":case"coalesce":return S=s(u,a.args,d,l),S instanceof Array?S.length>0?S[0]:"":S}return""}throw new I.eS(I.f.UnsupportedSyntax,{node:a.type})}const n={boolean:1,string:2,integer:3,double:4,date:5};function o(u){if(u){let a="";for(const d of u)""!==d&&(a=""===a||n[a]<n[d]?d:a);return a}return""}function c(u,a){return x(u.parseTree,a)}function D(u){return"column-reference"===u?.parseTree.type}function x(u,a){if(null==u)return!1;switch(u.type){case"when-clause":return x(u.operand,a)||x(u.value,a);case"case-expression":for(const d of u.clauses)if(x(d,a))return!0;return!("simple"!==u.format||!x(u.operand,a))||!(null===u.else||!x(u.else,a));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"time":case"string":case"number":return!1;case"expression-list":for(const d of u.value)if(x(d,a))return!0;return!1;case"unary-expression":return x(u.expr,a);case"binary-expression":return x(u.left,a)||x(u.right,a);case"column-reference":return a.toLowerCase()===u.column.toLowerCase();case"function":return x(u.args,a)}return!1}function N(u){let a="";return a+=u.period.toUpperCase(),a}function Y(u,a,d){let l="";return l="interval-period"===a.type?N(a):N(a.start)+" TO "+N(a.end),"INTERVAL "+d+" "+u+" "+l}},45333:(X,H,w)=>{w.d(H,{CA:()=>c,EB:()=>B,Fp:()=>r,J6:()=>n,QX:()=>a,Sm:()=>Y,VV:()=>T,g3:()=>j,m:()=>x,tj:()=>v});var m=w(15861),I=w(47982),p=w(77132),R=w(83947),k=w(31910),P=w(67398),O=w(29535);function V(y){let F=0;for(let f=0;f<y.length;f++)F+=y[f];return F/y.length}function g(y){const F=V(y);let f=0;for(let b=0;b<y.length;b++)f+=(F-y[b])**2;return f/y.length}function h(y){const F=V(y);let f=0;for(let b=0;b<y.length;b++)f+=(F-y[b])**2;return f/(y.length-1)}function M(y){let F=0;for(let f=0;f<y.length;f++)F+=y[f];return F}function j(y){switch(y.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function v(y,F,f=1e3){switch(y.toLowerCase()){case"distinct":return function E(y,F){const f=[],b={},Z=[];for(let G=0;G<y.length;G++){if(null!=y[G]){const K=y[G];if((0,p.hj)(K)||(0,p.HD)(K))void 0===b[K]&&(f.push(K),b[K]=1);else{let Q=!1;for(let W=0;W<Z.length;W++)!0===(0,p.tt)(Z[W],K)&&(Q=!0);!1===Q&&(Z.push(K),f.push(K))}}if(f.length>=F&&-1!==F)return f}return f}(F,f);case"avg":case"mean":return V(F);case"min":return Math.min.apply(Math,F);case"sum":return M(F);case"max":return Math.max.apply(Math,F);case"stdev":case"stddev":return Math.sqrt(g(F));case"var":case"variance":return g(F);case"count":return F.length}return 0}function T(y,F,f){return e.apply(this,arguments)}function e(){return(e=(0,m.Z)(function*(y,F,f){const b=yield l(y,F,f,!0);return 0===b.length?null:Math.min.apply(Math,b)})).apply(this,arguments)}function r(y,F,f){return s.apply(this,arguments)}function s(){return(s=(0,m.Z)(function*(y,F,f){const b=yield l(y,F,f,!0);return 0===b.length?null:Math.max.apply(Math,b)})).apply(this,arguments)}function n(y,F,f){return o.apply(this,arguments)}function o(){return(o=(0,m.Z)(function*(y,F,f){let b="";F&&!(0,R.y5)(F)&&(b=(0,R.DT)(F,y.fields));const Z=yield l(y,F,f,!0);if(0===Z.length)return null;const G=V(Z);return null===G?G:"integer"===b?function C(y){return y=+y,isFinite(y)?y-y%1||(y<0?-0:0===y?y:0):y}(G):G})).apply(this,arguments)}function c(y,F,f){return D.apply(this,arguments)}function D(){return(D=(0,m.Z)(function*(y,F,f){const b=yield l(y,F,f,!0);return 0===b.length?null:h(b)})).apply(this,arguments)}function x(y,F,f){return N.apply(this,arguments)}function N(){return(N=(0,m.Z)(function*(y,F,f){const b=yield l(y,F,f,!0);return 0===b.length?null:Math.sqrt(h(b))})).apply(this,arguments)}function Y(y,F,f){return u.apply(this,arguments)}function u(){return(u=(0,m.Z)(function*(y,F,f){const b=yield l(y,F,f,!0);return 0===b.length?null:M(b)})).apply(this,arguments)}function a(y,F){return d.apply(this,arguments)}function d(){return(d=(0,m.Z)(function*(y,F){return y.iterator(F).count()})).apply(this,arguments)}function l(y,F,f){return S.apply(this,arguments)}function S(){return(S=(0,m.Z)(function*(y,F,f,b=!1){const Z=y.iterator(f),G=[],K={ticker:0};let Q=yield Z.next();for(;null!==Q;){if(K.ticker++,f.aborted)throw new I.EN(I.H9.Cancelled);K.ticker%100==0&&(K.ticker=0,yield new Promise($=>{setTimeout($,0)}));const W=F?.calculateValue(Q);null===W?!1===b&&(G[G.length]=W):G[G.length]=W instanceof k.u||W instanceof O.n?W.toNumber():W instanceof P.H?W.toMilliseconds():W,Q=yield Z.next()}return G})).apply(this,arguments)}function B(y,F){return L.apply(this,arguments)}function L(){return(L=(0,m.Z)(function*(y,F,f=1e3,b=null){const Z=y.iterator(b),G=[],K={},Q={ticker:0};let W=yield Z.next();for(;null!==W;){if(Q.ticker++,b&&b.aborted)throw new I.EN(I.H9.Cancelled);Q.ticker%100==0&&(Q.ticker=0,yield new Promise(te=>{setTimeout(te,0)}));const $=F?.calculateValue(W);let z=$;if($ instanceof k.u?z="!!DATEONLY!!-"+$.toString():$ instanceof P.H?z="!!TSOFFSETONLY!!-"+$.toString():$ instanceof O.n?z="!!TIMEONLY!!-"+$.toString():$ instanceof Date&&(z="!!DATE!!-"+$.toString()),null!=$&&void 0===K[z]&&(G.push($),K[z]=1),G.length>=f&&-1!==f)return G;W=yield Z.next()}return G})).apply(this,arguments)}},87215:(X,H,w)=>{w.d(H,{CJ:()=>we,Cz:()=>Fe,D$:()=>ve,ED:()=>d,FH:()=>Te,G0:()=>$,Gg:()=>B,JI:()=>F,LV:()=>S,Nm:()=>l,Sp:()=>G,TE:()=>x,U1:()=>Ee,W4:()=>u,Y4:()=>Ae,_L:()=>Ie,cv:()=>te,e5:()=>b,f3:()=>ye,fS:()=>N,j2:()=>De,jU:()=>D,kK:()=>Y,kQ:()=>Pe,og:()=>L,oq:()=>r,r3:()=>c,rd:()=>Se,sz:()=>xe,uh:()=>a,wf:()=>Q,z7:()=>n});var m=w(15861),p=(w(29132),w(97347)),R=w(72642),k=w(91179);function P(i){return Array.isArray(i)?i[0]?.spatialReference:i?.spatialReference}function O(i){return i&&(Array.isArray(i)?i.map(O):i.toJSON?i.toJSON():i)}function C(i){return Array.isArray(i)?i.map(_=>(0,k.im)(_)):(0,k.im)(i)}let g;function h(){return M.apply(this,arguments)}function M(){return(M=(0,m.Z)(function*(){return g||(g=(0,p.bA)("geometryEngineWorker",{strategy:"distributed"})),g})).apply(this,arguments)}function E(i,_){return j.apply(this,arguments)}function j(){return(j=(0,m.Z)(function*(i,_){return(yield h()).invoke("executeGEOperation",{operation:i,parameters:O(_)})})).apply(this,arguments)}function r(i,_){return s.apply(this,arguments)}function s(){return(s=(0,m.Z)(function*(i,_){return C(yield E("clip",[P(i),i,_]))})).apply(this,arguments)}function n(i,_){return o.apply(this,arguments)}function o(){return(o=(0,m.Z)(function*(i,_){return C(yield E("cut",[P(i),i,_]))})).apply(this,arguments)}function c(i,_){return E("contains",[P(i),i,_])}function D(i,_){return E("crosses",[P(i),i,_])}function x(i,_,A){return E("distance",[P(i),i,_,A])}function N(i,_){return E("equals",[P(i),i,_])}function Y(i,_){return E("intersects",[P(i),i,_])}function u(i,_){return E("touches",[P(i),i,_])}function a(i,_){return E("within",[P(i),i,_])}function d(i,_){return E("disjoint",[P(i),i,_])}function l(i,_){return E("overlaps",[P(i),i,_])}function S(i,_,A){return E("relate",[P(i),i,_,A])}function B(i){return E("isSimple",[P(i),i])}function L(i){return y.apply(this,arguments)}function y(){return(y=(0,m.Z)(function*(i){return C(yield E("simplify",[P(i),i]))})).apply(this,arguments)}function F(i){return f.apply(this,arguments)}function f(){return(f=(0,m.Z)(function*(i,_=!1){return C(yield E("convexHull",[P(i),i,_]))})).apply(this,arguments)}function b(i,_){return Z.apply(this,arguments)}function Z(){return(Z=(0,m.Z)(function*(i,_){return C(yield E("difference",[P(i),i,_]))})).apply(this,arguments)}function G(i,_){return K.apply(this,arguments)}function K(){return(K=(0,m.Z)(function*(i,_){return C(yield E("symmetricDifference",[P(i),i,_]))})).apply(this,arguments)}function Q(i,_){return W.apply(this,arguments)}function W(){return(W=(0,m.Z)(function*(i,_){return C(yield E("intersect",[P(i),i,_]))})).apply(this,arguments)}function $(i){return z.apply(this,arguments)}function z(){return(z=(0,m.Z)(function*(i,_=null){const A=function V(i,_){let A;return Array.isArray(i)?A=i:(A=[],A.push(i),null!=_&&A.push(_)),A}(i,_);return C(yield E("union",[P(A),A]))})).apply(this,arguments)}function te(i,_,A,U,J,ee){return ne.apply(this,arguments)}function ne(){return(ne=(0,m.Z)(function*(i,_,A,U,J,ee){return C(yield E("offset",[P(i),i,_,A,U,J,ee]))})).apply(this,arguments)}function ye(i,_,A){return re.apply(this,arguments)}function re(){return(re=(0,m.Z)(function*(i,_,A,U=!1){const J=[P(i),i,_,A,U];return C(yield E("buffer",J))})).apply(this,arguments)}function Se(i,_,A,U,J,ee){return ae.apply(this,arguments)}function ae(){return(ae=(0,m.Z)(function*(i,_,A,U,J,ee){const be=[P(i),i,_,A,U,J,ee];return C(yield E("geodesicBuffer",be))})).apply(this,arguments)}function Te(i,_){return se.apply(this,arguments)}function se(){return(se=(0,m.Z)(function*(i,_,A=!0){const U=yield E("nearestCoordinate",[P(i),i,_,A]);return{...U,coordinate:R.Z.fromJSON(U.coordinate)}})).apply(this,arguments)}function Ie(i,_){return ie.apply(this,arguments)}function ie(){return(ie=(0,m.Z)(function*(i,_){const A=yield E("nearestVertex",[P(i),i,_]);return{...A,coordinate:R.Z.fromJSON(A.coordinate)}})).apply(this,arguments)}function Ee(i,_,A){return le.apply(this,arguments)}function le(){return(le=(0,m.Z)(function*(i,_,A){if(null==i)throw new q;const U=i.spatialReference;if(null==(A=A??function oe(i){return"xmin"in i?i.center:"x"in i?i:i.extent?.center}(i)))throw new q;const J=i.constructor.fromJSON(yield E("rotate",[U,i,_,A]));return J.spatialReference=U,J})).apply(this,arguments)}function ve(i,_,A,U){return _e.apply(this,arguments)}function _e(){return(_e=(0,m.Z)(function*(i,_,A,U){return C(yield E("generalize",[P(i),i,_,A,U]))})).apply(this,arguments)}function Fe(i,_,A){return de.apply(this,arguments)}function de(){return(de=(0,m.Z)(function*(i,_,A){return C(yield E("densify",[P(i),i,_,A]))})).apply(this,arguments)}function De(i,_,A){return pe.apply(this,arguments)}function pe(){return(pe=(0,m.Z)(function*(i,_,A,U=0){return C(yield E("geodesicDensify",[P(i),i,_,A,U]))})).apply(this,arguments)}function we(i,_){return E("planarArea",[P(i),i,_])}function xe(i,_){return E("planarLength",[P(i),i,_])}function Ae(i,_,A){return E("geodesicArea",[P(i),i,_,A])}function Pe(i,_,A){return E("geodesicLength",[P(i),i,_,A])}class q extends Error{constructor(){super("Illegal Argument Exception")}}}}]);